========================================
Community Forest Management System
========================================

Activating virtual environment...

========================================
Starting FastAPI server on port 8001...
API Documentation: http://localhost:8001/docs
Health Check: http://localhost:8001/health
========================================

INFO:     Will watch for changes in these directories: ['D:\\forest_management\\backend']
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
INFO:     Started reloader process [16912] using WatchFiles
INFO:     Started server process [11704]
INFO:     Waiting for application startup.
Starting Community Forest Management System v1.0.0
Debug mode: True
2026-01-30 20:09:00,814 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2026-01-30 20:09:00,814 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-30 20:09:00,815 INFO sqlalchemy.engine.Engine select current_schema()
2026-01-30 20:09:00,816 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-30 20:09:00,817 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2026-01-30 20:09:00,817 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-30 20:09:00,821 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:09:00,821 INFO sqlalchemy.engine.Engine SELECT 1
2026-01-30 20:09:00,822 INFO sqlalchemy.engine.Engine [generated in 0.00055s] {}
2026-01-30 20:09:00,823 INFO sqlalchemy.engine.Engine ROLLBACK
Database connection successful
INFO:     Application startup complete.
2026-01-30 20:09:06,875 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:09:06,882 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 20:09:06,883 INFO sqlalchemy.engine.Engine [generated in 0.00078s] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
2026-01-30 20:09:07,015 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:09:07,016 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 20:09:07,017 INFO sqlalchemy.engine.Engine [cached since 0.1346s ago] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
INFO:     127.0.0.1:58044 - "GET /api/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:53894 - "GET /api/auth/me HTTP/1.1" 200 OK
2026-01-30 20:09:07,031 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-30 20:09:07,032 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-30 20:09:58,504 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:09:58,508 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.email = %(email_1)s
 LIMIT %(param_1)s
2026-01-30 20:09:58,509 INFO sqlalchemy.engine.Engine [generated in 0.00085s] {'email_1': 'newuser@example.com', 'param_1': 1}
2026-01-30 20:09:59,190 INFO sqlalchemy.engine.Engine UPDATE public.users SET last_login=%(last_login)s WHERE public.users.id = %(public_users_id)s::UUID
2026-01-30 20:09:59,191 INFO sqlalchemy.engine.Engine [generated in 0.00051s] {'last_login': datetime.datetime(2026, 1, 30, 14, 24, 59, 186788), 'public_users_id': UUID('4852473e-6cb9-4422-91b9-aa8d59d39e83')}
2026-01-30 20:09:59,195 INFO sqlalchemy.engine.Engine COMMIT
2026-01-30 20:09:59,198 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:09:59,201 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(pk_1)s::UUID
2026-01-30 20:09:59,201 INFO sqlalchemy.engine.Engine [generated in 0.00042s] {'pk_1': UUID('4852473e-6cb9-4422-91b9-aa8d59d39e83')}
INFO:     127.0.0.1:58750 - "POST /api/auth/login HTTP/1.1" 200 OK
2026-01-30 20:09:59,205 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-30 20:09:59,212 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:09:59,212 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 20:09:59,213 INFO sqlalchemy.engine.Engine [cached since 52.33s ago] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
INFO:     127.0.0.1:58750 - "GET /api/auth/me HTTP/1.1" 200 OK
2026-01-30 20:09:59,215 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-30 20:09:59,273 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:09:59,274 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 20:09:59,274 INFO sqlalchemy.engine.Engine [cached since 52.39s ago] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
2026-01-30 20:09:59,284 INFO sqlalchemy.engine.Engine SELECT admin."community forests".id AS "admin_community forests_id", ST_AsEWKB(admin."community forests".geom) AS "admin_community forests_geom", admin."community forests".name AS "admin_community forests_name", admin."community forests".code AS "admin_community forests_code", admin."community forests".regime AS "admin_community forests_regime", admin."community forests"."area sqm" AS "admin_community forests_area sqm", public.forest_managers.role AS public_forest_managers_role
FROM admin."community forests" JOIN public.forest_managers ON public.forest_managers.community_forest_id = admin."community forests".id
WHERE public.forest_managers.user_id = %(user_id_1)s::UUID AND public.forest_managers.is_active = true
2026-01-30 20:09:59,284 INFO sqlalchemy.engine.Engine [generated in 0.00052s] {'user_id_1': UUID('4852473e-6cb9-4422-91b9-aa8d59d39e83')}
INFO:     127.0.0.1:58750 - "GET /api/forests/my-forests HTTP/1.1" 200 OK
2026-01-30 20:09:59,313 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-30 20:09:59,320 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:09:59,321 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 20:09:59,321 INFO sqlalchemy.engine.Engine [cached since 52.44s ago] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
2026-01-30 20:09:59,324 INFO sqlalchemy.engine.Engine SELECT admin."community forests".id AS "admin_community forests_id", ST_AsEWKB(admin."community forests".geom) AS "admin_community forests_geom", admin."community forests".name AS "admin_community forests_name", admin."community forests".code AS "admin_community forests_code", admin."community forests".regime AS "admin_community forests_regime", admin."community forests"."area sqm" AS "admin_community forests_area sqm", public.forest_managers.role AS public_forest_managers_role
FROM admin."community forests" JOIN public.forest_managers ON public.forest_managers.community_forest_id = admin."community forests".id
WHERE public.forest_managers.user_id = %(user_id_1)s::UUID AND public.forest_managers.is_active = true
2026-01-30 20:09:59,326 INFO sqlalchemy.engine.Engine [cached since 0.04215s ago] {'user_id_1': UUID('4852473e-6cb9-4422-91b9-aa8d59d39e83')}
INFO:     127.0.0.1:58750 - "GET /api/forests/my-forests HTTP/1.1" 200 OK
2026-01-30 20:09:59,347 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-30 20:10:25,212 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:10:25,213 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 20:10:25,214 INFO sqlalchemy.engine.Engine [cached since 78.33s ago] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
2026-01-30 20:10:25,374 INFO sqlalchemy.engine.Engine INSERT INTO public.calculations (id, user_id, application_id, uploaded_filename, boundary_geom, forest_name, block_name, result_data, status, processing_time_seconds, error_message, created_at, completed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(application_id)s::UUID, %(uploaded_filename)s, ST_GeomFromText(%(ST_GeomFromText_1)s, %(ST_GeomFromText_2)s), %(forest_name)s, %(block_name)s, %(result_data)s::JSONB, %(status)s, %(processing_time_seconds)s, %(error_message)s, %(created_at)s, %(completed_at)s)
2026-01-30 20:10:25,374 INFO sqlalchemy.engine.Engine [generated in 0.00183s] {'id': UUID('68cb13f7-839b-4b66-8024-33ace7bb629a'), 'user_id': UUID('4852473e-6cb9-4422-91b9-aa8d59d39e83'), 'application_id': None, 'uploaded_filename': 'sundar.zip', 'ST_GeomFromText_1': 'MULTIPOLYGON (((85.06166514100008 27.41872503600006, 85.06203161900002 27.418646880000075, 85.06232481400012 27.41863380400006, 85.062764611 27.41862 ... (8402 characters truncated) ... 85.04009173000006 27.45254918800003, 85.04104511200006 27.45420717300008, 85.04199853799999 27.455932865000044, 85.0431547570001 27.45588747100002)))', 'ST_GeomFromText_2': 4326, 'forest_name': 'chitawan', 'block_name': 'chitawan1', 'result_data': '{"total_blocks": 5, "blocks": [{"block_index": 0, "block_name": "Panchpokhari pakho", "area_sqm": 1341233.9729370929, "area_hectares": 134.1233972937 ... (10347 characters truncated) ... 588747100002]]]}, "centroid": {"lon": 85.0419834247576, "lat": 27.44726912429787}}], "processing_info": {"partitioned": false, "partition_info": {}}}', 'status': 'PROCESSING', 'processing_time_seconds': None, 'error_message': None, 'created_at': datetime.datetime(2026, 1, 30, 14, 25, 25, 373055), 'completed_at': None}
2026-01-30 20:10:25,407 INFO sqlalchemy.engine.Engine COMMIT
2026-01-30 20:10:25,412 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:10:25,415 INFO sqlalchemy.engine.Engine SELECT public.calculations.id, public.calculations.user_id, public.calculations.application_id, public.calculations.uploaded_filename, ST_AsEWKB(public.calculations.boundary_geom) AS boundary_geom, public.calculations.forest_name, public.calculations.block_name, public.calculations.result_data, public.calculations.status, public.calculations.processing_time_seconds, public.calculations.error_message, public.calculations.created_at, public.calculations.completed_at
FROM public.calculations
WHERE public.calculations.id = %(pk_1)s::UUID
2026-01-30 20:10:25,416 INFO sqlalchemy.engine.Engine [generated in 0.00053s] {'pk_1': UUID('68cb13f7-839b-4b66-8024-33ace7bb629a')}
Starting analysis for calculation 68cb13f7-839b-4b66-8024-33ace7bb629a
2026-01-30 20:10:25,425 INFO sqlalchemy.engine.Engine SELECT public.calculations.id AS public_calculations_id, public.calculations.user_id AS public_calculations_user_id, public.calculations.application_id AS public_calculations_application_id, public.calculations.uploaded_filename AS public_calculations_uploaded_filename, ST_AsEWKB(public.calculations.boundary_geom) AS public_calculations_boundary_geom, public.calculations.forest_name AS public_calculations_forest_name, public.calculations.block_name AS public_calculations_block_name, public.calculations.result_data AS public_calculations_result_data, public.calculations.status AS public_calculations_status, public.calculations.processing_time_seconds AS public_calculations_processing_time_seconds, public.calculations.error_message AS public_calculations_error_message, public.calculations.created_at AS public_calculations_created_at, public.calculations.completed_at AS public_calculations_completed_at
FROM public.calculations
WHERE public.calculations.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 20:10:25,426 INFO sqlalchemy.engine.Engine [generated in 0.00071s] {'id_1': UUID('68cb13f7-839b-4b66-8024-33ace7bb629a'), 'param_1': 1}
Analyzing block 1/5: Panchpokhari pakho
2026-01-30 20:10:25,430 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 20:10:25,431 INFO sqlalchemy.engine.Engine [generated in 0.00053s] {'geojson': '{"type": "Polygon", "coordinates": [[[85.06166514100008, 27.41872503600006], [85.06203161900002, 27.418646880000075], [85.06232481400012, 27.41863380 ... (2153 characters truncated) ... 0005, 27.418321877000007], [85.06082951000012, 27.41866014500002], [85.06119604100007, 27.418790200000032], [85.06166514100008, 27.41872503600006]]]}'}
2026-01-30 20:10:25,435 INFO sqlalchemy.engine.Engine
        SELECT
            ST_YMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as north,
            ST_YMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as south,
            ST_XMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as east,
            ST_XMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as west

2026-01-30 20:10:25,436 INFO sqlalchemy.engine.Engine [generated in 0.00055s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,445 INFO sqlalchemy.engine.Engine
            WITH clipped_raster AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.dem
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ),
            pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as elevation
                FROM clipped_raster
            )
            SELECT
                MIN(elevation) as elevation_min,
                MAX(elevation) as elevation_max,
                AVG(elevation) as elevation_mean
            FROM pixel_values
            WHERE elevation > -32000  -- Exclude NoData values (-32768)
              AND elevation >= 0       -- Nepal minimum elevation
              AND elevation <= 9000    -- Nepal maximum elevation

2026-01-30 20:10:25,446 INFO sqlalchemy.engine.Engine [generated in 0.00065s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,508 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as slope_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.slope
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value > 0
              AND (pvc).value <= 4
            GROUP BY slope_code

2026-01-30 20:10:25,508 INFO sqlalchemy.engine.Engine [generated in 0.00050s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,519 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as aspect_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.aspect
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 0 AND 8
            GROUP BY aspect_code

2026-01-30 20:10:25,519 INFO sqlalchemy.engine.Engine [generated in 0.00044s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,527 INFO sqlalchemy.engine.Engine
            WITH boundary AS (
                SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
            ),
            all_pixels AS (
                SELECT
                    (pix).val as height,
                    (pix).geom as pixel_center
                FROM (
                    SELECT ST_PixelAsPolygons(rast) as pix
                    FROM rasters.canopy_height, boundary
                    WHERE ST_Intersects(rast, geom)
                ) as subq
            )
            SELECT
                CASE
                    WHEN height = 0 THEN 'non_forest'
                    WHEN height > 0 AND height <= 5 THEN 'bush_regenerated'
                    WHEN height > 5 AND height <= 15 THEN 'pole_trees'
                    WHEN height > 15 THEN 'high_forest'
                END as canopy_class,
                COUNT(*) as pixel_count,
                AVG(height) as avg_height
            FROM all_pixels, boundary
            WHERE ST_Contains(boundary.geom, ST_Centroid(pixel_center))
              AND height IS NOT NULL
              AND height >= 0
              AND height <= 50
            GROUP BY canopy_class

2026-01-30 20:10:25,528 INFO sqlalchemy.engine.Engine [generated in 0.00037s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,605 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as agb_mean,
                (stats).sum as agb_total
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, 1, ST_GeomFromText(%(wkt)s, 4326)),
                    1,  -- band 1
                    true  -- exclude nodata
                ) as stats
                FROM rasters.agb_2022_nepal
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ) as subquery

2026-01-30 20:10:25,606 INFO sqlalchemy.engine.Engine [generated in 0.00052s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,618 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as health_class,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_forest_health
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 5
            GROUP BY health_class

2026-01-30 20:10:25,619 INFO sqlalchemy.engine.Engine [generated in 0.00056s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,647 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as forest_type_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_type WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 26
            GROUP BY forest_type_code ORDER BY pixel_count DESC

2026-01-30 20:10:25,647 INFO sqlalchemy.engine.Engine [generated in 0.00049s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,661 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as landcover_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.esa_world_cover WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
            GROUP BY landcover_code ORDER BY pixel_count DESC

2026-01-30 20:10:25,661 INFO sqlalchemy.engine.Engine [generated in 0.00058s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,672 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as loss_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_lossyear WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY loss_year ORDER BY loss_year

2026-01-30 20:10:25,672 INFO sqlalchemy.engine.Engine [generated in 0.00060s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,682 INFO sqlalchemy.engine.Engine
            SELECT SUM((pvc).count) as gain_pixels
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_gain WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value = 1

2026-01-30 20:10:25,682 INFO sqlalchemy.engine.Engine [generated in 0.00028s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,688 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as fire_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_loss_fire WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY fire_year ORDER BY fire_year

2026-01-30 20:10:25,688 INFO sqlalchemy.engine.Engine [generated in 0.00056s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,696 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_mean_temperature WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_mean FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 20:10:25,696 INFO sqlalchemy.engine.Engine [generated in 0.00037s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,703 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.min_temp_coldest_month WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_min FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 20:10:25,704 INFO sqlalchemy.engine.Engine [generated in 0.00055s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,714 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_precipitation WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as precip FROM clipped
            )
            SELECT AVG(precip) as precip_mean FROM pixel_values WHERE precip IS NOT NULL AND precip >= 0

2026-01-30 20:10:25,714 INFO sqlalchemy.engine.Engine [generated in 0.00043s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,724 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as texture_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.soilgrids_isric WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 12
            GROUP BY texture_code ORDER BY pixel_count DESC LIMIT 1

2026-01-30 20:10:25,724 INFO sqlalchemy.engine.Engine [generated in 0.00050s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,735 INFO sqlalchemy.engine.Engine
        SELECT p.province
        FROM admin.province p
        WHERE ST_Intersects(
            p.shape,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:25,735 INFO sqlalchemy.engine.Engine [generated in 0.00066s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,747 INFO sqlalchemy.engine.Engine
        SELECT m.district, m.gapa_napa as municipality
        FROM admin.municipality m
        WHERE ST_Intersects(
            m.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:25,747 INFO sqlalchemy.engine.Engine [generated in 0.00063s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,753 INFO sqlalchemy.engine.Engine
        SELECT w.ward
        FROM admin.ward w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:25,754 INFO sqlalchemy.engine.Engine [generated in 0.00065s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,760 INFO sqlalchemy.engine.Engine
        SELECT w."watershed name" as watershed_name, w."major river basin" as major_river_basin
        FROM admin."watershed_Nepal" w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:25,760 INFO sqlalchemy.engine.Engine [generated in 0.00030s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,764 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
        ),
        total_area AS (
            SELECT ST_Area(ST_Transform(geom, 32645)) as area
            FROM input_geom
        ),
        geology_intersections AS (
            SELECT
                g."geology class" as geology_class,
                ST_Area(
                    ST_Transform(
                        ST_Intersection(g.geom, i.geom),
                        32645
                    )
                ) as intersection_area
            FROM geology.geology g, input_geom i
            WHERE ST_Intersects(g.geom, i.geom)
            AND g."geology class" IS NOT NULL
            AND g."geology class" != 'No Data'
        )
        SELECT
            geology_class,
            (intersection_area / (SELECT area FROM total_area)) * 100 as percentage
        FROM geology_intersections
        WHERE intersection_area > 0
        ORDER BY percentage DESC

2026-01-30 20:10:25,765 INFO sqlalchemy.engine.Engine [generated in 0.00029s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,786 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT
                ST_GeomFromText(%(wkt)s, 4326) as geom,
                ST_Centroid(ST_GeomFromText(%(wkt)s, 4326)) as centroid
        ),
        nearest_hq AS (
            SELECT
                dh."head quarter" as name,
                ST_Distance(
                    ST_Transform(i.centroid, 32645),
                    ST_Transform(dh.geom, 32645)
                ) / 1000.0 as distance_km,
                degrees(
                    ST_Azimuth(
                        i.centroid,
                        dh.geom
                    )
                ) as azimuth_degrees
            FROM admin."district Headquarter" dh, input_geom i
            WHERE dh."head quarter" IS NOT NULL
            ORDER BY ST_Distance(i.centroid, dh.geom)
            LIMIT 1
        )
        SELECT
            name,
            distance_km,
            azimuth_degrees,
            CASE
                WHEN azimuth_degrees >= 337.5 OR azimuth_degrees < 22.5 THEN 'North'
                WHEN azimuth_degrees >= 22.5 AND azimuth_degrees < 67.5 THEN 'Northeast'
                WHEN azimuth_degrees >= 67.5 AND azimuth_degrees < 112.5 THEN 'East'
                WHEN azimuth_degrees >= 112.5 AND azimuth_degrees < 157.5 THEN 'Southeast'
                WHEN azimuth_degrees >= 157.5 AND azimuth_degrees < 202.5 THEN 'South'
                WHEN azimuth_degrees >= 202.5 AND azimuth_degrees < 247.5 THEN 'Southwest'
                WHEN azimuth_degrees >= 247.5 AND azimuth_degrees < 292.5 THEN 'West'
                ELSE 'Northwest'
            END as direction
        FROM nearest_hq

2026-01-30 20:10:25,786 INFO sqlalchemy.engine.Engine [generated in 0.00044s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:25,793 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:25,794 INFO sqlalchemy.engine.Engine [generated in 0.00043s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:28,371 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:28,371 INFO sqlalchemy.engine.Engine [generated in 0.00030s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:32,331 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:32,331 INFO sqlalchemy.engine.Engine [generated in 0.00026s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,309 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:34,309 INFO sqlalchemy.engine.Engine [generated in 0.00033s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,501 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:34,501 INFO sqlalchemy.engine.Engine [generated in 0.00032s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,519 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:34,519 INFO sqlalchemy.engine.Engine [generated in 0.00035s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,568 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:34,568 INFO sqlalchemy.engine.Engine [generated in 0.00040s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,576 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:34,577 INFO sqlalchemy.engine.Engine [generated in 0.00033s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,578 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:34,578 INFO sqlalchemy.engine.Engine [generated in 0.00025s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,579 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:34,579 INFO sqlalchemy.engine.Engine [generated in 0.00038s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,581 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:34,581 INFO sqlalchemy.engine.Engine [generated in 0.00042s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,582 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:34,582 INFO sqlalchemy.engine.Engine [generated in 0.00027s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,583 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:34,584 INFO sqlalchemy.engine.Engine [generated in 0.00031s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,585 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:34,585 INFO sqlalchemy.engine.Engine [generated in 0.00027s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,586 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:34,586 INFO sqlalchemy.engine.Engine [generated in 0.00034s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,587 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:34,587 INFO sqlalchemy.engine.Engine [generated in 0.00029s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,589 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:34,589 INFO sqlalchemy.engine.Engine [generated in 0.00039s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,590 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:34,591 INFO sqlalchemy.engine.Engine [generated in 0.00035s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,592 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:34,592 INFO sqlalchemy.engine.Engine [generated in 0.00045s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,593 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:34,593 INFO sqlalchemy.engine.Engine [generated in 0.00025s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,594 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:34,594 INFO sqlalchemy.engine.Engine [generated in 0.00021s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,595 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:34,596 INFO sqlalchemy.engine.Engine [generated in 0.00034s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,597 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:34,597 INFO sqlalchemy.engine.Engine [generated in 0.00028s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,598 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:34,598 INFO sqlalchemy.engine.Engine [generated in 0.00027s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,599 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:34,599 INFO sqlalchemy.engine.Engine [generated in 0.00034s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,600 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:34,600 INFO sqlalchemy.engine.Engine [generated in 0.00022s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,601 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:34,601 INFO sqlalchemy.engine.Engine [generated in 0.00020s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,602 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:34,602 INFO sqlalchemy.engine.Engine [generated in 0.00025s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,603 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:34,603 INFO sqlalchemy.engine.Engine [generated in 0.00054s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,604 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:34,605 INFO sqlalchemy.engine.Engine [generated in 0.00026s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,606 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:34,606 INFO sqlalchemy.engine.Engine [generated in 0.00043s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,608 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:34,608 INFO sqlalchemy.engine.Engine [generated in 0.00037s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,609 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:34,610 INFO sqlalchemy.engine.Engine [generated in 0.00047s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,611 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:34,611 INFO sqlalchemy.engine.Engine [generated in 0.00041s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,612 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:34,612 INFO sqlalchemy.engine.Engine [generated in 0.00024s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:10:34,613 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:34,613 INFO sqlalchemy.engine.Engine [generated in 0.00021s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
Block 1 analysis completed successfully
Analyzing block 2/5: Chaukune Bari
2026-01-30 20:10:34,614 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 20:10:34,614 INFO sqlalchemy.engine.Engine [cached since 9.184s ago] {'geojson': '{"type": "Polygon", "coordinates": [[[85.0574253390001, 27.427365587000086], [85.05864488600011, 27.425978034000032], [85.0597119070001, 27.424556682 ... (1876 characters truncated) ... 000001, 27.42689951299998], [85.0565676690001, 27.427288961000052], [85.05733172489794, 27.42768438178319], [85.0574253390001, 27.427365587000086]]]}'}
Error converting GeoJSON to WKT: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL:
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt
        ]
[parameters: {'geojson': '{"type": "Polygon", "coordinates": [[[85.0574253390001, 27.427365587000086], [85.05864488600011, 27.425978034000032], [85.0597119070001, 27.424556682 ... (1876 characters truncated) ... 000001, 27.42689951299998], [85.0565676690001, 27.427288961000052], [85.05733172489794, 27.42768438178319], [85.0574253390001, 27.427365587000086]]]}'}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
GeoJSON string (first 500 chars): {"type": "Polygon", "coordinates": [[[85.0574253390001, 27.427365587000086], [85.05864488600011, 27.425978034000032], [85.0597119070001, 27.424556682000023], [85.06005456700004, 27.422932459000016], [85.06093082800007, 27.421071286000032], [85.06222662600008, 27.420123600000046], [85.0633639512823, 27.41868062614693], [85.06308713600005, 27.418633638000045], [85.062764611, 27.41862069600004], [85.06232481400012, 27.41863380400006], [85.06203161900002, 27.418646880000075], [85.06166514100008, 27.
Error analyzing block 2: Invalid geometry format: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL:
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt
        ]
[parameters: {'geojson': '{"type": "Polygon", "coordinates": [[[85.0574253390001, 27.427365587000086], [85.05864488600011, 27.425978034000032], [85.0597119070001, 27.424556682 ... (1876 characters truncated) ... 000001, 27.42689951299998], [85.0565676690001, 27.427288961000052], [85.05733172489794, 27.42768438178319], [85.0574253390001, 27.427365587000086]]]}'}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2026-01-30 20:10:34,615 INFO sqlalchemy.engine.Engine ROLLBACK
Analyzing block 3/5: Tikaram pakho
2026-01-30 20:10:34,616 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:10:34,617 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 20:10:34,617 INFO sqlalchemy.engine.Engine [cached since 9.187s ago] {'geojson': '{"type": "Polygon", "coordinates": [[[85.05123494200002, 27.434844373], [85.05250854700007, 27.43281449000009], [85.05384280200006, 27.43220514200003 ... (1387 characters truncated) ... 4262600008, 27.435571854000063], [85.05020597900007, 27.43599990300004], [85.05073287130257, 27.43625625445806], [85.05123494200002, 27.434844373]]]}'}
2026-01-30 20:10:34,619 INFO sqlalchemy.engine.Engine
        SELECT
            ST_YMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as north,
            ST_YMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as south,
            ST_XMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as east,
            ST_XMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as west

2026-01-30 20:10:34,620 INFO sqlalchemy.engine.Engine [cached since 9.185s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,624 INFO sqlalchemy.engine.Engine
            WITH clipped_raster AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.dem
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ),
            pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as elevation
                FROM clipped_raster
            )
            SELECT
                MIN(elevation) as elevation_min,
                MAX(elevation) as elevation_max,
                AVG(elevation) as elevation_mean
            FROM pixel_values
            WHERE elevation > -32000  -- Exclude NoData values (-32768)
              AND elevation >= 0       -- Nepal minimum elevation
              AND elevation <= 9000    -- Nepal maximum elevation

2026-01-30 20:10:34,625 INFO sqlalchemy.engine.Engine [cached since 9.179s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,670 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as slope_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.slope
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value > 0
              AND (pvc).value <= 4
            GROUP BY slope_code

2026-01-30 20:10:34,670 INFO sqlalchemy.engine.Engine [cached since 9.163s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,681 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as aspect_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.aspect
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 0 AND 8
            GROUP BY aspect_code

2026-01-30 20:10:34,681 INFO sqlalchemy.engine.Engine [cached since 9.163s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,692 INFO sqlalchemy.engine.Engine
            WITH boundary AS (
                SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
            ),
            all_pixels AS (
                SELECT
                    (pix).val as height,
                    (pix).geom as pixel_center
                FROM (
                    SELECT ST_PixelAsPolygons(rast) as pix
                    FROM rasters.canopy_height, boundary
                    WHERE ST_Intersects(rast, geom)
                ) as subq
            )
            SELECT
                CASE
                    WHEN height = 0 THEN 'non_forest'
                    WHEN height > 0 AND height <= 5 THEN 'bush_regenerated'
                    WHEN height > 5 AND height <= 15 THEN 'pole_trees'
                    WHEN height > 15 THEN 'high_forest'
                END as canopy_class,
                COUNT(*) as pixel_count,
                AVG(height) as avg_height
            FROM all_pixels, boundary
            WHERE ST_Contains(boundary.geom, ST_Centroid(pixel_center))
              AND height IS NOT NULL
              AND height >= 0
              AND height <= 50
            GROUP BY canopy_class

2026-01-30 20:10:34,693 INFO sqlalchemy.engine.Engine [cached since 9.165s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,830 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as agb_mean,
                (stats).sum as agb_total
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, 1, ST_GeomFromText(%(wkt)s, 4326)),
                    1,  -- band 1
                    true  -- exclude nodata
                ) as stats
                FROM rasters.agb_2022_nepal
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ) as subquery

2026-01-30 20:10:34,830 INFO sqlalchemy.engine.Engine [cached since 9.225s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,840 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as health_class,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_forest_health
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 5
            GROUP BY health_class

2026-01-30 20:10:34,840 INFO sqlalchemy.engine.Engine [cached since 9.222s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,852 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as forest_type_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_type WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 26
            GROUP BY forest_type_code ORDER BY pixel_count DESC

2026-01-30 20:10:34,852 INFO sqlalchemy.engine.Engine [cached since 9.205s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,863 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as landcover_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.esa_world_cover WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
            GROUP BY landcover_code ORDER BY pixel_count DESC

2026-01-30 20:10:34,864 INFO sqlalchemy.engine.Engine [cached since 9.203s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,877 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as loss_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_lossyear WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY loss_year ORDER BY loss_year

2026-01-30 20:10:34,878 INFO sqlalchemy.engine.Engine [cached since 9.206s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,885 INFO sqlalchemy.engine.Engine
            SELECT SUM((pvc).count) as gain_pixels
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_gain WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value = 1

2026-01-30 20:10:34,885 INFO sqlalchemy.engine.Engine [cached since 9.203s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,893 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as fire_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_loss_fire WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY fire_year ORDER BY fire_year

2026-01-30 20:10:34,893 INFO sqlalchemy.engine.Engine [cached since 9.205s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,899 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_mean_temperature WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_mean FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 20:10:34,899 INFO sqlalchemy.engine.Engine [cached since 9.203s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,906 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.min_temp_coldest_month WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_min FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 20:10:34,906 INFO sqlalchemy.engine.Engine [cached since 9.203s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,915 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_precipitation WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as precip FROM clipped
            )
            SELECT AVG(precip) as precip_mean FROM pixel_values WHERE precip IS NOT NULL AND precip >= 0

2026-01-30 20:10:34,915 INFO sqlalchemy.engine.Engine [cached since 9.202s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,923 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as texture_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.soilgrids_isric WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 12
            GROUP BY texture_code ORDER BY pixel_count DESC LIMIT 1

2026-01-30 20:10:34,923 INFO sqlalchemy.engine.Engine [cached since 9.2s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,937 INFO sqlalchemy.engine.Engine
        SELECT p.province
        FROM admin.province p
        WHERE ST_Intersects(
            p.shape,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:34,938 INFO sqlalchemy.engine.Engine [cached since 9.203s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,953 INFO sqlalchemy.engine.Engine
        SELECT m.district, m.gapa_napa as municipality
        FROM admin.municipality m
        WHERE ST_Intersects(
            m.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:34,954 INFO sqlalchemy.engine.Engine [cached since 9.207s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,968 INFO sqlalchemy.engine.Engine
        SELECT w.ward
        FROM admin.ward w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:34,968 INFO sqlalchemy.engine.Engine [cached since 9.215s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,976 INFO sqlalchemy.engine.Engine
        SELECT w."watershed name" as watershed_name, w."major river basin" as major_river_basin
        FROM admin."watershed_Nepal" w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:34,976 INFO sqlalchemy.engine.Engine [cached since 9.216s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:34,995 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
        ),
        total_area AS (
            SELECT ST_Area(ST_Transform(geom, 32645)) as area
            FROM input_geom
        ),
        geology_intersections AS (
            SELECT
                g."geology class" as geology_class,
                ST_Area(
                    ST_Transform(
                        ST_Intersection(g.geom, i.geom),
                        32645
                    )
                ) as intersection_area
            FROM geology.geology g, input_geom i
            WHERE ST_Intersects(g.geom, i.geom)
            AND g."geology class" IS NOT NULL
            AND g."geology class" != 'No Data'
        )
        SELECT
            geology_class,
            (intersection_area / (SELECT area FROM total_area)) * 100 as percentage
        FROM geology_intersections
        WHERE intersection_area > 0
        ORDER BY percentage DESC

2026-01-30 20:10:34,996 INFO sqlalchemy.engine.Engine [cached since 9.231s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:35,041 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT
                ST_GeomFromText(%(wkt)s, 4326) as geom,
                ST_Centroid(ST_GeomFromText(%(wkt)s, 4326)) as centroid
        ),
        nearest_hq AS (
            SELECT
                dh."head quarter" as name,
                ST_Distance(
                    ST_Transform(i.centroid, 32645),
                    ST_Transform(dh.geom, 32645)
                ) / 1000.0 as distance_km,
                degrees(
                    ST_Azimuth(
                        i.centroid,
                        dh.geom
                    )
                ) as azimuth_degrees
            FROM admin."district Headquarter" dh, input_geom i
            WHERE dh."head quarter" IS NOT NULL
            ORDER BY ST_Distance(i.centroid, dh.geom)
            LIMIT 1
        )
        SELECT
            name,
            distance_km,
            azimuth_degrees,
            CASE
                WHEN azimuth_degrees >= 337.5 OR azimuth_degrees < 22.5 THEN 'North'
                WHEN azimuth_degrees >= 22.5 AND azimuth_degrees < 67.5 THEN 'Northeast'
                WHEN azimuth_degrees >= 67.5 AND azimuth_degrees < 112.5 THEN 'East'
                WHEN azimuth_degrees >= 112.5 AND azimuth_degrees < 157.5 THEN 'Southeast'
                WHEN azimuth_degrees >= 157.5 AND azimuth_degrees < 202.5 THEN 'South'
                WHEN azimuth_degrees >= 202.5 AND azimuth_degrees < 247.5 THEN 'Southwest'
                WHEN azimuth_degrees >= 247.5 AND azimuth_degrees < 292.5 THEN 'West'
                ELSE 'Northwest'
            END as direction
        FROM nearest_hq

2026-01-30 20:10:35,041 INFO sqlalchemy.engine.Engine [cached since 9.255s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:35,050 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:35,050 INFO sqlalchemy.engine.Engine [cached since 9.257s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:37,481 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:37,481 INFO sqlalchemy.engine.Engine [cached since 9.111s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:41,670 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:41,670 INFO sqlalchemy.engine.Engine [cached since 9.34s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,490 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:44,490 INFO sqlalchemy.engine.Engine [cached since 10.18s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,743 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:44,744 INFO sqlalchemy.engine.Engine [cached since 10.24s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,776 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:44,777 INFO sqlalchemy.engine.Engine [cached since 10.26s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,854 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:44,855 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,858 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:44,858 INFO sqlalchemy.engine.Engine [cached since 10.28s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,860 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:44,860 INFO sqlalchemy.engine.Engine [cached since 10.28s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,862 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:44,862 INFO sqlalchemy.engine.Engine [cached since 10.28s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,864 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:44,864 INFO sqlalchemy.engine.Engine [cached since 10.28s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,865 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:44,865 INFO sqlalchemy.engine.Engine [cached since 10.28s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,867 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:44,867 INFO sqlalchemy.engine.Engine [cached since 10.28s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,868 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:44,869 INFO sqlalchemy.engine.Engine [cached since 10.28s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,870 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:44,870 INFO sqlalchemy.engine.Engine [cached since 10.28s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,871 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:44,872 INFO sqlalchemy.engine.Engine [cached since 10.28s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,874 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:44,874 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,877 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:44,877 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,878 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:44,879 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,880 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:44,880 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,881 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:44,881 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,882 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:44,883 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,884 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:44,884 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,885 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:44,885 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,886 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:44,887 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,888 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:44,888 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,890 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:44,891 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,893 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:44,893 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,894 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:44,895 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,896 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:44,896 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,897 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:44,898 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,899 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:44,899 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,900 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:44,900 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,903 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:44,903 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,904 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:44,904 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:10:44,906 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:44,906 INFO sqlalchemy.engine.Engine [cached since 10.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
Block 3 analysis completed successfully
Analyzing block 4/5: Dunetar
2026-01-30 20:10:44,909 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 20:10:44,909 INFO sqlalchemy.engine.Engine [cached since 19.48s ago] {'geojson': '{"type": "Polygon", "coordinates": [[[85.04435770300006, 27.443011379000016], [85.04532252600004, 27.442850742000047], [85.04622706, 27.4427971390000 ... (1378 characters truncated) ... 03, 27.442679439000084], [85.04185512700012, 27.443161052000054], [85.04336274600007, 27.443359324000028], [85.04435770300006, 27.443011379000016]]]}'}
Error converting GeoJSON to WKT: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL:
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt
        ]
[parameters: {'geojson': '{"type": "Polygon", "coordinates": [[[85.04435770300006, 27.443011379000016], [85.04532252600004, 27.442850742000047], [85.04622706, 27.4427971390000 ... (1378 characters truncated) ... 03, 27.442679439000084], [85.04185512700012, 27.443161052000054], [85.04336274600007, 27.443359324000028], [85.04435770300006, 27.443011379000016]]]}'}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
GeoJSON string (first 500 chars): {"type": "Polygon", "coordinates": [[[85.04435770300006, 27.443011379000016], [85.04532252600004, 27.442850742000047], [85.04622706, 27.442797139000053], [85.04709833429281, 27.442935834004423], [85.0470805420001, 27.44276298299998], [85.0473854140001, 27.441747757], [85.048414726, 27.440969345000077], [85.04952027800009, 27.44022477000002], [85.04948197200011, 27.43920961800005], [85.04993943800004, 27.43893886100003], [85.05024430400005, 27.438160551000024], [85.05108293700006, 27.437449859000
Error analyzing block 4: Invalid geometry format: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL:
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt
        ]
[parameters: {'geojson': '{"type": "Polygon", "coordinates": [[[85.04435770300006, 27.443011379000016], [85.04532252600004, 27.442850742000047], [85.04622706, 27.4427971390000 ... (1378 characters truncated) ... 03, 27.442679439000084], [85.04185512700012, 27.443161052000054], [85.04336274600007, 27.443359324000028], [85.04435770300006, 27.443011379000016]]]}'}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2026-01-30 20:10:44,911 INFO sqlalchemy.engine.Engine ROLLBACK
Analyzing block 5/5: Rame kholsa
2026-01-30 20:10:44,912 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:10:44,912 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 20:10:44,913 INFO sqlalchemy.engine.Engine [cached since 19.48s ago] {'geojson': '{"type": "Polygon", "coordinates": [[[85.0431547570001, 27.45588747100002], [85.04395542600008, 27.454973790000093], [85.04467979100006, 27.453857100 ... (1272 characters truncated) ... 000006, 27.45254918800003], [85.04104511200006, 27.45420717300008], [85.04199853799999, 27.455932865000044], [85.0431547570001, 27.45588747100002]]]}'}
2026-01-30 20:10:44,914 INFO sqlalchemy.engine.Engine
        SELECT
            ST_YMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as north,
            ST_YMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as south,
            ST_XMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as east,
            ST_XMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as west

2026-01-30 20:10:44,914 INFO sqlalchemy.engine.Engine [cached since 19.48s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:44,915 INFO sqlalchemy.engine.Engine
            WITH clipped_raster AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.dem
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ),
            pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as elevation
                FROM clipped_raster
            )
            SELECT
                MIN(elevation) as elevation_min,
                MAX(elevation) as elevation_max,
                AVG(elevation) as elevation_mean
            FROM pixel_values
            WHERE elevation > -32000  -- Exclude NoData values (-32768)
              AND elevation >= 0       -- Nepal minimum elevation
              AND elevation <= 9000    -- Nepal maximum elevation

2026-01-30 20:10:44,916 INFO sqlalchemy.engine.Engine [cached since 19.47s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:44,926 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as slope_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.slope
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value > 0
              AND (pvc).value <= 4
            GROUP BY slope_code

2026-01-30 20:10:44,926 INFO sqlalchemy.engine.Engine [cached since 19.42s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:44,934 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as aspect_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.aspect
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 0 AND 8
            GROUP BY aspect_code

2026-01-30 20:10:44,935 INFO sqlalchemy.engine.Engine [cached since 19.42s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:44,944 INFO sqlalchemy.engine.Engine
            WITH boundary AS (
                SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
            ),
            all_pixels AS (
                SELECT
                    (pix).val as height,
                    (pix).geom as pixel_center
                FROM (
                    SELECT ST_PixelAsPolygons(rast) as pix
                    FROM rasters.canopy_height, boundary
                    WHERE ST_Intersects(rast, geom)
                ) as subq
            )
            SELECT
                CASE
                    WHEN height = 0 THEN 'non_forest'
                    WHEN height > 0 AND height <= 5 THEN 'bush_regenerated'
                    WHEN height > 5 AND height <= 15 THEN 'pole_trees'
                    WHEN height > 15 THEN 'high_forest'
                END as canopy_class,
                COUNT(*) as pixel_count,
                AVG(height) as avg_height
            FROM all_pixels, boundary
            WHERE ST_Contains(boundary.geom, ST_Centroid(pixel_center))
              AND height IS NOT NULL
              AND height >= 0
              AND height <= 50
            GROUP BY canopy_class

2026-01-30 20:10:44,945 INFO sqlalchemy.engine.Engine [cached since 19.42s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,055 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as agb_mean,
                (stats).sum as agb_total
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, 1, ST_GeomFromText(%(wkt)s, 4326)),
                    1,  -- band 1
                    true  -- exclude nodata
                ) as stats
                FROM rasters.agb_2022_nepal
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ) as subquery

2026-01-30 20:10:45,055 INFO sqlalchemy.engine.Engine [cached since 19.45s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,059 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as health_class,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_forest_health
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 5
            GROUP BY health_class

2026-01-30 20:10:45,060 INFO sqlalchemy.engine.Engine [cached since 19.44s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,067 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as forest_type_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_type WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 26
            GROUP BY forest_type_code ORDER BY pixel_count DESC

2026-01-30 20:10:45,067 INFO sqlalchemy.engine.Engine [cached since 19.42s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,080 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as landcover_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.esa_world_cover WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
            GROUP BY landcover_code ORDER BY pixel_count DESC

2026-01-30 20:10:45,080 INFO sqlalchemy.engine.Engine [cached since 19.42s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,091 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as loss_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_lossyear WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY loss_year ORDER BY loss_year

2026-01-30 20:10:45,092 INFO sqlalchemy.engine.Engine [cached since 19.42s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,096 INFO sqlalchemy.engine.Engine
            SELECT SUM((pvc).count) as gain_pixels
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_gain WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value = 1

2026-01-30 20:10:45,097 INFO sqlalchemy.engine.Engine [cached since 19.41s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,100 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as fire_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_loss_fire WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY fire_year ORDER BY fire_year

2026-01-30 20:10:45,100 INFO sqlalchemy.engine.Engine [cached since 19.41s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,104 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_mean_temperature WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_mean FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 20:10:45,104 INFO sqlalchemy.engine.Engine [cached since 19.41s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,107 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.min_temp_coldest_month WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_min FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 20:10:45,108 INFO sqlalchemy.engine.Engine [cached since 19.4s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,110 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_precipitation WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as precip FROM clipped
            )
            SELECT AVG(precip) as precip_mean FROM pixel_values WHERE precip IS NOT NULL AND precip >= 0

2026-01-30 20:10:45,111 INFO sqlalchemy.engine.Engine [cached since 19.4s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,113 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as texture_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.soilgrids_isric WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 12
            GROUP BY texture_code ORDER BY pixel_count DESC LIMIT 1

2026-01-30 20:10:45,113 INFO sqlalchemy.engine.Engine [cached since 19.39s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,116 INFO sqlalchemy.engine.Engine
        SELECT p.province
        FROM admin.province p
        WHERE ST_Intersects(
            p.shape,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:45,116 INFO sqlalchemy.engine.Engine [cached since 19.38s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,119 INFO sqlalchemy.engine.Engine
        SELECT m.district, m.gapa_napa as municipality
        FROM admin.municipality m
        WHERE ST_Intersects(
            m.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:45,120 INFO sqlalchemy.engine.Engine [cached since 19.37s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,121 INFO sqlalchemy.engine.Engine
        SELECT w.ward
        FROM admin.ward w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:45,121 INFO sqlalchemy.engine.Engine [cached since 19.37s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,124 INFO sqlalchemy.engine.Engine
        SELECT w."watershed name" as watershed_name, w."major river basin" as major_river_basin
        FROM admin."watershed_Nepal" w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:45,125 INFO sqlalchemy.engine.Engine [cached since 19.36s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,127 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
        ),
        total_area AS (
            SELECT ST_Area(ST_Transform(geom, 32645)) as area
            FROM input_geom
        ),
        geology_intersections AS (
            SELECT
                g."geology class" as geology_class,
                ST_Area(
                    ST_Transform(
                        ST_Intersection(g.geom, i.geom),
                        32645
                    )
                ) as intersection_area
            FROM geology.geology g, input_geom i
            WHERE ST_Intersects(g.geom, i.geom)
            AND g."geology class" IS NOT NULL
            AND g."geology class" != 'No Data'
        )
        SELECT
            geology_class,
            (intersection_area / (SELECT area FROM total_area)) * 100 as percentage
        FROM geology_intersections
        WHERE intersection_area > 0
        ORDER BY percentage DESC

2026-01-30 20:10:45,127 INFO sqlalchemy.engine.Engine [cached since 19.36s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,136 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT
                ST_GeomFromText(%(wkt)s, 4326) as geom,
                ST_Centroid(ST_GeomFromText(%(wkt)s, 4326)) as centroid
        ),
        nearest_hq AS (
            SELECT
                dh."head quarter" as name,
                ST_Distance(
                    ST_Transform(i.centroid, 32645),
                    ST_Transform(dh.geom, 32645)
                ) / 1000.0 as distance_km,
                degrees(
                    ST_Azimuth(
                        i.centroid,
                        dh.geom
                    )
                ) as azimuth_degrees
            FROM admin."district Headquarter" dh, input_geom i
            WHERE dh."head quarter" IS NOT NULL
            ORDER BY ST_Distance(i.centroid, dh.geom)
            LIMIT 1
        )
        SELECT
            name,
            distance_km,
            azimuth_degrees,
            CASE
                WHEN azimuth_degrees >= 337.5 OR azimuth_degrees < 22.5 THEN 'North'
                WHEN azimuth_degrees >= 22.5 AND azimuth_degrees < 67.5 THEN 'Northeast'
                WHEN azimuth_degrees >= 67.5 AND azimuth_degrees < 112.5 THEN 'East'
                WHEN azimuth_degrees >= 112.5 AND azimuth_degrees < 157.5 THEN 'Southeast'
                WHEN azimuth_degrees >= 157.5 AND azimuth_degrees < 202.5 THEN 'South'
                WHEN azimuth_degrees >= 202.5 AND azimuth_degrees < 247.5 THEN 'Southwest'
                WHEN azimuth_degrees >= 247.5 AND azimuth_degrees < 292.5 THEN 'West'
                ELSE 'Northwest'
            END as direction
        FROM nearest_hq

2026-01-30 20:10:45,137 INFO sqlalchemy.engine.Engine [cached since 19.35s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:45,139 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:45,140 INFO sqlalchemy.engine.Engine [cached since 19.35s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:48,579 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:48,579 INFO sqlalchemy.engine.Engine [cached since 20.21s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:54,280 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:54,281 INFO sqlalchemy.engine.Engine [cached since 21.95s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:56,787 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:56,788 INFO sqlalchemy.engine.Engine [cached since 22.48s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,060 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:57,060 INFO sqlalchemy.engine.Engine [cached since 22.56s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,094 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:57,094 INFO sqlalchemy.engine.Engine [cached since 22.58s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,162 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:57,163 INFO sqlalchemy.engine.Engine [cached since 22.6s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,165 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:57,165 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,166 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:57,167 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,168 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:57,168 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,169 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:57,170 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,171 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:57,171 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,172 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:57,173 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,175 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:57,175 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,177 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:57,178 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,179 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:57,179 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,180 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:57,181 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,182 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:10:57,182 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,183 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:57,183 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,184 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:57,185 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,186 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:57,186 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,187 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:57,188 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,189 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:57,190 INFO sqlalchemy.engine.Engine [cached since 22.59s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,193 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:57,193 INFO sqlalchemy.engine.Engine [cached since 22.6s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,195 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:57,195 INFO sqlalchemy.engine.Engine [cached since 22.6s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,196 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:57,197 INFO sqlalchemy.engine.Engine [cached since 22.6s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,198 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:10:57,198 INFO sqlalchemy.engine.Engine [cached since 22.6s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,199 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:57,200 INFO sqlalchemy.engine.Engine [cached since 22.6s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,201 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:57,201 INFO sqlalchemy.engine.Engine [cached since 22.6s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,202 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:57,202 INFO sqlalchemy.engine.Engine [cached since 22.6s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,203 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:57,204 INFO sqlalchemy.engine.Engine [cached since 22.6s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,205 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:57,206 INFO sqlalchemy.engine.Engine [cached since 22.6s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,208 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:57,208 INFO sqlalchemy.engine.Engine [cached since 22.6s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,210 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:57,211 INFO sqlalchemy.engine.Engine [cached since 22.6s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,213 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:57,213 INFO sqlalchemy.engine.Engine [cached since 22.6s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:10:57,214 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:10:57,214 INFO sqlalchemy.engine.Engine [cached since 22.6s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
Block 5 analysis completed successfully
Committing block analysis results...
2026-01-30 20:10:57,216 INFO sqlalchemy.engine.Engine COMMIT
Block analysis committed successfully
Starting whole-forest analysis...
2026-01-30 20:10:57,217 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:10:57,218 INFO sqlalchemy.engine.Engine
        SELECT
            ST_X(ST_Centroid(boundary_geom)) as lon,
            ST_Y(ST_Centroid(boundary_geom)) as lat
        FROM public.calculations
        WHERE id = %(calc_id)s

2026-01-30 20:10:57,218 INFO sqlalchemy.engine.Engine [generated in 0.00037s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,226 INFO sqlalchemy.engine.Engine
        SELECT
            ST_Area(ST_Transform(boundary_geom, 32645)) as area_sqm,
            ST_Area(ST_Transform(boundary_geom, 32645)) / 10000.0 as area_hectares
        FROM public.calculations
        WHERE id = %(calc_id)s

2026-01-30 20:10:57,227 INFO sqlalchemy.engine.Engine [generated in 0.00051s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,229 INFO sqlalchemy.engine.Engine
        SELECT
            ST_YMax(ST_Envelope(boundary_geom)) as north,
            ST_YMin(ST_Envelope(boundary_geom)) as south,
            ST_XMax(ST_Envelope(boundary_geom)) as east,
            ST_XMin(ST_Envelope(boundary_geom)) as west
        FROM calculations WHERE id = %(calc_id)s

2026-01-30 20:10:57,229 INFO sqlalchemy.engine.Engine [generated in 0.00046s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,231 INFO sqlalchemy.engine.Engine
            WITH clipped_raster AS (
                SELECT ST_Clip(rast, boundary_geom) as rast
                FROM rasters.dem, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
                LIMIT 1
            ),
            pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as elevation
                FROM clipped_raster
            )
            SELECT
                MIN(elevation) as elevation_min,
                MAX(elevation) as elevation_max,
                AVG(elevation) as elevation_mean
            FROM pixel_values
            WHERE elevation > -32000  -- Exclude NoData values (-32768)
              AND elevation >= 0       -- Nepal minimum elevation
              AND elevation <= 9000    -- Nepal maximum elevation

2026-01-30 20:10:57,231 INFO sqlalchemy.engine.Engine [generated in 0.00042s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,253 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as slope_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.slope, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value > 0
              AND (pvc).value <= 4
            GROUP BY slope_code

2026-01-30 20:10:57,254 INFO sqlalchemy.engine.Engine [generated in 0.00044s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,263 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as aspect_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.aspect, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 0 AND 8
            GROUP BY aspect_code

2026-01-30 20:10:57,263 INFO sqlalchemy.engine.Engine [generated in 0.00041s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,272 INFO sqlalchemy.engine.Engine
            SELECT
                CASE
                    WHEN (pvc).value = 0 THEN 'non_forest'
                    WHEN (pvc).value > 0 AND (pvc).value <= 5 THEN 'bush_regenerated'
                    WHEN (pvc).value > 5 AND (pvc).value <= 15 THEN 'pole_trees'
                    WHEN (pvc).value > 15 THEN 'high_forest'
                END as canopy_class,
                SUM((pvc).count) as pixel_count,
                AVG((pvc).value) as avg_height
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.canopy_height, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value >= 0
              AND (pvc).value <= 50
            GROUP BY canopy_class

2026-01-30 20:10:57,272 INFO sqlalchemy.engine.Engine [generated in 0.00044s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,279 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as agb_mean,
                (stats).sum as agb_total
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, 1, boundary_geom)
                ) as stats
                FROM rasters.agb_2022_nepal, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
                LIMIT 1
            ) as subquery

2026-01-30 20:10:57,280 INFO sqlalchemy.engine.Engine [generated in 0.00039s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,283 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as health_class,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.nepal_forest_health, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 5
            GROUP BY health_class

2026-01-30 20:10:57,283 INFO sqlalchemy.engine.Engine [generated in 0.00038s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,302 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as forest_type_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.forest_type, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 26
            GROUP BY forest_type_code
            ORDER BY pixel_count DESC

2026-01-30 20:10:57,302 INFO sqlalchemy.engine.Engine [generated in 0.00037s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,310 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as landcover_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.esa_world_cover, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL
            GROUP BY landcover_code
            ORDER BY pixel_count DESC

2026-01-30 20:10:57,311 INFO sqlalchemy.engine.Engine [generated in 0.00043s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,330 INFO sqlalchemy.engine.Engine
            SELECT
                (amt_stats).mean * 0.1 as temp_mean_c,
                (mint_stats).mean * 0.1 as temp_min_c
            FROM (
                SELECT
                    ST_SummaryStats(ST_Clip(amt.rast, calc.boundary_geom), 1, true) as amt_stats,
                    ST_SummaryStats(ST_Clip(mint.rast, calc.boundary_geom), 1, true) as mint_stats
                FROM rasters.annual_mean_temperature amt,
                     rasters.min_temp_coldest_month mint,
                     public.calculations calc
                WHERE calc.id = %(calc_id)s
                  AND ST_Intersects(amt.rast, calc.boundary_geom)
                  AND ST_Intersects(mint.rast, calc.boundary_geom)
                LIMIT 1
            ) as subquery

2026-01-30 20:10:57,330 INFO sqlalchemy.engine.Engine [generated in 0.00045s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,336 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as precip_mean_mm
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, boundary_geom),
                    1,
                    true
                ) as stats
                FROM rasters.annual_precipitation, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
                LIMIT 1
            ) as subquery

2026-01-30 20:10:57,336 INFO sqlalchemy.engine.Engine [generated in 0.00042s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,339 INFO sqlalchemy.engine.Engine
            SELECT ST_Area(ST_Transform(boundary_geom, 32645)) / 10000.0 as area_hectares
            FROM public.calculations
            WHERE id = %(calc_id)s

2026-01-30 20:10:57,339 INFO sqlalchemy.engine.Engine [generated in 0.00036s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,341 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as loss_year_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.nepal_lossyear, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value > 0
            GROUP BY loss_year_code
            ORDER BY loss_year_code

2026-01-30 20:10:57,342 INFO sqlalchemy.engine.Engine [generated in 0.00060s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,348 INFO sqlalchemy.engine.Engine
            SELECT
                SUM((pvc).count) as gain_pixels
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.nepal_gain, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value = 1

2026-01-30 20:10:57,349 INFO sqlalchemy.engine.Engine [generated in 0.00050s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,354 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as fire_year_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.forest_loss_fire, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value > 0
            GROUP BY fire_year_code

2026-01-30 20:10:57,354 INFO sqlalchemy.engine.Engine [generated in 0.00054s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,362 INFO sqlalchemy.engine.Engine
        SELECT ST_AsText(boundary_geom) as wkt
        FROM public.calculations
        WHERE id = %(calc_id)s

2026-01-30 20:10:57,363 INFO sqlalchemy.engine.Engine [generated in 0.00050s] {'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:10:57,364 INFO sqlalchemy.engine.Engine
        SELECT p.province
        FROM admin.province p
        WHERE ST_Intersects(
            p.shape,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:57,364 INFO sqlalchemy.engine.Engine [cached since 31.63s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:10:57,368 INFO sqlalchemy.engine.Engine
        SELECT m.district, m.gapa_napa as municipality
        FROM admin.municipality m
        WHERE ST_Intersects(
            m.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:57,369 INFO sqlalchemy.engine.Engine [cached since 31.62s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:10:57,371 INFO sqlalchemy.engine.Engine
        SELECT w.ward
        FROM admin.ward w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:57,371 INFO sqlalchemy.engine.Engine [cached since 31.62s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:10:57,373 INFO sqlalchemy.engine.Engine
        SELECT w."watershed name" as watershed_name, w."major river basin" as major_river_basin
        FROM admin."watershed_Nepal" w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:10:57,374 INFO sqlalchemy.engine.Engine [cached since 31.61s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:10:57,377 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
        ),
        total_area AS (
            SELECT ST_Area(ST_Transform(geom, 32645)) as area
            FROM input_geom
        ),
        geology_intersections AS (
            SELECT
                g."geology class" as geology_class,
                ST_Area(
                    ST_Transform(
                        ST_Intersection(g.geom, i.geom),
                        32645
                    )
                ) as intersection_area
            FROM geology.geology g, input_geom i
            WHERE ST_Intersects(g.geom, i.geom)
            AND g."geology class" IS NOT NULL
            AND g."geology class" != 'No Data'
        )
        SELECT
            geology_class,
            (intersection_area / (SELECT area FROM total_area)) * 100 as percentage
        FROM geology_intersections
        WHERE intersection_area > 0
        ORDER BY percentage DESC

2026-01-30 20:10:57,378 INFO sqlalchemy.engine.Engine [cached since 31.61s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:10:57,398 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT
                ST_GeomFromText(%(wkt)s, 4326) as geom,
                ST_Centroid(ST_GeomFromText(%(wkt)s, 4326)) as centroid
        ),
        nearest_hq AS (
            SELECT
                dh."head quarter" as name,
                ST_Distance(
                    ST_Transform(i.centroid, 32645),
                    ST_Transform(dh.geom, 32645)
                ) / 1000.0 as distance_km,
                degrees(
                    ST_Azimuth(
                        i.centroid,
                        dh.geom
                    )
                ) as azimuth_degrees
            FROM admin."district Headquarter" dh, input_geom i
            WHERE dh."head quarter" IS NOT NULL
            ORDER BY ST_Distance(i.centroid, dh.geom)
            LIMIT 1
        )
        SELECT
            name,
            distance_km,
            azimuth_degrees,
            CASE
                WHEN azimuth_degrees >= 337.5 OR azimuth_degrees < 22.5 THEN 'North'
                WHEN azimuth_degrees >= 22.5 AND azimuth_degrees < 67.5 THEN 'Northeast'
                WHEN azimuth_degrees >= 67.5 AND azimuth_degrees < 112.5 THEN 'East'
                WHEN azimuth_degrees >= 112.5 AND azimuth_degrees < 157.5 THEN 'Southeast'
                WHEN azimuth_degrees >= 157.5 AND azimuth_degrees < 202.5 THEN 'South'
                WHEN azimuth_degrees >= 202.5 AND azimuth_degrees < 247.5 THEN 'Southwest'
                WHEN azimuth_degrees >= 247.5 AND azimuth_degrees < 292.5 THEN 'West'
                ELSE 'Northwest'
            END as direction
        FROM nearest_hq

2026-01-30 20:10:57,398 INFO sqlalchemy.engine.Engine [cached since 31.61s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:10:57,401 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:10:57,402 INFO sqlalchemy.engine.Engine [cached since 31.61s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:02,254 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:11:02,254 INFO sqlalchemy.engine.Engine [cached since 33.88s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:10,706 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:11:10,706 INFO sqlalchemy.engine.Engine [cached since 38.38s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,112 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:11:14,112 INFO sqlalchemy.engine.Engine [cached since 39.8s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,425 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:11:14,426 INFO sqlalchemy.engine.Engine [cached since 39.92s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,453 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:11:14,454 INFO sqlalchemy.engine.Engine [cached since 39.93s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,516 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:11:14,517 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,518 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:11:14,518 INFO sqlalchemy.engine.Engine [cached since 39.94s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,520 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:11:14,520 INFO sqlalchemy.engine.Engine [cached since 39.94s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,521 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:11:14,521 INFO sqlalchemy.engine.Engine [cached since 39.94s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,523 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:11:14,523 INFO sqlalchemy.engine.Engine [cached since 39.94s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,525 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:11:14,526 INFO sqlalchemy.engine.Engine [cached since 39.94s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,528 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:11:14,528 INFO sqlalchemy.engine.Engine [cached since 39.94s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,530 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:11:14,530 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,531 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:11:14,531 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,532 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:11:14,533 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,534 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:11:14,534 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,535 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:11:14,536 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,537 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:11:14,537 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,539 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:11:14,539 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,541 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:11:14,542 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,544 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:11:14,545 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,546 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:11:14,546 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,548 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:11:14,548 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,549 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:11:14,550 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,551 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:11:14,551 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,552 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:11:14,553 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,554 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:11:14,555 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,556 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:11:14,557 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,558 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:11:14,559 INFO sqlalchemy.engine.Engine [cached since 39.95s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,561 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:11:14,561 INFO sqlalchemy.engine.Engine [cached since 39.96s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,562 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:11:14,563 INFO sqlalchemy.engine.Engine [cached since 39.96s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,565 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:11:14,565 INFO sqlalchemy.engine.Engine [cached since 39.96s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,566 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:11:14,567 INFO sqlalchemy.engine.Engine [cached since 39.96s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,569 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:11:14,569 INFO sqlalchemy.engine.Engine [cached since 39.96s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 20:11:14,571 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:11:14,571 INFO sqlalchemy.engine.Engine [cached since 39.96s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
Analysis completed with 52 keys
Executing UPDATE with 19407 bytes of data
2026-01-30 20:11:14,576 INFO sqlalchemy.engine.Engine
            UPDATE public.calculations
            SET
                result_data = result_data || CAST(%(analysis_data)s AS jsonb),
                processing_time_seconds = %(processing_time)s,
                status = %(status)s,
                completed_at = NOW()
            WHERE id = %(calc_id)s

2026-01-30 20:11:14,576 INFO sqlalchemy.engine.Engine [generated in 0.00065s] {'analysis_data': '{"blocks": [{"area_sqm": 1341233.9729370929, "centroid": {"lat": 27.412665452278205, "lon": 85.06330368613055}, "geometry": {"type": "Polygon", "coor ... (19119 characters truncated) ... tauda", "whole_features_east": null, "whole_features_south": null, "whole_features_west": null, "province": null, "municipality": null, "ward": null}', 'processing_time': 49, 'status': 'COMPLETED', 'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}
2026-01-30 20:11:14,578 INFO sqlalchemy.engine.Engine ROLLBACK
Analysis failed: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL:
            UPDATE public.calculations
            SET
                result_data = result_data || CAST(%(analysis_data)s AS jsonb),
                processing_time_seconds = %(processing_time)s,
                status = %(status)s,
                completed_at = NOW()
            WHERE id = %(calc_id)s
        ]
[parameters: {'analysis_data': '{"blocks": [{"area_sqm": 1341233.9729370929, "centroid": {"lat": 27.412665452278205, "lon": 85.06330368613055}, "geometry": {"type": "Polygon", "coor ... (19119 characters truncated) ... tauda", "whole_features_east": null, "whole_features_south": null, "whole_features_west": null, "province": null, "municipality": null, "ward": null}', 'processing_time': 49, 'status': 'COMPLETED', 'calc_id': '68cb13f7-839b-4b66-8024-33ace7bb629a'}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2026-01-30 20:11:14,581 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:11:14,583 INFO sqlalchemy.engine.Engine SELECT public.calculations.id AS public_calculations_id, public.calculations.user_id AS public_calculations_user_id, public.calculations.application_id AS public_calculations_application_id, public.calculations.uploaded_filename AS public_calculations_uploaded_filename, ST_AsEWKB(public.calculations.boundary_geom) AS public_calculations_boundary_geom, public.calculations.forest_name AS public_calculations_forest_name, public.calculations.block_name AS public_calculations_block_name, public.calculations.result_data AS public_calculations_result_data, public.calculations.processing_time_seconds AS public_calculations_processing_time_seconds, public.calculations.created_at AS public_calculations_created_at, public.calculations.completed_at AS public_calculations_completed_at
FROM public.calculations
WHERE public.calculations.id = %(pk_1)s::UUID
2026-01-30 20:11:14,583 INFO sqlalchemy.engine.Engine [generated in 0.00041s] {'pk_1': UUID('68cb13f7-839b-4b66-8024-33ace7bb629a')}
2026-01-30 20:11:14,587 INFO sqlalchemy.engine.Engine UPDATE public.calculations SET status=%(status)s, error_message=%(error_message)s WHERE public.calculations.id = %(public_calculations_id)s::UUID
2026-01-30 20:11:14,587 INFO sqlalchemy.engine.Engine [generated in 0.00038s] {'status': 'FAILED', 'error_message': '(psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block\n\n[SQL: \n            UPDAT ... (216 characters truncated) ... s)s,\n                completed_at = NOW()\n            WHERE id = %(calc_id)s\n        ]\n[parameters: {\'analysis_data\': \'{"blocks": [{"area_sqm"', 'public_calculations_id': UUID('68cb13f7-839b-4b66-8024-33ace7bb629a')}
2026-01-30 20:11:14,594 INFO sqlalchemy.engine.Engine COMMIT
INFO:     127.0.0.1:64051 - "POST /api/forests/upload HTTP/1.1" 500 Internal Server Error
