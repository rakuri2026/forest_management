========================================
Community Forest Management System
========================================

Activating virtual environment...

========================================
Starting FastAPI server on port 8001...
API Documentation: http://localhost:8001/docs
Health Check: http://localhost:8001/health
========================================

INFO:     Will watch for changes in these directories: ['D:\\forest_management\\backend']
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
INFO:     Started reloader process [11532] using WatchFiles
INFO:     Started server process [3528]
INFO:     Waiting for application startup.
Starting Community Forest Management System v1.0.0
Debug mode: True
2026-01-30 19:59:41,880 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2026-01-30 19:59:41,880 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-30 19:59:41,881 INFO sqlalchemy.engine.Engine select current_schema()
2026-01-30 19:59:41,882 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-30 19:59:41,882 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2026-01-30 19:59:41,882 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-30 19:59:41,884 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 19:59:41,884 INFO sqlalchemy.engine.Engine SELECT 1
2026-01-30 19:59:41,885 INFO sqlalchemy.engine.Engine [generated in 0.00036s] {}
2026-01-30 19:59:41,885 INFO sqlalchemy.engine.Engine ROLLBACK
Database connection successful
INFO:     Application startup complete.
INFO:     127.0.0.1:53698 - "OPTIONS /api/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:64486 - "OPTIONS /api/auth/me HTTP/1.1" 200 OK
2026-01-30 20:00:37,637 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:00:37,648 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 20:00:37,649 INFO sqlalchemy.engine.Engine [generated in 0.00062s] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
2026-01-30 20:00:37,742 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:00:37,743 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 20:00:37,743 INFO sqlalchemy.engine.Engine [cached since 0.09491s ago] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
INFO:     127.0.0.1:53698 - "GET /api/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:64486 - "GET /api/auth/me HTTP/1.1" 200 OK
2026-01-30 20:00:37,752 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-30 20:00:37,753 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     127.0.0.1:55896 - "OPTIONS /api/auth/login HTTP/1.1" 200 OK
2026-01-30 20:00:53,145 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:00:53,148 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.email = %(email_1)s
 LIMIT %(param_1)s
2026-01-30 20:00:53,149 INFO sqlalchemy.engine.Engine [generated in 0.00072s] {'email_1': 'newuser@example.com', 'param_1': 1}
2026-01-30 20:00:53,861 INFO sqlalchemy.engine.Engine UPDATE public.users SET last_login=%(last_login)s WHERE public.users.id = %(public_users_id)s::UUID
2026-01-30 20:00:53,862 INFO sqlalchemy.engine.Engine [generated in 0.00067s] {'last_login': datetime.datetime(2026, 1, 30, 14, 15, 53, 858189), 'public_users_id': UUID('4852473e-6cb9-4422-91b9-aa8d59d39e83')}
2026-01-30 20:00:53,872 INFO sqlalchemy.engine.Engine COMMIT
2026-01-30 20:00:53,876 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:00:53,878 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(pk_1)s::UUID
2026-01-30 20:00:53,879 INFO sqlalchemy.engine.Engine [generated in 0.00064s] {'pk_1': UUID('4852473e-6cb9-4422-91b9-aa8d59d39e83')}
INFO:     127.0.0.1:55896 - "POST /api/auth/login HTTP/1.1" 200 OK
2026-01-30 20:00:53,886 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-30 20:00:53,894 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:00:53,894 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 20:00:53,895 INFO sqlalchemy.engine.Engine [cached since 16.25s ago] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
INFO:     127.0.0.1:55896 - "GET /api/auth/me HTTP/1.1" 200 OK
2026-01-30 20:00:53,899 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     127.0.0.1:55896 - "OPTIONS /api/forests/my-forests HTTP/1.1" 200 OK
INFO:     127.0.0.1:50462 - "OPTIONS /api/forests/my-forests HTTP/1.1" 200 OK
2026-01-30 20:00:53,969 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:00:53,970 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 20:00:53,970 INFO sqlalchemy.engine.Engine [cached since 16.32s ago] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
2026-01-30 20:00:53,981 INFO sqlalchemy.engine.Engine SELECT admin."community forests".id AS "admin_community forests_id", ST_AsEWKB(admin."community forests".geom) AS "admin_community forests_geom", admin."community forests".name AS "admin_community forests_name", admin."community forests".code AS "admin_community forests_code", admin."community forests".regime AS "admin_community forests_regime", admin."community forests"."area sqm" AS "admin_community forests_area sqm", public.forest_managers.role AS public_forest_managers_role
FROM admin."community forests" JOIN public.forest_managers ON public.forest_managers.community_forest_id = admin."community forests".id
WHERE public.forest_managers.user_id = %(user_id_1)s::UUID AND public.forest_managers.is_active = true
2026-01-30 20:00:53,981 INFO sqlalchemy.engine.Engine [generated in 0.00054s] {'user_id_1': UUID('4852473e-6cb9-4422-91b9-aa8d59d39e83')}
2026-01-30 20:00:54,052 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:00:54,053 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 20:00:54,053 INFO sqlalchemy.engine.Engine [cached since 16.4s ago] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
2026-01-30 20:00:54,058 INFO sqlalchemy.engine.Engine SELECT admin."community forests".id AS "admin_community forests_id", ST_AsEWKB(admin."community forests".geom) AS "admin_community forests_geom", admin."community forests".name AS "admin_community forests_name", admin."community forests".code AS "admin_community forests_code", admin."community forests".regime AS "admin_community forests_regime", admin."community forests"."area sqm" AS "admin_community forests_area sqm", public.forest_managers.role AS public_forest_managers_role
FROM admin."community forests" JOIN public.forest_managers ON public.forest_managers.community_forest_id = admin."community forests".id
WHERE public.forest_managers.user_id = %(user_id_1)s::UUID AND public.forest_managers.is_active = true
2026-01-30 20:00:54,058 INFO sqlalchemy.engine.Engine [cached since 0.07761s ago] {'user_id_1': UUID('4852473e-6cb9-4422-91b9-aa8d59d39e83')}
INFO:     127.0.0.1:50462 - "GET /api/forests/my-forests HTTP/1.1" 200 OK
INFO:     127.0.0.1:55896 - "GET /api/forests/my-forests HTTP/1.1" 200 OK
2026-01-30 20:00:54,085 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-30 20:00:54,086 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     127.0.0.1:52212 - "OPTIONS /api/forests/upload HTTP/1.1" 200 OK
2026-01-30 20:01:17,315 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:01:17,316 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 20:01:17,317 INFO sqlalchemy.engine.Engine [cached since 39.67s ago] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
2026-01-30 20:01:17,500 INFO sqlalchemy.engine.Engine INSERT INTO public.calculations (id, user_id, application_id, uploaded_filename, boundary_geom, forest_name, block_name, result_data, status, processing_time_seconds, error_message, created_at, completed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(application_id)s::UUID, %(uploaded_filename)s, ST_GeomFromText(%(ST_GeomFromText_1)s, %(ST_GeomFromText_2)s), %(forest_name)s, %(block_name)s, %(result_data)s::JSONB, %(status)s, %(processing_time_seconds)s, %(error_message)s, %(created_at)s, %(completed_at)s)
2026-01-30 20:01:17,501 INFO sqlalchemy.engine.Engine [generated in 0.00283s] {'id': UUID('a5ce545f-30a1-4185-b1e0-515f58741d68'), 'user_id': UUID('4852473e-6cb9-4422-91b9-aa8d59d39e83'), 'application_id': None, 'uploaded_filename': 'sundar.zip', 'ST_GeomFromText_1': 'MULTIPOLYGON (((85.06166514100008 27.41872503600006, 85.06203161900002 27.418646880000075, 85.06232481400012 27.41863380400006, 85.062764611 27.41862 ... (8402 characters truncated) ... 85.04009173000006 27.45254918800003, 85.04104511200006 27.45420717300008, 85.04199853799999 27.455932865000044, 85.0431547570001 27.45588747100002)))', 'ST_GeomFromText_2': 4326, 'forest_name': 'Kathmandu', 'block_name': 'lalitpur', 'result_data': '{"total_blocks": 5, "blocks": [{"block_index": 0, "block_name": "Panchpokhari pakho", "area_sqm": 1341233.9729370929, "area_hectares": 134.1233972937 ... (10347 characters truncated) ... 588747100002]]]}, "centroid": {"lon": 85.0419834247576, "lat": 27.44726912429787}}], "processing_info": {"partitioned": false, "partition_info": {}}}', 'status': 'PROCESSING', 'processing_time_seconds': None, 'error_message': None, 'created_at': datetime.datetime(2026, 1, 30, 14, 16, 17, 498905), 'completed_at': None}
2026-01-30 20:01:17,530 INFO sqlalchemy.engine.Engine COMMIT
2026-01-30 20:01:17,534 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:01:17,537 INFO sqlalchemy.engine.Engine SELECT public.calculations.id, public.calculations.user_id, public.calculations.application_id, public.calculations.uploaded_filename, ST_AsEWKB(public.calculations.boundary_geom) AS boundary_geom, public.calculations.forest_name, public.calculations.block_name, public.calculations.result_data, public.calculations.status, public.calculations.processing_time_seconds, public.calculations.error_message, public.calculations.created_at, public.calculations.completed_at
FROM public.calculations
WHERE public.calculations.id = %(pk_1)s::UUID
2026-01-30 20:01:17,538 INFO sqlalchemy.engine.Engine [generated in 0.00057s] {'pk_1': UUID('a5ce545f-30a1-4185-b1e0-515f58741d68')}
Starting analysis for calculation a5ce545f-30a1-4185-b1e0-515f58741d68
2026-01-30 20:01:17,548 INFO sqlalchemy.engine.Engine SELECT public.calculations.id AS public_calculations_id, public.calculations.user_id AS public_calculations_user_id, public.calculations.application_id AS public_calculations_application_id, public.calculations.uploaded_filename AS public_calculations_uploaded_filename, ST_AsEWKB(public.calculations.boundary_geom) AS public_calculations_boundary_geom, public.calculations.forest_name AS public_calculations_forest_name, public.calculations.block_name AS public_calculations_block_name, public.calculations.result_data AS public_calculations_result_data, public.calculations.status AS public_calculations_status, public.calculations.processing_time_seconds AS public_calculations_processing_time_seconds, public.calculations.error_message AS public_calculations_error_message, public.calculations.created_at AS public_calculations_created_at, public.calculations.completed_at AS public_calculations_completed_at
FROM public.calculations
WHERE public.calculations.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 20:01:17,549 INFO sqlalchemy.engine.Engine [generated in 0.00078s] {'id_1': UUID('a5ce545f-30a1-4185-b1e0-515f58741d68'), 'param_1': 1}
Analyzing block 1/5: Panchpokhari pakho
2026-01-30 20:01:17,553 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 20:01:17,554 INFO sqlalchemy.engine.Engine [generated in 0.00074s] {'geojson': '{"type": "Polygon", "coordinates": [[[85.06166514100008, 27.41872503600006], [85.06203161900002, 27.418646880000075], [85.06232481400012, 27.41863380 ... (2153 characters truncated) ... 0005, 27.418321877000007], [85.06082951000012, 27.41866014500002], [85.06119604100007, 27.418790200000032], [85.06166514100008, 27.41872503600006]]]}'}
2026-01-30 20:01:17,562 INFO sqlalchemy.engine.Engine
        SELECT
            ST_YMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as north,
            ST_YMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as south,
            ST_XMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as east,
            ST_XMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as west

2026-01-30 20:01:17,563 INFO sqlalchemy.engine.Engine [generated in 0.00059s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:17,578 INFO sqlalchemy.engine.Engine
            WITH clipped_raster AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.dem
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ),
            pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as elevation
                FROM clipped_raster
            )
            SELECT
                MIN(elevation) as elevation_min,
                MAX(elevation) as elevation_max,
                AVG(elevation) as elevation_mean
            FROM pixel_values
            WHERE elevation > -32000  -- Exclude NoData values (-32768)
              AND elevation >= 0       -- Nepal minimum elevation
              AND elevation <= 9000    -- Nepal maximum elevation

2026-01-30 20:01:17,579 INFO sqlalchemy.engine.Engine [generated in 0.00063s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:17,737 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as slope_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.slope
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value > 0
              AND (pvc).value <= 4
            GROUP BY slope_code

2026-01-30 20:01:17,738 INFO sqlalchemy.engine.Engine [generated in 0.00077s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:17,755 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as aspect_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.aspect
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 0 AND 8
            GROUP BY aspect_code

2026-01-30 20:01:17,756 INFO sqlalchemy.engine.Engine [generated in 0.00060s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:17,769 INFO sqlalchemy.engine.Engine
            WITH boundary AS (
                SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
            ),
            all_pixels AS (
                SELECT
                    (pix).val as height,
                    (pix).geom as pixel_center
                FROM (
                    SELECT ST_PixelAsPolygons(rast) as pix
                    FROM rasters.canopy_height, boundary
                    WHERE ST_Intersects(rast, geom)
                ) as subq
            )
            SELECT
                CASE
                    WHEN height = 0 THEN 'non_forest'
                    WHEN height > 0 AND height <= 5 THEN 'bush_regenerated'
                    WHEN height > 5 AND height <= 15 THEN 'pole_trees'
                    WHEN height > 15 THEN 'high_forest'
                END as canopy_class,
                COUNT(*) as pixel_count,
                AVG(height) as avg_height
            FROM all_pixels, boundary
            WHERE ST_Contains(boundary.geom, ST_Centroid(pixel_center))
              AND height IS NOT NULL
              AND height >= 0
              AND height <= 50
            GROUP BY canopy_class

2026-01-30 20:01:17,770 INFO sqlalchemy.engine.Engine [generated in 0.00091s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:17,902 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as agb_mean,
                (stats).sum as agb_total
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, 1, ST_GeomFromText(%(wkt)s, 4326)),
                    1,  -- band 1
                    true  -- exclude nodata
                ) as stats
                FROM rasters.agb_2022_nepal
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ) as subquery

2026-01-30 20:01:17,902 INFO sqlalchemy.engine.Engine [generated in 0.00069s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:17,915 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as health_class,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_forest_health
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 5
            GROUP BY health_class

2026-01-30 20:01:17,915 INFO sqlalchemy.engine.Engine [generated in 0.00060s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:17,938 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as forest_type_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_type WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 26
            GROUP BY forest_type_code ORDER BY pixel_count DESC

2026-01-30 20:01:17,939 INFO sqlalchemy.engine.Engine [generated in 0.00061s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:17,955 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as landcover_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.esa_world_cover WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
            GROUP BY landcover_code ORDER BY pixel_count DESC

2026-01-30 20:01:17,956 INFO sqlalchemy.engine.Engine [generated in 0.00067s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:17,976 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as loss_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_lossyear WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY loss_year ORDER BY loss_year

2026-01-30 20:01:17,976 INFO sqlalchemy.engine.Engine [generated in 0.00060s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:17,989 INFO sqlalchemy.engine.Engine
            SELECT SUM((pvc).count) as gain_pixels
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_gain WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value = 1

2026-01-30 20:01:17,990 INFO sqlalchemy.engine.Engine [generated in 0.00057s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:17,998 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as fire_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_loss_fire WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY fire_year ORDER BY fire_year

2026-01-30 20:01:17,999 INFO sqlalchemy.engine.Engine [generated in 0.00084s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:18,008 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_mean_temperature WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_mean FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 20:01:18,008 INFO sqlalchemy.engine.Engine [generated in 0.00061s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:18,020 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.min_temp_coldest_month WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_min FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 20:01:18,021 INFO sqlalchemy.engine.Engine [generated in 0.00054s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:18,032 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_precipitation WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as precip FROM clipped
            )
            SELECT AVG(precip) as precip_mean FROM pixel_values WHERE precip IS NOT NULL AND precip >= 0

2026-01-30 20:01:18,032 INFO sqlalchemy.engine.Engine [generated in 0.00071s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:18,045 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as texture_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.soilgrids_isric WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 12
            GROUP BY texture_code ORDER BY pixel_count DESC LIMIT 1

2026-01-30 20:01:18,046 INFO sqlalchemy.engine.Engine [generated in 0.00060s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:18,069 INFO sqlalchemy.engine.Engine
        SELECT p.province
        FROM admin.province p
        WHERE ST_Intersects(
            p.shape,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:01:18,070 INFO sqlalchemy.engine.Engine [generated in 0.00232s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:18,083 INFO sqlalchemy.engine.Engine
        SELECT m.district, m.gapa_napa as municipality
        FROM admin.municipality m
        WHERE ST_Intersects(
            m.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:01:18,083 INFO sqlalchemy.engine.Engine [generated in 0.00065s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:18,093 INFO sqlalchemy.engine.Engine
        SELECT w.ward
        FROM admin.ward w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:01:18,093 INFO sqlalchemy.engine.Engine [generated in 0.00058s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:18,101 INFO sqlalchemy.engine.Engine
        SELECT w."watershed name" as watershed_name, w."major river basin" as major_river_basin
        FROM admin."watershed_Nepal" w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:01:18,102 INFO sqlalchemy.engine.Engine [generated in 0.00068s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:18,117 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
        ),
        total_area AS (
            SELECT ST_Area(ST_Transform(geom, 32645)) as area
            FROM input_geom
        ),
        geology_intersections AS (
            SELECT
                g."geology class" as geology_class,
                ST_Area(
                    ST_Transform(
                        ST_Intersection(g.geom, i.geom),
                        32645
                    )
                ) as intersection_area
            FROM geology.geology g, input_geom i
            WHERE ST_Intersects(g.geom, i.geom)
            AND g."geology class" IS NOT NULL
            AND g."geology class" != 'No Data'
        )
        SELECT
            geology_class,
            (intersection_area / (SELECT area FROM total_area)) * 100 as percentage
        FROM geology_intersections
        WHERE intersection_area > 0
        ORDER BY percentage DESC

2026-01-30 20:01:18,117 INFO sqlalchemy.engine.Engine [generated in 0.00069s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:18,172 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT
                ST_GeomFromText(%(wkt)s, 4326) as geom,
                ST_Centroid(ST_GeomFromText(%(wkt)s, 4326)) as centroid
        ),
        nearest_hq AS (
            SELECT
                dh."head quarter" as name,
                ST_Distance(
                    ST_Transform(i.centroid, 32645),
                    ST_Transform(dh.geom, 32645)
                ) / 1000.0 as distance_km,
                degrees(
                    ST_Azimuth(
                        i.centroid,
                        dh.geom
                    )
                ) as azimuth_degrees
            FROM admin."district Headquarter" dh, input_geom i
            WHERE dh."head quarter" IS NOT NULL
            ORDER BY ST_Distance(i.centroid, dh.geom)
            LIMIT 1
        )
        SELECT
            name,
            distance_km,
            azimuth_degrees,
            CASE
                WHEN azimuth_degrees >= 337.5 OR azimuth_degrees < 22.5 THEN 'North'
                WHEN azimuth_degrees >= 22.5 AND azimuth_degrees < 67.5 THEN 'Northeast'
                WHEN azimuth_degrees >= 67.5 AND azimuth_degrees < 112.5 THEN 'East'
                WHEN azimuth_degrees >= 112.5 AND azimuth_degrees < 157.5 THEN 'Southeast'
                WHEN azimuth_degrees >= 157.5 AND azimuth_degrees < 202.5 THEN 'South'
                WHEN azimuth_degrees >= 202.5 AND azimuth_degrees < 247.5 THEN 'Southwest'
                WHEN azimuth_degrees >= 247.5 AND azimuth_degrees < 292.5 THEN 'West'
                ELSE 'Northwest'
            END as direction
        FROM nearest_hq

2026-01-30 20:01:18,172 INFO sqlalchemy.engine.Engine [generated in 0.00065s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:18,187 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:18,188 INFO sqlalchemy.engine.Engine [generated in 0.00115s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:20,911 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:20,912 INFO sqlalchemy.engine.Engine [generated in 0.00036s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:24,907 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:24,907 INFO sqlalchemy.engine.Engine [generated in 0.00045s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:26,841 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:26,841 INFO sqlalchemy.engine.Engine [generated in 0.00044s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,019 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:27,020 INFO sqlalchemy.engine.Engine [generated in 0.00034s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,040 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:27,040 INFO sqlalchemy.engine.Engine [generated in 0.00042s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,103 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:27,103 INFO sqlalchemy.engine.Engine [generated in 0.00033s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,117 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:27,118 INFO sqlalchemy.engine.Engine [generated in 0.00066s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,119 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:27,120 INFO sqlalchemy.engine.Engine [generated in 0.00063s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,122 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:27,123 INFO sqlalchemy.engine.Engine [generated in 0.00055s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,124 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:27,125 INFO sqlalchemy.engine.Engine [generated in 0.00062s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,126 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:27,127 INFO sqlalchemy.engine.Engine [generated in 0.00059s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,128 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:27,128 INFO sqlalchemy.engine.Engine [generated in 0.00034s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,130 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:27,130 INFO sqlalchemy.engine.Engine [generated in 0.00041s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,132 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:27,132 INFO sqlalchemy.engine.Engine [generated in 0.00056s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,134 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:27,134 INFO sqlalchemy.engine.Engine [generated in 0.00047s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,136 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:27,136 INFO sqlalchemy.engine.Engine [generated in 0.00034s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,137 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:27,138 INFO sqlalchemy.engine.Engine [generated in 0.00037s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,139 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:27,139 INFO sqlalchemy.engine.Engine [generated in 0.00036s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,140 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:27,141 INFO sqlalchemy.engine.Engine [generated in 0.00033s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,141 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:27,142 INFO sqlalchemy.engine.Engine [generated in 0.00026s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,142 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:27,143 INFO sqlalchemy.engine.Engine [generated in 0.00021s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,143 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:27,143 INFO sqlalchemy.engine.Engine [generated in 0.00019s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,144 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:27,144 INFO sqlalchemy.engine.Engine [generated in 0.00024s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,145 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:27,145 INFO sqlalchemy.engine.Engine [generated in 0.00027s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,146 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:27,147 INFO sqlalchemy.engine.Engine [generated in 0.00039s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,149 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:27,150 INFO sqlalchemy.engine.Engine [generated in 0.00060s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,151 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:27,152 INFO sqlalchemy.engine.Engine [generated in 0.00066s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,154 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:27,154 INFO sqlalchemy.engine.Engine [generated in 0.00042s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,156 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:27,156 INFO sqlalchemy.engine.Engine [generated in 0.00034s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,157 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:27,157 INFO sqlalchemy.engine.Engine [generated in 0.00063s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,159 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:27,159 INFO sqlalchemy.engine.Engine [generated in 0.00049s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,161 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:27,161 INFO sqlalchemy.engine.Engine [generated in 0.00043s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,162 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:27,163 INFO sqlalchemy.engine.Engine [generated in 0.00040s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,164 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:27,166 INFO sqlalchemy.engine.Engine [generated in 0.00201s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 20:01:27,169 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:27,170 INFO sqlalchemy.engine.Engine [generated in 0.00080s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
Block 1 analysis completed successfully
Analyzing block 2/5: Chaukune Bari
2026-01-30 20:01:27,172 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 20:01:27,173 INFO sqlalchemy.engine.Engine [cached since 9.619s ago] {'geojson': '{"type": "Polygon", "coordinates": [[[85.0574253390001, 27.427365587000086], [85.05864488600011, 27.425978034000032], [85.0597119070001, 27.424556682 ... (1876 characters truncated) ... 000001, 27.42689951299998], [85.0565676690001, 27.427288961000052], [85.05733172489794, 27.42768438178319], [85.0574253390001, 27.427365587000086]]]}'}
Error converting GeoJSON to WKT: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL:
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt
        ]
[parameters: {'geojson': '{"type": "Polygon", "coordinates": [[[85.0574253390001, 27.427365587000086], [85.05864488600011, 27.425978034000032], [85.0597119070001, 27.424556682 ... (1876 characters truncated) ... 000001, 27.42689951299998], [85.0565676690001, 27.427288961000052], [85.05733172489794, 27.42768438178319], [85.0574253390001, 27.427365587000086]]]}'}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
GeoJSON string (first 500 chars): {"type": "Polygon", "coordinates": [[[85.0574253390001, 27.427365587000086], [85.05864488600011, 27.425978034000032], [85.0597119070001, 27.424556682000023], [85.06005456700004, 27.422932459000016], [85.06093082800007, 27.421071286000032], [85.06222662600008, 27.420123600000046], [85.0633639512823, 27.41868062614693], [85.06308713600005, 27.418633638000045], [85.062764611, 27.41862069600004], [85.06232481400012, 27.41863380400006], [85.06203161900002, 27.418646880000075], [85.06166514100008, 27.
Error analyzing block 2: Invalid geometry format: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL:
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt
        ]
[parameters: {'geojson': '{"type": "Polygon", "coordinates": [[[85.0574253390001, 27.427365587000086], [85.05864488600011, 27.425978034000032], [85.0597119070001, 27.424556682 ... (1876 characters truncated) ... 000001, 27.42689951299998], [85.0565676690001, 27.427288961000052], [85.05733172489794, 27.42768438178319], [85.0574253390001, 27.427365587000086]]]}'}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2026-01-30 20:01:27,174 INFO sqlalchemy.engine.Engine ROLLBACK
Analyzing block 3/5: Tikaram pakho
2026-01-30 20:01:27,177 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:01:27,177 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 20:01:27,177 INFO sqlalchemy.engine.Engine [cached since 9.624s ago] {'geojson': '{"type": "Polygon", "coordinates": [[[85.05123494200002, 27.434844373], [85.05250854700007, 27.43281449000009], [85.05384280200006, 27.43220514200003 ... (1387 characters truncated) ... 4262600008, 27.435571854000063], [85.05020597900007, 27.43599990300004], [85.05073287130257, 27.43625625445806], [85.05123494200002, 27.434844373]]]}'}
2026-01-30 20:01:27,183 INFO sqlalchemy.engine.Engine
        SELECT
            ST_YMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as north,
            ST_YMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as south,
            ST_XMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as east,
            ST_XMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as west

2026-01-30 20:01:27,184 INFO sqlalchemy.engine.Engine [cached since 9.622s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,194 INFO sqlalchemy.engine.Engine
            WITH clipped_raster AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.dem
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ),
            pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as elevation
                FROM clipped_raster
            )
            SELECT
                MIN(elevation) as elevation_min,
                MAX(elevation) as elevation_max,
                AVG(elevation) as elevation_mean
            FROM pixel_values
            WHERE elevation > -32000  -- Exclude NoData values (-32768)
              AND elevation >= 0       -- Nepal minimum elevation
              AND elevation <= 9000    -- Nepal maximum elevation

2026-01-30 20:01:27,194 INFO sqlalchemy.engine.Engine [cached since 9.616s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,272 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as slope_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.slope
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value > 0
              AND (pvc).value <= 4
            GROUP BY slope_code

2026-01-30 20:01:27,272 INFO sqlalchemy.engine.Engine [cached since 9.535s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,282 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as aspect_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.aspect
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 0 AND 8
            GROUP BY aspect_code

2026-01-30 20:01:27,282 INFO sqlalchemy.engine.Engine [cached since 9.527s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,292 INFO sqlalchemy.engine.Engine
            WITH boundary AS (
                SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
            ),
            all_pixels AS (
                SELECT
                    (pix).val as height,
                    (pix).geom as pixel_center
                FROM (
                    SELECT ST_PixelAsPolygons(rast) as pix
                    FROM rasters.canopy_height, boundary
                    WHERE ST_Intersects(rast, geom)
                ) as subq
            )
            SELECT
                CASE
                    WHEN height = 0 THEN 'non_forest'
                    WHEN height > 0 AND height <= 5 THEN 'bush_regenerated'
                    WHEN height > 5 AND height <= 15 THEN 'pole_trees'
                    WHEN height > 15 THEN 'high_forest'
                END as canopy_class,
                COUNT(*) as pixel_count,
                AVG(height) as avg_height
            FROM all_pixels, boundary
            WHERE ST_Contains(boundary.geom, ST_Centroid(pixel_center))
              AND height IS NOT NULL
              AND height >= 0
              AND height <= 50
            GROUP BY canopy_class

2026-01-30 20:01:27,292 INFO sqlalchemy.engine.Engine [cached since 9.523s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,396 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as agb_mean,
                (stats).sum as agb_total
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, 1, ST_GeomFromText(%(wkt)s, 4326)),
                    1,  -- band 1
                    true  -- exclude nodata
                ) as stats
                FROM rasters.agb_2022_nepal
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ) as subquery

2026-01-30 20:01:27,396 INFO sqlalchemy.engine.Engine [cached since 9.495s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,404 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as health_class,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_forest_health
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 5
            GROUP BY health_class

2026-01-30 20:01:27,404 INFO sqlalchemy.engine.Engine [cached since 9.489s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,409 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as forest_type_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_type WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 26
            GROUP BY forest_type_code ORDER BY pixel_count DESC

2026-01-30 20:01:27,409 INFO sqlalchemy.engine.Engine [cached since 9.471s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,415 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as landcover_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.esa_world_cover WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
            GROUP BY landcover_code ORDER BY pixel_count DESC

2026-01-30 20:01:27,416 INFO sqlalchemy.engine.Engine [cached since 9.46s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,423 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as loss_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_lossyear WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY loss_year ORDER BY loss_year

2026-01-30 20:01:27,423 INFO sqlalchemy.engine.Engine [cached since 9.447s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,427 INFO sqlalchemy.engine.Engine
            SELECT SUM((pvc).count) as gain_pixels
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_gain WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value = 1

2026-01-30 20:01:27,427 INFO sqlalchemy.engine.Engine [cached since 9.438s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,431 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as fire_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_loss_fire WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY fire_year ORDER BY fire_year

2026-01-30 20:01:27,431 INFO sqlalchemy.engine.Engine [cached since 9.433s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,436 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_mean_temperature WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_mean FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 20:01:27,436 INFO sqlalchemy.engine.Engine [cached since 9.429s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,440 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.min_temp_coldest_month WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_min FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 20:01:27,440 INFO sqlalchemy.engine.Engine [cached since 9.42s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,443 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_precipitation WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as precip FROM clipped
            )
            SELECT AVG(precip) as precip_mean FROM pixel_values WHERE precip IS NOT NULL AND precip >= 0

2026-01-30 20:01:27,444 INFO sqlalchemy.engine.Engine [cached since 9.412s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,447 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as texture_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.soilgrids_isric WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 12
            GROUP BY texture_code ORDER BY pixel_count DESC LIMIT 1

2026-01-30 20:01:27,447 INFO sqlalchemy.engine.Engine [cached since 9.402s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,454 INFO sqlalchemy.engine.Engine
        SELECT p.province
        FROM admin.province p
        WHERE ST_Intersects(
            p.shape,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:01:27,454 INFO sqlalchemy.engine.Engine [cached since 9.387s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,458 INFO sqlalchemy.engine.Engine
        SELECT m.district, m.gapa_napa as municipality
        FROM admin.municipality m
        WHERE ST_Intersects(
            m.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:01:27,458 INFO sqlalchemy.engine.Engine [cached since 9.376s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,461 INFO sqlalchemy.engine.Engine
        SELECT w.ward
        FROM admin.ward w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:01:27,461 INFO sqlalchemy.engine.Engine [cached since 9.368s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,463 INFO sqlalchemy.engine.Engine
        SELECT w."watershed name" as watershed_name, w."major river basin" as major_river_basin
        FROM admin."watershed_Nepal" w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:01:27,464 INFO sqlalchemy.engine.Engine [cached since 9.362s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,468 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
        ),
        total_area AS (
            SELECT ST_Area(ST_Transform(geom, 32645)) as area
            FROM input_geom
        ),
        geology_intersections AS (
            SELECT
                g."geology class" as geology_class,
                ST_Area(
                    ST_Transform(
                        ST_Intersection(g.geom, i.geom),
                        32645
                    )
                ) as intersection_area
            FROM geology.geology g, input_geom i
            WHERE ST_Intersects(g.geom, i.geom)
            AND g."geology class" IS NOT NULL
            AND g."geology class" != 'No Data'
        )
        SELECT
            geology_class,
            (intersection_area / (SELECT area FROM total_area)) * 100 as percentage
        FROM geology_intersections
        WHERE intersection_area > 0
        ORDER BY percentage DESC

2026-01-30 20:01:27,468 INFO sqlalchemy.engine.Engine [cached since 9.352s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,481 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT
                ST_GeomFromText(%(wkt)s, 4326) as geom,
                ST_Centroid(ST_GeomFromText(%(wkt)s, 4326)) as centroid
        ),
        nearest_hq AS (
            SELECT
                dh."head quarter" as name,
                ST_Distance(
                    ST_Transform(i.centroid, 32645),
                    ST_Transform(dh.geom, 32645)
                ) / 1000.0 as distance_km,
                degrees(
                    ST_Azimuth(
                        i.centroid,
                        dh.geom
                    )
                ) as azimuth_degrees
            FROM admin."district Headquarter" dh, input_geom i
            WHERE dh."head quarter" IS NOT NULL
            ORDER BY ST_Distance(i.centroid, dh.geom)
            LIMIT 1
        )
        SELECT
            name,
            distance_km,
            azimuth_degrees,
            CASE
                WHEN azimuth_degrees >= 337.5 OR azimuth_degrees < 22.5 THEN 'North'
                WHEN azimuth_degrees >= 22.5 AND azimuth_degrees < 67.5 THEN 'Northeast'
                WHEN azimuth_degrees >= 67.5 AND azimuth_degrees < 112.5 THEN 'East'
                WHEN azimuth_degrees >= 112.5 AND azimuth_degrees < 157.5 THEN 'Southeast'
                WHEN azimuth_degrees >= 157.5 AND azimuth_degrees < 202.5 THEN 'South'
                WHEN azimuth_degrees >= 202.5 AND azimuth_degrees < 247.5 THEN 'Southwest'
                WHEN azimuth_degrees >= 247.5 AND azimuth_degrees < 292.5 THEN 'West'
                ELSE 'Northwest'
            END as direction
        FROM nearest_hq

2026-01-30 20:01:27,482 INFO sqlalchemy.engine.Engine [cached since 9.31s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:27,486 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:27,486 INFO sqlalchemy.engine.Engine [cached since 9.299s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:29,990 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:29,991 INFO sqlalchemy.engine.Engine [cached since 9.08s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:33,869 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:33,869 INFO sqlalchemy.engine.Engine [cached since 8.962s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,630 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:35,630 INFO sqlalchemy.engine.Engine [cached since 8.789s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,847 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:35,847 INFO sqlalchemy.engine.Engine [cached since 8.828s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,867 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:35,867 INFO sqlalchemy.engine.Engine [cached since 8.828s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,908 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:35,908 INFO sqlalchemy.engine.Engine [cached since 8.806s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,910 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:35,910 INFO sqlalchemy.engine.Engine [cached since 8.793s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,911 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:35,912 INFO sqlalchemy.engine.Engine [cached since 8.792s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,912 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:35,912 INFO sqlalchemy.engine.Engine [cached since 8.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,913 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:35,913 INFO sqlalchemy.engine.Engine [cached since 8.789s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,913 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:35,913 INFO sqlalchemy.engine.Engine [cached since 8.787s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,914 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:35,914 INFO sqlalchemy.engine.Engine [cached since 8.786s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,915 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:35,916 INFO sqlalchemy.engine.Engine [cached since 8.786s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,917 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:35,917 INFO sqlalchemy.engine.Engine [cached since 8.785s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,919 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:35,919 INFO sqlalchemy.engine.Engine [cached since 8.785s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,920 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:35,920 INFO sqlalchemy.engine.Engine [cached since 8.785s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,921 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:35,922 INFO sqlalchemy.engine.Engine [cached since 8.784s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,923 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:35,923 INFO sqlalchemy.engine.Engine [cached since 8.785s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,925 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:35,925 INFO sqlalchemy.engine.Engine [cached since 8.785s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,926 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:35,926 INFO sqlalchemy.engine.Engine [cached since 8.785s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,927 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:35,927 INFO sqlalchemy.engine.Engine [cached since 8.785s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,928 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:35,928 INFO sqlalchemy.engine.Engine [cached since 8.785s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,929 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:35,929 INFO sqlalchemy.engine.Engine [cached since 8.785s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,930 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:35,930 INFO sqlalchemy.engine.Engine [cached since 8.785s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,930 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:35,931 INFO sqlalchemy.engine.Engine [cached since 8.784s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,932 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:35,932 INFO sqlalchemy.engine.Engine [cached since 8.783s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,933 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:35,933 INFO sqlalchemy.engine.Engine [cached since 8.782s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,934 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:35,935 INFO sqlalchemy.engine.Engine [cached since 8.781s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,936 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:35,936 INFO sqlalchemy.engine.Engine [cached since 8.781s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,938 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:35,938 INFO sqlalchemy.engine.Engine [cached since 8.782s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,940 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:35,940 INFO sqlalchemy.engine.Engine [cached since 8.781s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,941 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:35,941 INFO sqlalchemy.engine.Engine [cached since 8.78s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,942 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:35,942 INFO sqlalchemy.engine.Engine [cached since 8.78s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,943 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:35,944 INFO sqlalchemy.engine.Engine [cached since 8.78s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 20:01:35,945 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:35,945 INFO sqlalchemy.engine.Engine [cached since 8.776s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
Block 3 analysis completed successfully
Analyzing block 4/5: Dunetar
2026-01-30 20:01:35,946 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 20:01:35,946 INFO sqlalchemy.engine.Engine [cached since 18.39s ago] {'geojson': '{"type": "Polygon", "coordinates": [[[85.04435770300006, 27.443011379000016], [85.04532252600004, 27.442850742000047], [85.04622706, 27.4427971390000 ... (1378 characters truncated) ... 03, 27.442679439000084], [85.04185512700012, 27.443161052000054], [85.04336274600007, 27.443359324000028], [85.04435770300006, 27.443011379000016]]]}'}
Error converting GeoJSON to WKT: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL:
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt
        ]
[parameters: {'geojson': '{"type": "Polygon", "coordinates": [[[85.04435770300006, 27.443011379000016], [85.04532252600004, 27.442850742000047], [85.04622706, 27.4427971390000 ... (1378 characters truncated) ... 03, 27.442679439000084], [85.04185512700012, 27.443161052000054], [85.04336274600007, 27.443359324000028], [85.04435770300006, 27.443011379000016]]]}'}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
GeoJSON string (first 500 chars): {"type": "Polygon", "coordinates": [[[85.04435770300006, 27.443011379000016], [85.04532252600004, 27.442850742000047], [85.04622706, 27.442797139000053], [85.04709833429281, 27.442935834004423], [85.0470805420001, 27.44276298299998], [85.0473854140001, 27.441747757], [85.048414726, 27.440969345000077], [85.04952027800009, 27.44022477000002], [85.04948197200011, 27.43920961800005], [85.04993943800004, 27.43893886100003], [85.05024430400005, 27.438160551000024], [85.05108293700006, 27.437449859000
Error analyzing block 4: Invalid geometry format: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL:
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt
        ]
[parameters: {'geojson': '{"type": "Polygon", "coordinates": [[[85.04435770300006, 27.443011379000016], [85.04532252600004, 27.442850742000047], [85.04622706, 27.4427971390000 ... (1378 characters truncated) ... 03, 27.442679439000084], [85.04185512700012, 27.443161052000054], [85.04336274600007, 27.443359324000028], [85.04435770300006, 27.443011379000016]]]}'}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2026-01-30 20:01:35,947 INFO sqlalchemy.engine.Engine ROLLBACK
Analyzing block 5/5: Rame kholsa
2026-01-30 20:01:35,948 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:01:35,948 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 20:01:35,948 INFO sqlalchemy.engine.Engine [cached since 18.39s ago] {'geojson': '{"type": "Polygon", "coordinates": [[[85.0431547570001, 27.45588747100002], [85.04395542600008, 27.454973790000093], [85.04467979100006, 27.453857100 ... (1272 characters truncated) ... 000006, 27.45254918800003], [85.04104511200006, 27.45420717300008], [85.04199853799999, 27.455932865000044], [85.0431547570001, 27.45588747100002]]]}'}
2026-01-30 20:01:35,951 INFO sqlalchemy.engine.Engine
        SELECT
            ST_YMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as north,
            ST_YMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as south,
            ST_XMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as east,
            ST_XMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as west

2026-01-30 20:01:35,951 INFO sqlalchemy.engine.Engine [cached since 18.39s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:35,952 INFO sqlalchemy.engine.Engine
            WITH clipped_raster AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.dem
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ),
            pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as elevation
                FROM clipped_raster
            )
            SELECT
                MIN(elevation) as elevation_min,
                MAX(elevation) as elevation_max,
                AVG(elevation) as elevation_mean
            FROM pixel_values
            WHERE elevation > -32000  -- Exclude NoData values (-32768)
              AND elevation >= 0       -- Nepal minimum elevation
              AND elevation <= 9000    -- Nepal maximum elevation

2026-01-30 20:01:35,953 INFO sqlalchemy.engine.Engine [cached since 18.37s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:35,958 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as slope_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.slope
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value > 0
              AND (pvc).value <= 4
            GROUP BY slope_code

2026-01-30 20:01:35,958 INFO sqlalchemy.engine.Engine [cached since 18.22s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:35,961 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as aspect_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.aspect
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 0 AND 8
            GROUP BY aspect_code

2026-01-30 20:01:35,961 INFO sqlalchemy.engine.Engine [cached since 18.21s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:35,967 INFO sqlalchemy.engine.Engine
            WITH boundary AS (
                SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
            ),
            all_pixels AS (
                SELECT
                    (pix).val as height,
                    (pix).geom as pixel_center
                FROM (
                    SELECT ST_PixelAsPolygons(rast) as pix
                    FROM rasters.canopy_height, boundary
                    WHERE ST_Intersects(rast, geom)
                ) as subq
            )
            SELECT
                CASE
                    WHEN height = 0 THEN 'non_forest'
                    WHEN height > 0 AND height <= 5 THEN 'bush_regenerated'
                    WHEN height > 5 AND height <= 15 THEN 'pole_trees'
                    WHEN height > 15 THEN 'high_forest'
                END as canopy_class,
                COUNT(*) as pixel_count,
                AVG(height) as avg_height
            FROM all_pixels, boundary
            WHERE ST_Contains(boundary.geom, ST_Centroid(pixel_center))
              AND height IS NOT NULL
              AND height >= 0
              AND height <= 50
            GROUP BY canopy_class

2026-01-30 20:01:35,967 INFO sqlalchemy.engine.Engine [cached since 18.2s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,073 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as agb_mean,
                (stats).sum as agb_total
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, 1, ST_GeomFromText(%(wkt)s, 4326)),
                    1,  -- band 1
                    true  -- exclude nodata
                ) as stats
                FROM rasters.agb_2022_nepal
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ) as subquery

2026-01-30 20:01:36,073 INFO sqlalchemy.engine.Engine [cached since 18.17s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,075 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as health_class,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_forest_health
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 5
            GROUP BY health_class

2026-01-30 20:01:36,075 INFO sqlalchemy.engine.Engine [cached since 18.16s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,079 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as forest_type_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_type WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 26
            GROUP BY forest_type_code ORDER BY pixel_count DESC

2026-01-30 20:01:36,079 INFO sqlalchemy.engine.Engine [cached since 18.14s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,084 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as landcover_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.esa_world_cover WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
            GROUP BY landcover_code ORDER BY pixel_count DESC

2026-01-30 20:01:36,084 INFO sqlalchemy.engine.Engine [cached since 18.13s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,091 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as loss_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_lossyear WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY loss_year ORDER BY loss_year

2026-01-30 20:01:36,091 INFO sqlalchemy.engine.Engine [cached since 18.12s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,094 INFO sqlalchemy.engine.Engine
            SELECT SUM((pvc).count) as gain_pixels
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_gain WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value = 1

2026-01-30 20:01:36,094 INFO sqlalchemy.engine.Engine [cached since 18.1s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,096 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as fire_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_loss_fire WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY fire_year ORDER BY fire_year

2026-01-30 20:01:36,096 INFO sqlalchemy.engine.Engine [cached since 18.1s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,100 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_mean_temperature WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_mean FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 20:01:36,101 INFO sqlalchemy.engine.Engine [cached since 18.09s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,103 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.min_temp_coldest_month WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_min FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 20:01:36,103 INFO sqlalchemy.engine.Engine [cached since 18.08s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,105 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_precipitation WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as precip FROM clipped
            )
            SELECT AVG(precip) as precip_mean FROM pixel_values WHERE precip IS NOT NULL AND precip >= 0

2026-01-30 20:01:36,106 INFO sqlalchemy.engine.Engine [cached since 18.07s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,108 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as texture_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.soilgrids_isric WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 12
            GROUP BY texture_code ORDER BY pixel_count DESC LIMIT 1

2026-01-30 20:01:36,108 INFO sqlalchemy.engine.Engine [cached since 18.06s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,112 INFO sqlalchemy.engine.Engine
        SELECT p.province
        FROM admin.province p
        WHERE ST_Intersects(
            p.shape,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:01:36,112 INFO sqlalchemy.engine.Engine [cached since 18.05s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,115 INFO sqlalchemy.engine.Engine
        SELECT m.district, m.gapa_napa as municipality
        FROM admin.municipality m
        WHERE ST_Intersects(
            m.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:01:36,116 INFO sqlalchemy.engine.Engine [cached since 18.03s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,118 INFO sqlalchemy.engine.Engine
        SELECT w.ward
        FROM admin.ward w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:01:36,118 INFO sqlalchemy.engine.Engine [cached since 18.03s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,120 INFO sqlalchemy.engine.Engine
        SELECT w."watershed name" as watershed_name, w."major river basin" as major_river_basin
        FROM admin."watershed_Nepal" w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 20:01:36,121 INFO sqlalchemy.engine.Engine [cached since 18.02s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,122 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
        ),
        total_area AS (
            SELECT ST_Area(ST_Transform(geom, 32645)) as area
            FROM input_geom
        ),
        geology_intersections AS (
            SELECT
                g."geology class" as geology_class,
                ST_Area(
                    ST_Transform(
                        ST_Intersection(g.geom, i.geom),
                        32645
                    )
                ) as intersection_area
            FROM geology.geology g, input_geom i
            WHERE ST_Intersects(g.geom, i.geom)
            AND g."geology class" IS NOT NULL
            AND g."geology class" != 'No Data'
        )
        SELECT
            geology_class,
            (intersection_area / (SELECT area FROM total_area)) * 100 as percentage
        FROM geology_intersections
        WHERE intersection_area > 0
        ORDER BY percentage DESC

2026-01-30 20:01:36,123 INFO sqlalchemy.engine.Engine [cached since 18.01s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,132 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT
                ST_GeomFromText(%(wkt)s, 4326) as geom,
                ST_Centroid(ST_GeomFromText(%(wkt)s, 4326)) as centroid
        ),
        nearest_hq AS (
            SELECT
                dh."head quarter" as name,
                ST_Distance(
                    ST_Transform(i.centroid, 32645),
                    ST_Transform(dh.geom, 32645)
                ) / 1000.0 as distance_km,
                degrees(
                    ST_Azimuth(
                        i.centroid,
                        dh.geom
                    )
                ) as azimuth_degrees
            FROM admin."district Headquarter" dh, input_geom i
            WHERE dh."head quarter" IS NOT NULL
            ORDER BY ST_Distance(i.centroid, dh.geom)
            LIMIT 1
        )
        SELECT
            name,
            distance_km,
            azimuth_degrees,
            CASE
                WHEN azimuth_degrees >= 337.5 OR azimuth_degrees < 22.5 THEN 'North'
                WHEN azimuth_degrees >= 22.5 AND azimuth_degrees < 67.5 THEN 'Northeast'
                WHEN azimuth_degrees >= 67.5 AND azimuth_degrees < 112.5 THEN 'East'
                WHEN azimuth_degrees >= 112.5 AND azimuth_degrees < 157.5 THEN 'Southeast'
                WHEN azimuth_degrees >= 157.5 AND azimuth_degrees < 202.5 THEN 'South'
                WHEN azimuth_degrees >= 202.5 AND azimuth_degrees < 247.5 THEN 'Southwest'
                WHEN azimuth_degrees >= 247.5 AND azimuth_degrees < 292.5 THEN 'West'
                ELSE 'Northwest'
            END as direction
        FROM nearest_hq

2026-01-30 20:01:36,133 INFO sqlalchemy.engine.Engine [cached since 17.96s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:36,136 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:36,136 INFO sqlalchemy.engine.Engine [cached since 17.95s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:38,667 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:38,667 INFO sqlalchemy.engine.Engine [cached since 17.76s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:42,708 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:42,709 INFO sqlalchemy.engine.Engine [cached since 17.8s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,749 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:44,750 INFO sqlalchemy.engine.Engine [cached since 17.91s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,908 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:44,908 INFO sqlalchemy.engine.Engine [cached since 17.89s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,922 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:44,922 INFO sqlalchemy.engine.Engine [cached since 17.88s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,961 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:44,962 INFO sqlalchemy.engine.Engine [cached since 17.86s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,963 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:44,963 INFO sqlalchemy.engine.Engine [cached since 17.85s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,965 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 20:01:44,966 INFO sqlalchemy.engine.Engine [cached since 17.85s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,967 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:44,967 INFO sqlalchemy.engine.Engine [cached since 17.85s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,968 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:44,969 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,970 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:44,970 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,971 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:44,971 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,972 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:44,972 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,973 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:44,973 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,974 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:44,975 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,976 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:44,976 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,977 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 20:01:44,977 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,978 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:44,979 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,980 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:44,980 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,981 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:44,981 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,983 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:44,983 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,985 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:44,985 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,986 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:44,986 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,987 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:44,987 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,988 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:44,988 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,989 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 20:01:44,989 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,990 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:44,991 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,992 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:44,992 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,993 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:44,994 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,994 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:44,994 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,995 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:44,995 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,996 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:44,996 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:44,998 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:44,999 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:45,002 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:45,002 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 20:01:45,004 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 20:01:45,005 INFO sqlalchemy.engine.Engine [cached since 17.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
Block 5 analysis completed successfully
2026-01-30 20:01:45,006 INFO sqlalchemy.engine.Engine
        SELECT
            ST_X(ST_Centroid(boundary_geom)) as lon,
            ST_Y(ST_Centroid(boundary_geom)) as lat
        FROM public.calculations
        WHERE id = %(calc_id)s

2026-01-30 20:01:45,007 INFO sqlalchemy.engine.Engine [generated in 0.00061s] {'calc_id': 'a5ce545f-30a1-4185-b1e0-515f58741d68'}
2026-01-30 20:01:45,009 INFO sqlalchemy.engine.Engine ROLLBACK
Analysis failed: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL:
        SELECT
            ST_X(ST_Centroid(boundary_geom)) as lon,
            ST_Y(ST_Centroid(boundary_geom)) as lat
        FROM public.calculations
        WHERE id = %(calc_id)s
    ]
[parameters: {'calc_id': 'a5ce545f-30a1-4185-b1e0-515f58741d68'}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2026-01-30 20:01:45,011 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 20:01:45,016 INFO sqlalchemy.engine.Engine SELECT public.calculations.id AS public_calculations_id, public.calculations.user_id AS public_calculations_user_id, public.calculations.application_id AS public_calculations_application_id, public.calculations.uploaded_filename AS public_calculations_uploaded_filename, ST_AsEWKB(public.calculations.boundary_geom) AS public_calculations_boundary_geom, public.calculations.forest_name AS public_calculations_forest_name, public.calculations.block_name AS public_calculations_block_name, public.calculations.result_data AS public_calculations_result_data, public.calculations.processing_time_seconds AS public_calculations_processing_time_seconds, public.calculations.created_at AS public_calculations_created_at, public.calculations.completed_at AS public_calculations_completed_at
FROM public.calculations
WHERE public.calculations.id = %(pk_1)s::UUID
2026-01-30 20:01:45,017 INFO sqlalchemy.engine.Engine [generated in 0.00077s] {'pk_1': UUID('a5ce545f-30a1-4185-b1e0-515f58741d68')}
2026-01-30 20:01:45,022 INFO sqlalchemy.engine.Engine UPDATE public.calculations SET status=%(status)s, error_message=%(error_message)s WHERE public.calculations.id = %(public_calculations_id)s::UUID
2026-01-30 20:01:45,022 INFO sqlalchemy.engine.Engine [generated in 0.00052s] {'status': 'FAILED', 'error_message': "(psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block\n\n[SQL: \n        SELECT\n  ... (157 characters truncated) ... = %(calc_id)s\n    ]\n[parameters: {'calc_id': 'a5ce545f-30a1-4185-b1e0-515f58741d68'}]\n(Background on this error at: https://sqlalche.me/e/20/2j85)", 'public_calculations_id': UUID('a5ce545f-30a1-4185-b1e0-515f58741d68')}
2026-01-30 20:01:45,025 INFO sqlalchemy.engine.Engine COMMIT
INFO:     127.0.0.1:52212 - "POST /api/forests/upload HTTP/1.1" 500 Internal Server Error
