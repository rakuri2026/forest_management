========================================
Community Forest Management System
========================================

Activating virtual environment...

========================================
Starting FastAPI server on port 8001...
API Documentation: http://localhost:8001/docs
Health Check: http://localhost:8001/health
========================================

INFO:     Will watch for changes in these directories: ['D:\\forest_management\\backend']
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
INFO:     Started reloader process [14772] using WatchFiles
INFO:     Started server process [17884]
INFO:     Waiting for application startup.
Starting Community Forest Management System v1.0.0
Debug mode: True
2026-01-30 19:45:38,004 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2026-01-30 19:45:38,005 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-30 19:45:38,008 INFO sqlalchemy.engine.Engine select current_schema()
2026-01-30 19:45:38,009 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-30 19:45:38,010 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2026-01-30 19:45:38,011 INFO sqlalchemy.engine.Engine [raw sql] {}
2026-01-30 19:45:38,017 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 19:45:38,018 INFO sqlalchemy.engine.Engine SELECT 1
2026-01-30 19:45:38,018 INFO sqlalchemy.engine.Engine [generated in 0.00115s] {}
2026-01-30 19:45:38,021 INFO sqlalchemy.engine.Engine ROLLBACK
Database connection successful
INFO:     Application startup complete.
2026-01-30 19:45:44,414 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 19:45:44,426 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 19:45:44,428 INFO sqlalchemy.engine.Engine [generated in 0.00122s] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
2026-01-30 19:45:44,724 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 19:45:44,725 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 19:45:44,726 INFO sqlalchemy.engine.Engine [cached since 0.3007s ago] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
INFO:     127.0.0.1:53967 - "GET /api/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:52487 - "GET /api/auth/me HTTP/1.1" 200 OK
2026-01-30 19:45:44,743 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-30 19:45:44,744 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-30 19:46:01,117 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 19:46:01,118 INFO sqlalchemy.engine.Engine SELECT public.users.id AS public_users_id, public.users.email AS public_users_email, public.users.hashed_password AS public_users_hashed_password, public.users.full_name AS public_users_full_name, public.users.phone AS public_users_phone, public.users.role AS public_users_role, public.users.status AS public_users_status, public.users.organization_id AS public_users_organization_id, public.users.created_at AS public_users_created_at, public.users.last_login AS public_users_last_login
FROM public.users
WHERE public.users.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 19:46:01,119 INFO sqlalchemy.engine.Engine [cached since 16.69s ago] {'id_1': '4852473e-6cb9-4422-91b9-aa8d59d39e83', 'param_1': 1}
2026-01-30 19:46:01,345 INFO sqlalchemy.engine.Engine INSERT INTO public.calculations (id, user_id, application_id, uploaded_filename, boundary_geom, forest_name, block_name, result_data, status, processing_time_seconds, error_message, created_at, completed_at) VALUES (%(id)s::UUID, %(user_id)s::UUID, %(application_id)s::UUID, %(uploaded_filename)s, ST_GeomFromText(%(ST_GeomFromText_1)s, %(ST_GeomFromText_2)s), %(forest_name)s, %(block_name)s, %(result_data)s::JSONB, %(status)s, %(processing_time_seconds)s, %(error_message)s, %(created_at)s, %(completed_at)s)
2026-01-30 19:46:01,346 INFO sqlalchemy.engine.Engine [generated in 0.00273s] {'id': UUID('f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'), 'user_id': UUID('4852473e-6cb9-4422-91b9-aa8d59d39e83'), 'application_id': None, 'uploaded_filename': 'sundar.zip', 'ST_GeomFromText_1': 'MULTIPOLYGON (((85.06166514100008 27.41872503600006, 85.06203161900002 27.418646880000075, 85.06232481400012 27.41863380400006, 85.062764611 27.41862 ... (8402 characters truncated) ... 85.04009173000006 27.45254918800003, 85.04104511200006 27.45420717300008, 85.04199853799999 27.455932865000044, 85.0431547570001 27.45588747100002)))', 'ST_GeomFromText_2': 4326, 'forest_name': 'ppppp', 'block_name': 'yyyyyyy', 'result_data': '{"total_blocks": 5, "blocks": [{"block_index": 0, "block_name": "Panchpokhari pakho", "area_sqm": 1341233.9729370929, "area_hectares": 134.1233972937 ... (10347 characters truncated) ... 588747100002]]]}, "centroid": {"lon": 85.0419834247576, "lat": 27.44726912429787}}], "processing_info": {"partitioned": false, "partition_info": {}}}', 'status': 'PROCESSING', 'processing_time_seconds': None, 'error_message': None, 'created_at': datetime.datetime(2026, 1, 30, 14, 1, 1, 344406), 'completed_at': None}
2026-01-30 19:46:01,460 INFO sqlalchemy.engine.Engine COMMIT
2026-01-30 19:46:01,466 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 19:46:01,472 INFO sqlalchemy.engine.Engine SELECT public.calculations.id, public.calculations.user_id, public.calculations.application_id, public.calculations.uploaded_filename, ST_AsEWKB(public.calculations.boundary_geom) AS boundary_geom, public.calculations.forest_name, public.calculations.block_name, public.calculations.result_data, public.calculations.status, public.calculations.processing_time_seconds, public.calculations.error_message, public.calculations.created_at, public.calculations.completed_at
FROM public.calculations
WHERE public.calculations.id = %(pk_1)s::UUID
2026-01-30 19:46:01,473 INFO sqlalchemy.engine.Engine [generated in 0.00101s] {'pk_1': UUID('f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e')}
Starting analysis for calculation f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e
2026-01-30 19:46:01,510 INFO sqlalchemy.engine.Engine ROLLBACK
2026-01-30 19:46:01,514 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 19:46:01,518 INFO sqlalchemy.engine.Engine SELECT public.calculations.id AS public_calculations_id, public.calculations.user_id AS public_calculations_user_id, public.calculations.application_id AS public_calculations_application_id, public.calculations.uploaded_filename AS public_calculations_uploaded_filename, ST_AsEWKB(public.calculations.boundary_geom) AS public_calculations_boundary_geom, public.calculations.forest_name AS public_calculations_forest_name, public.calculations.block_name AS public_calculations_block_name, public.calculations.result_data AS public_calculations_result_data, public.calculations.status AS public_calculations_status, public.calculations.processing_time_seconds AS public_calculations_processing_time_seconds, public.calculations.error_message AS public_calculations_error_message, public.calculations.created_at AS public_calculations_created_at, public.calculations.completed_at AS public_calculations_completed_at
FROM public.calculations
WHERE public.calculations.id = %(id_1)s::UUID
 LIMIT %(param_1)s
2026-01-30 19:46:01,518 INFO sqlalchemy.engine.Engine [generated in 0.00079s] {'id_1': UUID('f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'), 'param_1': 1}
Analyzing block 1/5: Panchpokhari pakho
2026-01-30 19:46:01,527 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 19:46:01,528 INFO sqlalchemy.engine.Engine [generated in 0.00077s] {'geojson': '{"type": "Polygon", "coordinates": [[[85.06166514100008, 27.41872503600006], [85.06203161900002, 27.418646880000075], [85.06232481400012, 27.41863380 ... (2153 characters truncated) ... 0005, 27.418321877000007], [85.06082951000012, 27.41866014500002], [85.06119604100007, 27.418790200000032], [85.06166514100008, 27.41872503600006]]]}'}
2026-01-30 19:46:01,538 INFO sqlalchemy.engine.Engine
        SELECT
            ST_YMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as north,
            ST_YMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as south,
            ST_XMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as east,
            ST_XMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as west

2026-01-30 19:46:01,539 INFO sqlalchemy.engine.Engine [generated in 0.00085s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:01,554 INFO sqlalchemy.engine.Engine
            WITH clipped_raster AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.dem
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ),
            pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as elevation
                FROM clipped_raster
            )
            SELECT
                MIN(elevation) as elevation_min,
                MAX(elevation) as elevation_max,
                AVG(elevation) as elevation_mean
            FROM pixel_values
            WHERE elevation > -32000  -- Exclude NoData values (-32768)
              AND elevation >= 0       -- Nepal minimum elevation
              AND elevation <= 9000    -- Nepal maximum elevation

2026-01-30 19:46:01,555 INFO sqlalchemy.engine.Engine [generated in 0.00080s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:01,770 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as slope_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.slope
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value > 0
              AND (pvc).value <= 4
            GROUP BY slope_code

2026-01-30 19:46:01,770 INFO sqlalchemy.engine.Engine [generated in 0.00055s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:01,794 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as aspect_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.aspect
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 0 AND 8
            GROUP BY aspect_code

2026-01-30 19:46:01,795 INFO sqlalchemy.engine.Engine [generated in 0.00073s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:01,813 INFO sqlalchemy.engine.Engine
            WITH boundary AS (
                SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
            ),
            all_pixels AS (
                SELECT
                    (pix).val as height,
                    (pix).geom as pixel_center
                FROM (
                    SELECT ST_PixelAsPolygons(rast) as pix
                    FROM rasters.canopy_height, boundary
                    WHERE ST_Intersects(rast, geom)
                ) as subq
            )
            SELECT
                CASE
                    WHEN height = 0 THEN 'non_forest'
                    WHEN height > 0 AND height <= 5 THEN 'bush_regenerated'
                    WHEN height > 5 AND height <= 15 THEN 'pole_trees'
                    WHEN height > 15 THEN 'high_forest'
                END as canopy_class,
                COUNT(*) as pixel_count,
                AVG(height) as avg_height
            FROM all_pixels, boundary
            WHERE ST_Contains(boundary.geom, ST_Centroid(pixel_center))
              AND height IS NOT NULL
              AND height >= 0
              AND height <= 50
            GROUP BY canopy_class

2026-01-30 19:46:01,813 INFO sqlalchemy.engine.Engine [generated in 0.00091s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,046 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as agb_mean,
                (stats).sum as agb_total
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, 1, ST_GeomFromText(%(wkt)s, 4326)),
                    1,  -- band 1
                    true  -- exclude nodata
                ) as stats
                FROM rasters.agb_2022_nepal
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ) as subquery

2026-01-30 19:46:02,046 INFO sqlalchemy.engine.Engine [generated in 0.00089s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,078 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as health_class,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_forest_health
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 5
            GROUP BY health_class

2026-01-30 19:46:02,079 INFO sqlalchemy.engine.Engine [generated in 0.00064s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,113 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as forest_type_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_type WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 26
            GROUP BY forest_type_code ORDER BY pixel_count DESC

2026-01-30 19:46:02,113 INFO sqlalchemy.engine.Engine [generated in 0.00053s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,142 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as landcover_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.esa_world_cover WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
            GROUP BY landcover_code ORDER BY pixel_count DESC

2026-01-30 19:46:02,142 INFO sqlalchemy.engine.Engine [generated in 0.00058s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,169 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as loss_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_lossyear WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY loss_year ORDER BY loss_year

2026-01-30 19:46:02,169 INFO sqlalchemy.engine.Engine [generated in 0.00071s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,188 INFO sqlalchemy.engine.Engine
            SELECT SUM((pvc).count) as gain_pixels
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_gain WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value = 1

2026-01-30 19:46:02,188 INFO sqlalchemy.engine.Engine [generated in 0.00070s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,205 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as fire_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_loss_fire WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY fire_year ORDER BY fire_year

2026-01-30 19:46:02,206 INFO sqlalchemy.engine.Engine [generated in 0.00069s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,218 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_mean_temperature WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_mean FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 19:46:02,219 INFO sqlalchemy.engine.Engine [generated in 0.00093s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,233 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.min_temp_coldest_month WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_min FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 19:46:02,234 INFO sqlalchemy.engine.Engine [generated in 0.00053s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,251 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_precipitation WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as precip FROM clipped
            )
            SELECT AVG(precip) as precip_mean FROM pixel_values WHERE precip IS NOT NULL AND precip >= 0

2026-01-30 19:46:02,252 INFO sqlalchemy.engine.Engine [generated in 0.00083s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,273 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as texture_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.soilgrids_isric WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 12
            GROUP BY texture_code ORDER BY pixel_count DESC LIMIT 1

2026-01-30 19:46:02,274 INFO sqlalchemy.engine.Engine [generated in 0.00109s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,298 INFO sqlalchemy.engine.Engine
        SELECT p.province
        FROM admin.province p
        WHERE ST_Intersects(
            p.shape,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:02,299 INFO sqlalchemy.engine.Engine [generated in 0.00078s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,318 INFO sqlalchemy.engine.Engine
        SELECT m.district, m.gapa_napa as municipality
        FROM admin.municipality m
        WHERE ST_Intersects(
            m.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:02,318 INFO sqlalchemy.engine.Engine [generated in 0.00090s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,340 INFO sqlalchemy.engine.Engine
        SELECT w.ward
        FROM admin.ward w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:02,341 INFO sqlalchemy.engine.Engine [generated in 0.00087s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,360 INFO sqlalchemy.engine.Engine
        SELECT w."watershed name" as watershed_name, w."major river basin" as major_river_basin
        FROM admin."watershed_Nepal" w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:02,362 INFO sqlalchemy.engine.Engine [generated in 0.00146s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,380 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
        ),
        total_area AS (
            SELECT ST_Area(ST_Transform(geom, 32645)) as area
            FROM input_geom
        ),
        geology_intersections AS (
            SELECT
                g."geology class" as geology_class,
                ST_Area(
                    ST_Transform(
                        ST_Intersection(g.geom, i.geom),
                        32645
                    )
                ) as intersection_area
            FROM geology.geology g, input_geom i
            WHERE ST_Intersects(g.geom, i.geom)
            AND g."geology class" IS NOT NULL
            AND g."geology class" != 'No Data'
        )
        SELECT
            geology_class,
            (intersection_area / (SELECT area FROM total_area)) * 100 as percentage
        FROM geology_intersections
        WHERE intersection_area > 0
        ORDER BY percentage DESC

2026-01-30 19:46:02,381 INFO sqlalchemy.engine.Engine [generated in 0.00068s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,454 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT
                ST_GeomFromText(%(wkt)s, 4326) as geom,
                ST_Centroid(ST_GeomFromText(%(wkt)s, 4326)) as centroid
        ),
        nearest_hq AS (
            SELECT
                dh."head quarter" as name,
                ST_Distance(
                    ST_Transform(i.centroid, 32645),
                    ST_Transform(dh.geom, 32645)
                ) / 1000.0 as distance_km,
                degrees(
                    ST_Azimuth(
                        i.centroid,
                        dh.geom
                    )
                ) as azimuth_degrees
            FROM admin."district Headquarter" dh, input_geom i
            WHERE dh."head quarter" IS NOT NULL
            ORDER BY ST_Distance(i.centroid, dh.geom)
            LIMIT 1
        )
        SELECT
            name,
            distance_km,
            azimuth_degrees,
            CASE
                WHEN azimuth_degrees >= 337.5 OR azimuth_degrees < 22.5 THEN 'North'
                WHEN azimuth_degrees >= 22.5 AND azimuth_degrees < 67.5 THEN 'Northeast'
                WHEN azimuth_degrees >= 67.5 AND azimuth_degrees < 112.5 THEN 'East'
                WHEN azimuth_degrees >= 112.5 AND azimuth_degrees < 157.5 THEN 'Southeast'
                WHEN azimuth_degrees >= 157.5 AND azimuth_degrees < 202.5 THEN 'South'
                WHEN azimuth_degrees >= 202.5 AND azimuth_degrees < 247.5 THEN 'Southwest'
                WHEN azimuth_degrees >= 247.5 AND azimuth_degrees < 292.5 THEN 'West'
                ELSE 'Northwest'
            END as direction
        FROM nearest_hq

2026-01-30 19:46:02,455 INFO sqlalchemy.engine.Engine [generated in 0.00118s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:02,474 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:02,475 INFO sqlalchemy.engine.Engine [generated in 0.00097s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:06,441 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:06,442 INFO sqlalchemy.engine.Engine [generated in 0.00156s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:15,909 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:15,910 INFO sqlalchemy.engine.Engine [generated in 0.00125s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:18,789 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:18,790 INFO sqlalchemy.engine.Engine [generated in 0.00063s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,122 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:19,123 INFO sqlalchemy.engine.Engine [generated in 0.00068s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,177 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:19,178 INFO sqlalchemy.engine.Engine [generated in 0.00075s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,315 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:19,315 INFO sqlalchemy.engine.Engine [generated in 0.00059s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,332 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:19,333 INFO sqlalchemy.engine.Engine [generated in 0.00055s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,334 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:19,335 INFO sqlalchemy.engine.Engine [generated in 0.00041s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,337 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:19,337 INFO sqlalchemy.engine.Engine [generated in 0.00060s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,339 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:19,339 INFO sqlalchemy.engine.Engine [generated in 0.00050s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,341 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:19,342 INFO sqlalchemy.engine.Engine [generated in 0.00057s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,345 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:19,345 INFO sqlalchemy.engine.Engine [generated in 0.00081s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,348 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:19,348 INFO sqlalchemy.engine.Engine [generated in 0.00080s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,350 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:19,351 INFO sqlalchemy.engine.Engine [generated in 0.00055s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,353 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:19,353 INFO sqlalchemy.engine.Engine [generated in 0.00070s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,355 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:19,356 INFO sqlalchemy.engine.Engine [generated in 0.00063s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,358 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:19,359 INFO sqlalchemy.engine.Engine [generated in 0.00137s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,361 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:19,362 INFO sqlalchemy.engine.Engine [generated in 0.00059s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,364 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:19,365 INFO sqlalchemy.engine.Engine [generated in 0.00074s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,367 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:19,368 INFO sqlalchemy.engine.Engine [generated in 0.00067s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,370 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:19,370 INFO sqlalchemy.engine.Engine [generated in 0.00058s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,372 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:19,373 INFO sqlalchemy.engine.Engine [generated in 0.00053s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,375 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:19,375 INFO sqlalchemy.engine.Engine [generated in 0.00050s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,377 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:19,378 INFO sqlalchemy.engine.Engine [generated in 0.00062s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,380 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:19,380 INFO sqlalchemy.engine.Engine [generated in 0.00061s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,382 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:19,383 INFO sqlalchemy.engine.Engine [generated in 0.00056s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,385 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:19,386 INFO sqlalchemy.engine.Engine [generated in 0.00073s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,387 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:19,388 INFO sqlalchemy.engine.Engine [generated in 0.00059s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,390 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:19,391 INFO sqlalchemy.engine.Engine [generated in 0.00069s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,393 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:19,393 INFO sqlalchemy.engine.Engine [generated in 0.00043s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,395 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:19,396 INFO sqlalchemy.engine.Engine [generated in 0.00070s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,397 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:19,398 INFO sqlalchemy.engine.Engine [generated in 0.00047s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,399 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:19,399 INFO sqlalchemy.engine.Engine [generated in 0.00038s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,400 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:19,403 INFO sqlalchemy.engine.Engine [generated in 0.00219s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,404 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:19,404 INFO sqlalchemy.engine.Engine [generated in 0.00037s] {'wkt': 'POLYGON((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.41862069600004, ... (1885 characters truncated) ... 3,85.06047758600005 27.418321877000007,85.06082951000012 27.41866014500002,85.06119604100007 27.418790200000032,85.06166514100008 27.41872503600006))'}
2026-01-30 19:46:19,405 INFO sqlalchemy.engine.Engine COMMIT
Block 1 analysis completed successfully
Analyzing block 2/5: Chaukune Bari
2026-01-30 19:46:19,409 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 19:46:19,409 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 19:46:19,410 INFO sqlalchemy.engine.Engine [cached since 17.88s ago] {'geojson': '{"type": "Polygon", "coordinates": [[[85.0574253390001, 27.427365587000086], [85.05864488600011, 27.425978034000032], [85.0597119070001, 27.424556682 ... (1876 characters truncated) ... 000001, 27.42689951299998], [85.0565676690001, 27.427288961000052], [85.05733172489794, 27.42768438178319], [85.0574253390001, 27.427365587000086]]]}'}
2026-01-30 19:46:19,416 INFO sqlalchemy.engine.Engine
        SELECT
            ST_YMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as north,
            ST_YMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as south,
            ST_XMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as east,
            ST_XMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as west

2026-01-30 19:46:19,416 INFO sqlalchemy.engine.Engine [cached since 17.88s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,428 INFO sqlalchemy.engine.Engine
            WITH clipped_raster AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.dem
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ),
            pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as elevation
                FROM clipped_raster
            )
            SELECT
                MIN(elevation) as elevation_min,
                MAX(elevation) as elevation_max,
                AVG(elevation) as elevation_mean
            FROM pixel_values
            WHERE elevation > -32000  -- Exclude NoData values (-32768)
              AND elevation >= 0       -- Nepal minimum elevation
              AND elevation <= 9000    -- Nepal maximum elevation

2026-01-30 19:46:19,429 INFO sqlalchemy.engine.Engine [cached since 17.88s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,543 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as slope_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.slope
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value > 0
              AND (pvc).value <= 4
            GROUP BY slope_code

2026-01-30 19:46:19,543 INFO sqlalchemy.engine.Engine [cached since 17.77s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,561 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as aspect_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.aspect
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 0 AND 8
            GROUP BY aspect_code

2026-01-30 19:46:19,561 INFO sqlalchemy.engine.Engine [cached since 17.77s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,575 INFO sqlalchemy.engine.Engine
            WITH boundary AS (
                SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
            ),
            all_pixels AS (
                SELECT
                    (pix).val as height,
                    (pix).geom as pixel_center
                FROM (
                    SELECT ST_PixelAsPolygons(rast) as pix
                    FROM rasters.canopy_height, boundary
                    WHERE ST_Intersects(rast, geom)
                ) as subq
            )
            SELECT
                CASE
                    WHEN height = 0 THEN 'non_forest'
                    WHEN height > 0 AND height <= 5 THEN 'bush_regenerated'
                    WHEN height > 5 AND height <= 15 THEN 'pole_trees'
                    WHEN height > 15 THEN 'high_forest'
                END as canopy_class,
                COUNT(*) as pixel_count,
                AVG(height) as avg_height
            FROM all_pixels, boundary
            WHERE ST_Contains(boundary.geom, ST_Centroid(pixel_center))
              AND height IS NOT NULL
              AND height >= 0
              AND height <= 50
            GROUP BY canopy_class

2026-01-30 19:46:19,575 INFO sqlalchemy.engine.Engine [cached since 17.76s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,694 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as agb_mean,
                (stats).sum as agb_total
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, 1, ST_GeomFromText(%(wkt)s, 4326)),
                    1,  -- band 1
                    true  -- exclude nodata
                ) as stats
                FROM rasters.agb_2022_nepal
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ) as subquery

2026-01-30 19:46:19,694 INFO sqlalchemy.engine.Engine [cached since 17.65s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,716 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as health_class,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_forest_health
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 5
            GROUP BY health_class

2026-01-30 19:46:19,717 INFO sqlalchemy.engine.Engine [cached since 17.64s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,738 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as forest_type_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_type WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 26
            GROUP BY forest_type_code ORDER BY pixel_count DESC

2026-01-30 19:46:19,739 INFO sqlalchemy.engine.Engine [cached since 17.63s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,754 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as landcover_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.esa_world_cover WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
            GROUP BY landcover_code ORDER BY pixel_count DESC

2026-01-30 19:46:19,754 INFO sqlalchemy.engine.Engine [cached since 17.61s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,783 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as loss_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_lossyear WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY loss_year ORDER BY loss_year

2026-01-30 19:46:19,783 INFO sqlalchemy.engine.Engine [cached since 17.61s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,796 INFO sqlalchemy.engine.Engine
            SELECT SUM((pvc).count) as gain_pixels
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_gain WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value = 1

2026-01-30 19:46:19,797 INFO sqlalchemy.engine.Engine [cached since 17.61s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,809 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as fire_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_loss_fire WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY fire_year ORDER BY fire_year

2026-01-30 19:46:19,809 INFO sqlalchemy.engine.Engine [cached since 17.6s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,820 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_mean_temperature WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_mean FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 19:46:19,821 INFO sqlalchemy.engine.Engine [cached since 17.6s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,835 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.min_temp_coldest_month WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_min FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 19:46:19,835 INFO sqlalchemy.engine.Engine [cached since 17.6s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,849 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_precipitation WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as precip FROM clipped
            )
            SELECT AVG(precip) as precip_mean FROM pixel_values WHERE precip IS NOT NULL AND precip >= 0

2026-01-30 19:46:19,850 INFO sqlalchemy.engine.Engine [cached since 17.6s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,866 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as texture_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.soilgrids_isric WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 12
            GROUP BY texture_code ORDER BY pixel_count DESC LIMIT 1

2026-01-30 19:46:19,867 INFO sqlalchemy.engine.Engine [cached since 17.59s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,880 INFO sqlalchemy.engine.Engine
        SELECT p.province
        FROM admin.province p
        WHERE ST_Intersects(
            p.shape,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:19,880 INFO sqlalchemy.engine.Engine [cached since 17.58s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,897 INFO sqlalchemy.engine.Engine
        SELECT m.district, m.gapa_napa as municipality
        FROM admin.municipality m
        WHERE ST_Intersects(
            m.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:19,898 INFO sqlalchemy.engine.Engine [cached since 17.58s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,911 INFO sqlalchemy.engine.Engine
        SELECT w.ward
        FROM admin.ward w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:19,912 INFO sqlalchemy.engine.Engine [cached since 17.57s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,920 INFO sqlalchemy.engine.Engine
        SELECT w."watershed name" as watershed_name, w."major river basin" as major_river_basin
        FROM admin."watershed_Nepal" w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:19,920 INFO sqlalchemy.engine.Engine [cached since 17.56s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:19,948 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
        ),
        total_area AS (
            SELECT ST_Area(ST_Transform(geom, 32645)) as area
            FROM input_geom
        ),
        geology_intersections AS (
            SELECT
                g."geology class" as geology_class,
                ST_Area(
                    ST_Transform(
                        ST_Intersection(g.geom, i.geom),
                        32645
                    )
                ) as intersection_area
            FROM geology.geology g, input_geom i
            WHERE ST_Intersects(g.geom, i.geom)
            AND g."geology class" IS NOT NULL
            AND g."geology class" != 'No Data'
        )
        SELECT
            geology_class,
            (intersection_area / (SELECT area FROM total_area)) * 100 as percentage
        FROM geology_intersections
        WHERE intersection_area > 0
        ORDER BY percentage DESC

2026-01-30 19:46:19,948 INFO sqlalchemy.engine.Engine [cached since 17.57s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:20,009 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT
                ST_GeomFromText(%(wkt)s, 4326) as geom,
                ST_Centroid(ST_GeomFromText(%(wkt)s, 4326)) as centroid
        ),
        nearest_hq AS (
            SELECT
                dh."head quarter" as name,
                ST_Distance(
                    ST_Transform(i.centroid, 32645),
                    ST_Transform(dh.geom, 32645)
                ) / 1000.0 as distance_km,
                degrees(
                    ST_Azimuth(
                        i.centroid,
                        dh.geom
                    )
                ) as azimuth_degrees
            FROM admin."district Headquarter" dh, input_geom i
            WHERE dh."head quarter" IS NOT NULL
            ORDER BY ST_Distance(i.centroid, dh.geom)
            LIMIT 1
        )
        SELECT
            name,
            distance_km,
            azimuth_degrees,
            CASE
                WHEN azimuth_degrees >= 337.5 OR azimuth_degrees < 22.5 THEN 'North'
                WHEN azimuth_degrees >= 22.5 AND azimuth_degrees < 67.5 THEN 'Northeast'
                WHEN azimuth_degrees >= 67.5 AND azimuth_degrees < 112.5 THEN 'East'
                WHEN azimuth_degrees >= 112.5 AND azimuth_degrees < 157.5 THEN 'Southeast'
                WHEN azimuth_degrees >= 157.5 AND azimuth_degrees < 202.5 THEN 'South'
                WHEN azimuth_degrees >= 202.5 AND azimuth_degrees < 247.5 THEN 'Southwest'
                WHEN azimuth_degrees >= 247.5 AND azimuth_degrees < 292.5 THEN 'West'
                ELSE 'Northwest'
            END as direction
        FROM nearest_hq

2026-01-30 19:46:20,009 INFO sqlalchemy.engine.Engine [cached since 17.56s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:20,022 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:20,022 INFO sqlalchemy.engine.Engine [cached since 17.55s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:24,289 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:24,290 INFO sqlalchemy.engine.Engine [cached since 17.85s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:33,089 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:33,089 INFO sqlalchemy.engine.Engine [cached since 17.18s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:35,707 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:35,707 INFO sqlalchemy.engine.Engine [cached since 16.92s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:35,973 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:35,973 INFO sqlalchemy.engine.Engine [cached since 16.85s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,027 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:36,028 INFO sqlalchemy.engine.Engine [cached since 16.85s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,143 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:36,143 INFO sqlalchemy.engine.Engine [cached since 16.83s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,146 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:36,146 INFO sqlalchemy.engine.Engine [cached since 16.81s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,148 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:36,149 INFO sqlalchemy.engine.Engine [cached since 16.81s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,150 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:36,150 INFO sqlalchemy.engine.Engine [cached since 16.81s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,151 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:36,151 INFO sqlalchemy.engine.Engine [cached since 16.81s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,152 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:36,153 INFO sqlalchemy.engine.Engine [cached since 16.81s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,154 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:36,154 INFO sqlalchemy.engine.Engine [cached since 16.81s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,155 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:36,156 INFO sqlalchemy.engine.Engine [cached since 16.81s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,157 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:36,157 INFO sqlalchemy.engine.Engine [cached since 16.81s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,159 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:36,160 INFO sqlalchemy.engine.Engine [cached since 16.81s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,162 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:36,163 INFO sqlalchemy.engine.Engine [cached since 16.81s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,164 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:36,165 INFO sqlalchemy.engine.Engine [cached since 16.81s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,166 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:36,166 INFO sqlalchemy.engine.Engine [cached since 16.8s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,167 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:36,167 INFO sqlalchemy.engine.Engine [cached since 16.8s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,168 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:36,168 INFO sqlalchemy.engine.Engine [cached since 16.8s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,170 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:36,170 INFO sqlalchemy.engine.Engine [cached since 16.8s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,171 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:36,172 INFO sqlalchemy.engine.Engine [cached since 16.8s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,172 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:36,173 INFO sqlalchemy.engine.Engine [cached since 16.8s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,174 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:36,175 INFO sqlalchemy.engine.Engine [cached since 16.8s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,177 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:36,177 INFO sqlalchemy.engine.Engine [cached since 16.8s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,179 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:36,179 INFO sqlalchemy.engine.Engine [cached since 16.8s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,180 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:36,181 INFO sqlalchemy.engine.Engine [cached since 16.8s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,182 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:36,182 INFO sqlalchemy.engine.Engine [cached since 16.79s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,183 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:36,184 INFO sqlalchemy.engine.Engine [cached since 16.79s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,185 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:36,185 INFO sqlalchemy.engine.Engine [cached since 16.79s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,186 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:36,186 INFO sqlalchemy.engine.Engine [cached since 16.79s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,187 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:36,187 INFO sqlalchemy.engine.Engine [cached since 16.79s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,188 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:36,188 INFO sqlalchemy.engine.Engine [cached since 16.79s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,189 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:36,190 INFO sqlalchemy.engine.Engine [cached since 16.79s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,192 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:36,193 INFO sqlalchemy.engine.Engine [cached since 16.79s ago] {'wkt': 'POLYGON((85.0574253390001 27.427365587000086,85.05864488600011 27.425978034000032,85.0597119070001 27.424556682000023,85.06005456700004 27.4229324590 ... (1636 characters truncated) ... 008,85.05589461000001 27.42689951299998,85.0565676690001 27.427288961000052,85.05733172489794 27.42768438178319,85.0574253390001 27.427365587000086))'}
2026-01-30 19:46:36,195 INFO sqlalchemy.engine.Engine COMMIT
Block 2 analysis completed successfully
Analyzing block 3/5: Tikaram pakho
2026-01-30 19:46:36,198 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 19:46:36,198 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 19:46:36,199 INFO sqlalchemy.engine.Engine [cached since 34.67s ago] {'geojson': '{"type": "Polygon", "coordinates": [[[85.05123494200002, 27.434844373], [85.05250854700007, 27.43281449000009], [85.05384280200006, 27.43220514200003 ... (1387 characters truncated) ... 4262600008, 27.435571854000063], [85.05020597900007, 27.43599990300004], [85.05073287130257, 27.43625625445806], [85.05123494200002, 27.434844373]]]}'}
2026-01-30 19:46:36,201 INFO sqlalchemy.engine.Engine
        SELECT
            ST_YMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as north,
            ST_YMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as south,
            ST_XMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as east,
            ST_XMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as west

2026-01-30 19:46:36,202 INFO sqlalchemy.engine.Engine [cached since 34.66s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,204 INFO sqlalchemy.engine.Engine
            WITH clipped_raster AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.dem
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ),
            pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as elevation
                FROM clipped_raster
            )
            SELECT
                MIN(elevation) as elevation_min,
                MAX(elevation) as elevation_max,
                AVG(elevation) as elevation_mean
            FROM pixel_values
            WHERE elevation > -32000  -- Exclude NoData values (-32768)
              AND elevation >= 0       -- Nepal minimum elevation
              AND elevation <= 9000    -- Nepal maximum elevation

2026-01-30 19:46:36,205 INFO sqlalchemy.engine.Engine [cached since 34.65s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,218 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as slope_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.slope
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value > 0
              AND (pvc).value <= 4
            GROUP BY slope_code

2026-01-30 19:46:36,218 INFO sqlalchemy.engine.Engine [cached since 34.45s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,239 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as aspect_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.aspect
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 0 AND 8
            GROUP BY aspect_code

2026-01-30 19:46:36,240 INFO sqlalchemy.engine.Engine [cached since 34.45s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,246 INFO sqlalchemy.engine.Engine
            WITH boundary AS (
                SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
            ),
            all_pixels AS (
                SELECT
                    (pix).val as height,
                    (pix).geom as pixel_center
                FROM (
                    SELECT ST_PixelAsPolygons(rast) as pix
                    FROM rasters.canopy_height, boundary
                    WHERE ST_Intersects(rast, geom)
                ) as subq
            )
            SELECT
                CASE
                    WHEN height = 0 THEN 'non_forest'
                    WHEN height > 0 AND height <= 5 THEN 'bush_regenerated'
                    WHEN height > 5 AND height <= 15 THEN 'pole_trees'
                    WHEN height > 15 THEN 'high_forest'
                END as canopy_class,
                COUNT(*) as pixel_count,
                AVG(height) as avg_height
            FROM all_pixels, boundary
            WHERE ST_Contains(boundary.geom, ST_Centroid(pixel_center))
              AND height IS NOT NULL
              AND height >= 0
              AND height <= 50
            GROUP BY canopy_class

2026-01-30 19:46:36,247 INFO sqlalchemy.engine.Engine [cached since 34.43s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,473 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as agb_mean,
                (stats).sum as agb_total
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, 1, ST_GeomFromText(%(wkt)s, 4326)),
                    1,  -- band 1
                    true  -- exclude nodata
                ) as stats
                FROM rasters.agb_2022_nepal
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ) as subquery

2026-01-30 19:46:36,474 INFO sqlalchemy.engine.Engine [cached since 34.43s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,479 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as health_class,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_forest_health
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 5
            GROUP BY health_class

2026-01-30 19:46:36,481 INFO sqlalchemy.engine.Engine [cached since 34.4s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,489 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as forest_type_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_type WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 26
            GROUP BY forest_type_code ORDER BY pixel_count DESC

2026-01-30 19:46:36,489 INFO sqlalchemy.engine.Engine [cached since 34.38s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,502 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as landcover_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.esa_world_cover WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
            GROUP BY landcover_code ORDER BY pixel_count DESC

2026-01-30 19:46:36,502 INFO sqlalchemy.engine.Engine [cached since 34.36s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,513 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as loss_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_lossyear WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY loss_year ORDER BY loss_year

2026-01-30 19:46:36,513 INFO sqlalchemy.engine.Engine [cached since 34.34s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,518 INFO sqlalchemy.engine.Engine
            SELECT SUM((pvc).count) as gain_pixels
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_gain WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value = 1

2026-01-30 19:46:36,519 INFO sqlalchemy.engine.Engine [cached since 34.33s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,525 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as fire_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_loss_fire WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY fire_year ORDER BY fire_year

2026-01-30 19:46:36,526 INFO sqlalchemy.engine.Engine [cached since 34.32s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,532 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_mean_temperature WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_mean FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 19:46:36,532 INFO sqlalchemy.engine.Engine [cached since 34.31s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,537 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.min_temp_coldest_month WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_min FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 19:46:36,538 INFO sqlalchemy.engine.Engine [cached since 34.3s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,542 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_precipitation WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as precip FROM clipped
            )
            SELECT AVG(precip) as precip_mean FROM pixel_values WHERE precip IS NOT NULL AND precip >= 0

2026-01-30 19:46:36,542 INFO sqlalchemy.engine.Engine [cached since 34.29s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,548 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as texture_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.soilgrids_isric WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 12
            GROUP BY texture_code ORDER BY pixel_count DESC LIMIT 1

2026-01-30 19:46:36,548 INFO sqlalchemy.engine.Engine [cached since 34.28s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,555 INFO sqlalchemy.engine.Engine
        SELECT p.province
        FROM admin.province p
        WHERE ST_Intersects(
            p.shape,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:36,556 INFO sqlalchemy.engine.Engine [cached since 34.26s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,563 INFO sqlalchemy.engine.Engine
        SELECT m.district, m.gapa_napa as municipality
        FROM admin.municipality m
        WHERE ST_Intersects(
            m.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:36,564 INFO sqlalchemy.engine.Engine [cached since 34.25s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,567 INFO sqlalchemy.engine.Engine
        SELECT w.ward
        FROM admin.ward w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:36,567 INFO sqlalchemy.engine.Engine [cached since 34.23s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,570 INFO sqlalchemy.engine.Engine
        SELECT w."watershed name" as watershed_name, w."major river basin" as major_river_basin
        FROM admin."watershed_Nepal" w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:36,571 INFO sqlalchemy.engine.Engine [cached since 34.21s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,575 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
        ),
        total_area AS (
            SELECT ST_Area(ST_Transform(geom, 32645)) as area
            FROM input_geom
        ),
        geology_intersections AS (
            SELECT
                g."geology class" as geology_class,
                ST_Area(
                    ST_Transform(
                        ST_Intersection(g.geom, i.geom),
                        32645
                    )
                ) as intersection_area
            FROM geology.geology g, input_geom i
            WHERE ST_Intersects(g.geom, i.geom)
            AND g."geology class" IS NOT NULL
            AND g."geology class" != 'No Data'
        )
        SELECT
            geology_class,
            (intersection_area / (SELECT area FROM total_area)) * 100 as percentage
        FROM geology_intersections
        WHERE intersection_area > 0
        ORDER BY percentage DESC

2026-01-30 19:46:36,576 INFO sqlalchemy.engine.Engine [cached since 34.2s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,584 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT
                ST_GeomFromText(%(wkt)s, 4326) as geom,
                ST_Centroid(ST_GeomFromText(%(wkt)s, 4326)) as centroid
        ),
        nearest_hq AS (
            SELECT
                dh."head quarter" as name,
                ST_Distance(
                    ST_Transform(i.centroid, 32645),
                    ST_Transform(dh.geom, 32645)
                ) / 1000.0 as distance_km,
                degrees(
                    ST_Azimuth(
                        i.centroid,
                        dh.geom
                    )
                ) as azimuth_degrees
            FROM admin."district Headquarter" dh, input_geom i
            WHERE dh."head quarter" IS NOT NULL
            ORDER BY ST_Distance(i.centroid, dh.geom)
            LIMIT 1
        )
        SELECT
            name,
            distance_km,
            azimuth_degrees,
            CASE
                WHEN azimuth_degrees >= 337.5 OR azimuth_degrees < 22.5 THEN 'North'
                WHEN azimuth_degrees >= 22.5 AND azimuth_degrees < 67.5 THEN 'Northeast'
                WHEN azimuth_degrees >= 67.5 AND azimuth_degrees < 112.5 THEN 'East'
                WHEN azimuth_degrees >= 112.5 AND azimuth_degrees < 157.5 THEN 'Southeast'
                WHEN azimuth_degrees >= 157.5 AND azimuth_degrees < 202.5 THEN 'South'
                WHEN azimuth_degrees >= 202.5 AND azimuth_degrees < 247.5 THEN 'Southwest'
                WHEN azimuth_degrees >= 247.5 AND azimuth_degrees < 292.5 THEN 'West'
                ELSE 'Northwest'
            END as direction
        FROM nearest_hq

2026-01-30 19:46:36,585 INFO sqlalchemy.engine.Engine [cached since 34.13s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:36,589 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:36,589 INFO sqlalchemy.engine.Engine [cached since 34.12s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:40,689 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:40,690 INFO sqlalchemy.engine.Engine [cached since 34.25s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:49,135 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:49,136 INFO sqlalchemy.engine.Engine [cached since 33.23s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:51,722 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:51,722 INFO sqlalchemy.engine.Engine [cached since 32.93s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:51,988 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:51,988 INFO sqlalchemy.engine.Engine [cached since 32.87s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,031 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:52,031 INFO sqlalchemy.engine.Engine [cached since 32.85s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,121 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:52,122 INFO sqlalchemy.engine.Engine [cached since 32.81s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,125 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:52,127 INFO sqlalchemy.engine.Engine [cached since 32.8s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,129 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:52,130 INFO sqlalchemy.engine.Engine [cached since 32.8s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,132 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:52,132 INFO sqlalchemy.engine.Engine [cached since 32.8s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,134 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:52,135 INFO sqlalchemy.engine.Engine [cached since 32.8s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,137 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:52,137 INFO sqlalchemy.engine.Engine [cached since 32.8s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,139 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:52,140 INFO sqlalchemy.engine.Engine [cached since 32.8s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,141 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:52,142 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,144 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:52,145 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,147 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:52,147 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,149 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:52,150 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,153 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:46:52,154 INFO sqlalchemy.engine.Engine [cached since 32.8s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,155 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:52,156 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,157 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:52,158 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,159 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:52,160 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,162 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:52,162 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,164 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:52,164 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,166 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:52,166 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,168 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:52,168 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,170 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:52,170 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,171 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:46:52,172 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,174 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:52,174 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,176 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:52,176 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,178 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:52,179 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,180 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:52,181 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,183 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:52,183 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,185 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:52,185 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,187 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:52,187 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,189 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:52,190 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,192 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:46:52,193 INFO sqlalchemy.engine.Engine [cached since 32.79s ago] {'wkt': 'POLYGON((85.05123494200002 27.434844373,85.05250854700007 27.43281449000009,85.05384280200006 27.432205142000033,85.05540579200007 27.431697278000023 ... (1195 characters truncated) ... 6999997,85.04954262600008 27.435571854000063,85.05020597900007 27.43599990300004,85.05073287130257 27.43625625445806,85.05123494200002 27.434844373))'}
2026-01-30 19:46:52,194 INFO sqlalchemy.engine.Engine COMMIT
Block 3 analysis completed successfully
Analyzing block 4/5: Dunetar
2026-01-30 19:46:52,197 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 19:46:52,198 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 19:46:52,198 INFO sqlalchemy.engine.Engine [cached since 50.67s ago] {'geojson': '{"type": "Polygon", "coordinates": [[[85.04435770300006, 27.443011379000016], [85.04532252600004, 27.442850742000047], [85.04622706, 27.4427971390000 ... (1378 characters truncated) ... 03, 27.442679439000084], [85.04185512700012, 27.443161052000054], [85.04336274600007, 27.443359324000028], [85.04435770300006, 27.443011379000016]]]}'}
2026-01-30 19:46:52,201 INFO sqlalchemy.engine.Engine
        SELECT
            ST_YMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as north,
            ST_YMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as south,
            ST_XMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as east,
            ST_XMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as west

2026-01-30 19:46:52,201 INFO sqlalchemy.engine.Engine [cached since 50.66s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,204 INFO sqlalchemy.engine.Engine
            WITH clipped_raster AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.dem
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ),
            pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as elevation
                FROM clipped_raster
            )
            SELECT
                MIN(elevation) as elevation_min,
                MAX(elevation) as elevation_max,
                AVG(elevation) as elevation_mean
            FROM pixel_values
            WHERE elevation > -32000  -- Exclude NoData values (-32768)
              AND elevation >= 0       -- Nepal minimum elevation
              AND elevation <= 9000    -- Nepal maximum elevation

2026-01-30 19:46:52,205 INFO sqlalchemy.engine.Engine [cached since 50.65s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,233 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as slope_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.slope
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value > 0
              AND (pvc).value <= 4
            GROUP BY slope_code

2026-01-30 19:46:52,233 INFO sqlalchemy.engine.Engine [cached since 50.46s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,241 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as aspect_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.aspect
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 0 AND 8
            GROUP BY aspect_code

2026-01-30 19:46:52,242 INFO sqlalchemy.engine.Engine [cached since 50.45s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,254 INFO sqlalchemy.engine.Engine
            WITH boundary AS (
                SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
            ),
            all_pixels AS (
                SELECT
                    (pix).val as height,
                    (pix).geom as pixel_center
                FROM (
                    SELECT ST_PixelAsPolygons(rast) as pix
                    FROM rasters.canopy_height, boundary
                    WHERE ST_Intersects(rast, geom)
                ) as subq
            )
            SELECT
                CASE
                    WHEN height = 0 THEN 'non_forest'
                    WHEN height > 0 AND height <= 5 THEN 'bush_regenerated'
                    WHEN height > 5 AND height <= 15 THEN 'pole_trees'
                    WHEN height > 15 THEN 'high_forest'
                END as canopy_class,
                COUNT(*) as pixel_count,
                AVG(height) as avg_height
            FROM all_pixels, boundary
            WHERE ST_Contains(boundary.geom, ST_Centroid(pixel_center))
              AND height IS NOT NULL
              AND height >= 0
              AND height <= 50
            GROUP BY canopy_class

2026-01-30 19:46:52,255 INFO sqlalchemy.engine.Engine [cached since 50.44s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,460 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as agb_mean,
                (stats).sum as agb_total
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, 1, ST_GeomFromText(%(wkt)s, 4326)),
                    1,  -- band 1
                    true  -- exclude nodata
                ) as stats
                FROM rasters.agb_2022_nepal
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ) as subquery

2026-01-30 19:46:52,463 INFO sqlalchemy.engine.Engine [cached since 50.42s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,467 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as health_class,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_forest_health
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 5
            GROUP BY health_class

2026-01-30 19:46:52,467 INFO sqlalchemy.engine.Engine [cached since 50.39s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,476 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as forest_type_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_type WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 26
            GROUP BY forest_type_code ORDER BY pixel_count DESC

2026-01-30 19:46:52,477 INFO sqlalchemy.engine.Engine [cached since 50.36s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,487 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as landcover_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.esa_world_cover WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
            GROUP BY landcover_code ORDER BY pixel_count DESC

2026-01-30 19:46:52,487 INFO sqlalchemy.engine.Engine [cached since 50.35s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,500 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as loss_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_lossyear WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY loss_year ORDER BY loss_year

2026-01-30 19:46:52,500 INFO sqlalchemy.engine.Engine [cached since 50.33s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,506 INFO sqlalchemy.engine.Engine
            SELECT SUM((pvc).count) as gain_pixels
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_gain WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value = 1

2026-01-30 19:46:52,506 INFO sqlalchemy.engine.Engine [cached since 50.32s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,512 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as fire_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_loss_fire WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY fire_year ORDER BY fire_year

2026-01-30 19:46:52,512 INFO sqlalchemy.engine.Engine [cached since 50.31s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,517 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_mean_temperature WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_mean FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 19:46:52,518 INFO sqlalchemy.engine.Engine [cached since 50.3s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,522 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.min_temp_coldest_month WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_min FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 19:46:52,523 INFO sqlalchemy.engine.Engine [cached since 50.29s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,529 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_precipitation WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as precip FROM clipped
            )
            SELECT AVG(precip) as precip_mean FROM pixel_values WHERE precip IS NOT NULL AND precip >= 0

2026-01-30 19:46:52,529 INFO sqlalchemy.engine.Engine [cached since 50.28s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,533 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as texture_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.soilgrids_isric WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 12
            GROUP BY texture_code ORDER BY pixel_count DESC LIMIT 1

2026-01-30 19:46:52,534 INFO sqlalchemy.engine.Engine [cached since 50.26s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,542 INFO sqlalchemy.engine.Engine
        SELECT p.province
        FROM admin.province p
        WHERE ST_Intersects(
            p.shape,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:52,542 INFO sqlalchemy.engine.Engine [cached since 50.24s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,548 INFO sqlalchemy.engine.Engine
        SELECT m.district, m.gapa_napa as municipality
        FROM admin.municipality m
        WHERE ST_Intersects(
            m.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:52,549 INFO sqlalchemy.engine.Engine [cached since 50.23s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,551 INFO sqlalchemy.engine.Engine
        SELECT w.ward
        FROM admin.ward w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:52,552 INFO sqlalchemy.engine.Engine [cached since 50.21s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,554 INFO sqlalchemy.engine.Engine
        SELECT w."watershed name" as watershed_name, w."major river basin" as major_river_basin
        FROM admin."watershed_Nepal" w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:46:52,555 INFO sqlalchemy.engine.Engine [cached since 50.19s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,559 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
        ),
        total_area AS (
            SELECT ST_Area(ST_Transform(geom, 32645)) as area
            FROM input_geom
        ),
        geology_intersections AS (
            SELECT
                g."geology class" as geology_class,
                ST_Area(
                    ST_Transform(
                        ST_Intersection(g.geom, i.geom),
                        32645
                    )
                ) as intersection_area
            FROM geology.geology g, input_geom i
            WHERE ST_Intersects(g.geom, i.geom)
            AND g."geology class" IS NOT NULL
            AND g."geology class" != 'No Data'
        )
        SELECT
            geology_class,
            (intersection_area / (SELECT area FROM total_area)) * 100 as percentage
        FROM geology_intersections
        WHERE intersection_area > 0
        ORDER BY percentage DESC

2026-01-30 19:46:52,560 INFO sqlalchemy.engine.Engine [cached since 50.18s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,570 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT
                ST_GeomFromText(%(wkt)s, 4326) as geom,
                ST_Centroid(ST_GeomFromText(%(wkt)s, 4326)) as centroid
        ),
        nearest_hq AS (
            SELECT
                dh."head quarter" as name,
                ST_Distance(
                    ST_Transform(i.centroid, 32645),
                    ST_Transform(dh.geom, 32645)
                ) / 1000.0 as distance_km,
                degrees(
                    ST_Azimuth(
                        i.centroid,
                        dh.geom
                    )
                ) as azimuth_degrees
            FROM admin."district Headquarter" dh, input_geom i
            WHERE dh."head quarter" IS NOT NULL
            ORDER BY ST_Distance(i.centroid, dh.geom)
            LIMIT 1
        )
        SELECT
            name,
            distance_km,
            azimuth_degrees,
            CASE
                WHEN azimuth_degrees >= 337.5 OR azimuth_degrees < 22.5 THEN 'North'
                WHEN azimuth_degrees >= 22.5 AND azimuth_degrees < 67.5 THEN 'Northeast'
                WHEN azimuth_degrees >= 67.5 AND azimuth_degrees < 112.5 THEN 'East'
                WHEN azimuth_degrees >= 112.5 AND azimuth_degrees < 157.5 THEN 'Southeast'
                WHEN azimuth_degrees >= 157.5 AND azimuth_degrees < 202.5 THEN 'South'
                WHEN azimuth_degrees >= 202.5 AND azimuth_degrees < 247.5 THEN 'Southwest'
                WHEN azimuth_degrees >= 247.5 AND azimuth_degrees < 292.5 THEN 'West'
                ELSE 'Northwest'
            END as direction
        FROM nearest_hq

2026-01-30 19:46:52,570 INFO sqlalchemy.engine.Engine [cached since 50.12s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:52,574 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:52,574 INFO sqlalchemy.engine.Engine [cached since 50.1s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:46:56,660 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:46:56,661 INFO sqlalchemy.engine.Engine [cached since 50.22s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:04,636 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:04,636 INFO sqlalchemy.engine.Engine [cached since 48.73s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,299 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:07,299 INFO sqlalchemy.engine.Engine [cached since 48.51s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,554 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:07,555 INFO sqlalchemy.engine.Engine [cached since 48.43s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,592 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:07,593 INFO sqlalchemy.engine.Engine [cached since 48.42s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,684 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:07,684 INFO sqlalchemy.engine.Engine [cached since 48.37s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,686 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:07,687 INFO sqlalchemy.engine.Engine [cached since 48.35s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,689 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:07,689 INFO sqlalchemy.engine.Engine [cached since 48.36s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,691 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:07,691 INFO sqlalchemy.engine.Engine [cached since 48.35s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,692 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:07,696 INFO sqlalchemy.engine.Engine [cached since 48.36s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,697 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:07,698 INFO sqlalchemy.engine.Engine [cached since 48.36s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,699 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:07,699 INFO sqlalchemy.engine.Engine [cached since 48.35s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,700 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:07,700 INFO sqlalchemy.engine.Engine [cached since 48.35s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,701 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:07,702 INFO sqlalchemy.engine.Engine [cached since 48.35s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,703 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:07,703 INFO sqlalchemy.engine.Engine [cached since 48.35s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,704 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:07,704 INFO sqlalchemy.engine.Engine [cached since 48.35s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,705 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:07,705 INFO sqlalchemy.engine.Engine [cached since 48.35s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,706 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:07,706 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,707 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:07,707 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,708 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:07,708 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,710 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:07,710 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,713 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:07,714 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,716 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:07,716 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,717 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:07,718 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,720 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:07,720 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,722 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:07,722 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,723 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:07,723 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,724 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:07,724 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,725 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:07,726 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,728 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:07,729 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,732 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:07,732 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,734 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:07,735 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,736 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:07,737 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,739 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:07,739 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,741 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:07,742 INFO sqlalchemy.engine.Engine [cached since 48.34s ago] {'wkt': 'POLYGON((85.04435770300006 27.443011379000016,85.04532252600004 27.442850742000047,85.04622706 27.442797139000053,85.04709833429281 27.44293583400442 ... (1186 characters truncated) ... 85.04089022700003 27.442679439000084,85.04185512700012 27.443161052000054,85.04336274600007 27.443359324000028,85.04435770300006 27.443011379000016))'}
2026-01-30 19:47:07,744 INFO sqlalchemy.engine.Engine COMMIT
Block 4 analysis completed successfully
Analyzing block 5/5: Rame kholsa
2026-01-30 19:47:07,748 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 19:47:07,748 INFO sqlalchemy.engine.Engine
            SELECT ST_AsText(ST_GeomFromGeoJSON(%(geojson)s)) as wkt

2026-01-30 19:47:07,749 INFO sqlalchemy.engine.Engine [cached since 66.22s ago] {'geojson': '{"type": "Polygon", "coordinates": [[[85.0431547570001, 27.45588747100002], [85.04395542600008, 27.454973790000093], [85.04467979100006, 27.453857100 ... (1272 characters truncated) ... 000006, 27.45254918800003], [85.04104511200006, 27.45420717300008], [85.04199853799999, 27.455932865000044], [85.0431547570001, 27.45588747100002]]]}'}
2026-01-30 19:47:07,752 INFO sqlalchemy.engine.Engine
        SELECT
            ST_YMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as north,
            ST_YMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as south,
            ST_XMax(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as east,
            ST_XMin(ST_Envelope(ST_GeomFromText(%(wkt)s, 4326))) as west

2026-01-30 19:47:07,752 INFO sqlalchemy.engine.Engine [cached since 66.21s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:07,755 INFO sqlalchemy.engine.Engine
            WITH clipped_raster AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.dem
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ),
            pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as elevation
                FROM clipped_raster
            )
            SELECT
                MIN(elevation) as elevation_min,
                MAX(elevation) as elevation_max,
                AVG(elevation) as elevation_mean
            FROM pixel_values
            WHERE elevation > -32000  -- Exclude NoData values (-32768)
              AND elevation >= 0       -- Nepal minimum elevation
              AND elevation <= 9000    -- Nepal maximum elevation

2026-01-30 19:47:07,756 INFO sqlalchemy.engine.Engine [cached since 66.2s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:07,764 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as slope_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.slope
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value > 0
              AND (pvc).value <= 4
            GROUP BY slope_code

2026-01-30 19:47:07,765 INFO sqlalchemy.engine.Engine [cached since 65.99s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:07,776 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as aspect_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.aspect
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 0 AND 8
            GROUP BY aspect_code

2026-01-30 19:47:07,777 INFO sqlalchemy.engine.Engine [cached since 65.98s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:07,789 INFO sqlalchemy.engine.Engine
            WITH boundary AS (
                SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
            ),
            all_pixels AS (
                SELECT
                    (pix).val as height,
                    (pix).geom as pixel_center
                FROM (
                    SELECT ST_PixelAsPolygons(rast) as pix
                    FROM rasters.canopy_height, boundary
                    WHERE ST_Intersects(rast, geom)
                ) as subq
            )
            SELECT
                CASE
                    WHEN height = 0 THEN 'non_forest'
                    WHEN height > 0 AND height <= 5 THEN 'bush_regenerated'
                    WHEN height > 5 AND height <= 15 THEN 'pole_trees'
                    WHEN height > 15 THEN 'high_forest'
                END as canopy_class,
                COUNT(*) as pixel_count,
                AVG(height) as avg_height
            FROM all_pixels, boundary
            WHERE ST_Contains(boundary.geom, ST_Centroid(pixel_center))
              AND height IS NOT NULL
              AND height >= 0
              AND height <= 50
            GROUP BY canopy_class

2026-01-30 19:47:07,789 INFO sqlalchemy.engine.Engine [cached since 65.98s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,001 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as agb_mean,
                (stats).sum as agb_total
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, 1, ST_GeomFromText(%(wkt)s, 4326)),
                    1,  -- band 1
                    true  -- exclude nodata
                ) as stats
                FROM rasters.agb_2022_nepal
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ) as subquery

2026-01-30 19:47:08,002 INFO sqlalchemy.engine.Engine [cached since 65.96s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,006 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as health_class,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_forest_health
                WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 5
            GROUP BY health_class

2026-01-30 19:47:08,007 INFO sqlalchemy.engine.Engine [cached since 65.93s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,018 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as forest_type_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_type WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 26
            GROUP BY forest_type_code ORDER BY pixel_count DESC

2026-01-30 19:47:08,019 INFO sqlalchemy.engine.Engine [cached since 65.91s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,041 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as landcover_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.esa_world_cover WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL
            GROUP BY landcover_code ORDER BY pixel_count DESC

2026-01-30 19:47:08,042 INFO sqlalchemy.engine.Engine [cached since 65.9s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,058 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as loss_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_lossyear WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY loss_year ORDER BY loss_year

2026-01-30 19:47:08,058 INFO sqlalchemy.engine.Engine [cached since 65.89s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,065 INFO sqlalchemy.engine.Engine
            SELECT SUM((pvc).count) as gain_pixels
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.nepal_gain WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value = 1

2026-01-30 19:47:08,065 INFO sqlalchemy.engine.Engine [cached since 65.88s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,071 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as fire_year, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.forest_loss_fire WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 23
            GROUP BY fire_year ORDER BY fire_year

2026-01-30 19:47:08,073 INFO sqlalchemy.engine.Engine [cached since 65.87s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,082 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_mean_temperature WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_mean FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 19:47:08,082 INFO sqlalchemy.engine.Engine [cached since 65.86s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,086 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.min_temp_coldest_month WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as temp FROM clipped
            )
            SELECT AVG(temp) as temp_min FROM pixel_values WHERE temp IS NOT NULL AND temp > -100 AND temp < 100

2026-01-30 19:47:08,087 INFO sqlalchemy.engine.Engine [cached since 65.85s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,091 INFO sqlalchemy.engine.Engine
            WITH clipped AS (
                SELECT ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326)) as rast
                FROM rasters.annual_precipitation WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
                LIMIT 1
            ), pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as precip FROM clipped
            )
            SELECT AVG(precip) as precip_mean FROM pixel_values WHERE precip IS NOT NULL AND precip >= 0

2026-01-30 19:47:08,092 INFO sqlalchemy.engine.Engine [cached since 65.84s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,097 INFO sqlalchemy.engine.Engine
            SELECT (pvc).value as texture_code, SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, ST_GeomFromText(%(wkt)s, 4326))) as pvc
                FROM rasters.soilgrids_isric WHERE ST_Intersects(rast, ST_GeomFromText(%(wkt)s, 4326))
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 12
            GROUP BY texture_code ORDER BY pixel_count DESC LIMIT 1

2026-01-30 19:47:08,098 INFO sqlalchemy.engine.Engine [cached since 65.83s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,105 INFO sqlalchemy.engine.Engine
        SELECT p.province
        FROM admin.province p
        WHERE ST_Intersects(
            p.shape,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:47:08,105 INFO sqlalchemy.engine.Engine [cached since 65.81s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,112 INFO sqlalchemy.engine.Engine
        SELECT m.district, m.gapa_napa as municipality
        FROM admin.municipality m
        WHERE ST_Intersects(
            m.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:47:08,112 INFO sqlalchemy.engine.Engine [cached since 65.79s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,115 INFO sqlalchemy.engine.Engine
        SELECT w.ward
        FROM admin.ward w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:47:08,116 INFO sqlalchemy.engine.Engine [cached since 65.78s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,119 INFO sqlalchemy.engine.Engine
        SELECT w."watershed name" as watershed_name, w."major river basin" as major_river_basin
        FROM admin."watershed_Nepal" w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:47:08,119 INFO sqlalchemy.engine.Engine [cached since 65.76s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,123 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
        ),
        total_area AS (
            SELECT ST_Area(ST_Transform(geom, 32645)) as area
            FROM input_geom
        ),
        geology_intersections AS (
            SELECT
                g."geology class" as geology_class,
                ST_Area(
                    ST_Transform(
                        ST_Intersection(g.geom, i.geom),
                        32645
                    )
                ) as intersection_area
            FROM geology.geology g, input_geom i
            WHERE ST_Intersects(g.geom, i.geom)
            AND g."geology class" IS NOT NULL
            AND g."geology class" != 'No Data'
        )
        SELECT
            geology_class,
            (intersection_area / (SELECT area FROM total_area)) * 100 as percentage
        FROM geology_intersections
        WHERE intersection_area > 0
        ORDER BY percentage DESC

2026-01-30 19:47:08,123 INFO sqlalchemy.engine.Engine [cached since 65.74s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,142 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT
                ST_GeomFromText(%(wkt)s, 4326) as geom,
                ST_Centroid(ST_GeomFromText(%(wkt)s, 4326)) as centroid
        ),
        nearest_hq AS (
            SELECT
                dh."head quarter" as name,
                ST_Distance(
                    ST_Transform(i.centroid, 32645),
                    ST_Transform(dh.geom, 32645)
                ) / 1000.0 as distance_km,
                degrees(
                    ST_Azimuth(
                        i.centroid,
                        dh.geom
                    )
                ) as azimuth_degrees
            FROM admin."district Headquarter" dh, input_geom i
            WHERE dh."head quarter" IS NOT NULL
            ORDER BY ST_Distance(i.centroid, dh.geom)
            LIMIT 1
        )
        SELECT
            name,
            distance_km,
            azimuth_degrees,
            CASE
                WHEN azimuth_degrees >= 337.5 OR azimuth_degrees < 22.5 THEN 'North'
                WHEN azimuth_degrees >= 22.5 AND azimuth_degrees < 67.5 THEN 'Northeast'
                WHEN azimuth_degrees >= 67.5 AND azimuth_degrees < 112.5 THEN 'East'
                WHEN azimuth_degrees >= 112.5 AND azimuth_degrees < 157.5 THEN 'Southeast'
                WHEN azimuth_degrees >= 157.5 AND azimuth_degrees < 202.5 THEN 'South'
                WHEN azimuth_degrees >= 202.5 AND azimuth_degrees < 247.5 THEN 'Southwest'
                WHEN azimuth_degrees >= 247.5 AND azimuth_degrees < 292.5 THEN 'West'
                ELSE 'Northwest'
            END as direction
        FROM nearest_hq

2026-01-30 19:47:08,143 INFO sqlalchemy.engine.Engine [cached since 65.69s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:08,150 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:08,150 INFO sqlalchemy.engine.Engine [cached since 65.68s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:11,894 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:11,895 INFO sqlalchemy.engine.Engine [cached since 65.45s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:19,997 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:19,997 INFO sqlalchemy.engine.Engine [cached since 64.09s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:22,620 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:22,621 INFO sqlalchemy.engine.Engine [cached since 63.83s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:22,825 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:22,826 INFO sqlalchemy.engine.Engine [cached since 63.7s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:22,864 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:22,865 INFO sqlalchemy.engine.Engine [cached since 63.69s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:22,972 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:22,973 INFO sqlalchemy.engine.Engine [cached since 63.66s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:22,976 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:22,977 INFO sqlalchemy.engine.Engine [cached since 63.64s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:22,979 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:22,980 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:22,983 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:22,983 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:22,986 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:22,986 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:22,988 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:22,989 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:22,991 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:22,992 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:22,994 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:22,995 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:22,997 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:22,997 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,000 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:23,001 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,003 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:23,003 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,006 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:23,006 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,009 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:23,009 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,012 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:23,012 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,015 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:23,016 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,018 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:23,019 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,021 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:23,022 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,024 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:23,025 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,027 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:23,028 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,030 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:23,031 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,033 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:23,034 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,036 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:23,037 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,039 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:23,040 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,042 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:23,043 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,045 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:23,046 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,049 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:23,050 INFO sqlalchemy.engine.Engine [cached since 63.65s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,052 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:23,053 INFO sqlalchemy.engine.Engine [cached since 63.66s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,056 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:23,057 INFO sqlalchemy.engine.Engine [cached since 63.66s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,059 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:23,059 INFO sqlalchemy.engine.Engine [cached since 63.66s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,064 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:23,065 INFO sqlalchemy.engine.Engine [cached since 63.66s ago] {'wkt': 'POLYGON((85.0431547570001 27.45588747100002,85.04395542600008 27.454973790000093,85.04467979100006 27.453857100000068,85.04509905900002 27.4524359190 ... (1092 characters truncated) ... 054,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002))'}
2026-01-30 19:47:23,067 INFO sqlalchemy.engine.Engine COMMIT
Block 5 analysis completed successfully
2026-01-30 19:47:23,069 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 19:47:23,070 INFO sqlalchemy.engine.Engine
        SELECT
            ST_X(ST_Centroid(boundary_geom)) as lon,
            ST_Y(ST_Centroid(boundary_geom)) as lat
        FROM public.calculations
        WHERE id = %(calc_id)s

2026-01-30 19:47:23,070 INFO sqlalchemy.engine.Engine [generated in 0.00062s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,091 INFO sqlalchemy.engine.Engine
        SELECT
            ST_Area(ST_Transform(boundary_geom, 32645)) as area_sqm,
            ST_Area(ST_Transform(boundary_geom, 32645)) / 10000.0 as area_hectares
        FROM public.calculations
        WHERE id = %(calc_id)s

2026-01-30 19:47:23,092 INFO sqlalchemy.engine.Engine [generated in 0.00101s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,095 INFO sqlalchemy.engine.Engine
        SELECT
            ST_YMax(ST_Envelope(boundary_geom)) as north,
            ST_YMin(ST_Envelope(boundary_geom)) as south,
            ST_XMax(ST_Envelope(boundary_geom)) as east,
            ST_XMin(ST_Envelope(boundary_geom)) as west
        FROM calculations WHERE id = %(calc_id)s

2026-01-30 19:47:23,096 INFO sqlalchemy.engine.Engine [generated in 0.00066s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,099 INFO sqlalchemy.engine.Engine
            WITH clipped_raster AS (
                SELECT ST_Clip(rast, boundary_geom) as rast
                FROM rasters.dem, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
                LIMIT 1
            ),
            pixel_values AS (
                SELECT (ST_PixelAsPolygons(rast)).val as elevation
                FROM clipped_raster
            )
            SELECT
                MIN(elevation) as elevation_min,
                MAX(elevation) as elevation_max,
                AVG(elevation) as elevation_mean
            FROM pixel_values
            WHERE elevation > -32000  -- Exclude NoData values (-32768)
              AND elevation >= 0       -- Nepal minimum elevation
              AND elevation <= 9000    -- Nepal maximum elevation

2026-01-30 19:47:23,100 INFO sqlalchemy.engine.Engine [generated in 0.00081s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,142 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as slope_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.slope, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value > 0
              AND (pvc).value <= 4
            GROUP BY slope_code

2026-01-30 19:47:23,143 INFO sqlalchemy.engine.Engine [generated in 0.00088s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,166 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as aspect_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.aspect, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 0 AND 8
            GROUP BY aspect_code

2026-01-30 19:47:23,167 INFO sqlalchemy.engine.Engine [generated in 0.00072s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,182 INFO sqlalchemy.engine.Engine
            SELECT
                CASE
                    WHEN (pvc).value = 0 THEN 'non_forest'
                    WHEN (pvc).value > 0 AND (pvc).value <= 5 THEN 'bush_regenerated'
                    WHEN (pvc).value > 5 AND (pvc).value <= 15 THEN 'pole_trees'
                    WHEN (pvc).value > 15 THEN 'high_forest'
                END as canopy_class,
                SUM((pvc).count) as pixel_count,
                AVG((pvc).value) as avg_height
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.canopy_height, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL
              AND (pvc).value >= 0
              AND (pvc).value <= 50
            GROUP BY canopy_class

2026-01-30 19:47:23,182 INFO sqlalchemy.engine.Engine [generated in 0.00067s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,197 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as agb_mean,
                (stats).sum as agb_total
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, 1, boundary_geom)
                ) as stats
                FROM rasters.agb_2022_nepal, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
                LIMIT 1
            ) as subquery

2026-01-30 19:47:23,198 INFO sqlalchemy.engine.Engine [generated in 0.00090s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,205 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as health_class,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.nepal_forest_health, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 5
            GROUP BY health_class

2026-01-30 19:47:23,206 INFO sqlalchemy.engine.Engine [generated in 0.00065s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,247 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as forest_type_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.forest_type, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value BETWEEN 1 AND 26
            GROUP BY forest_type_code
            ORDER BY pixel_count DESC

2026-01-30 19:47:23,247 INFO sqlalchemy.engine.Engine [generated in 0.00081s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,266 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as landcover_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.esa_world_cover, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL
            GROUP BY landcover_code
            ORDER BY pixel_count DESC

2026-01-30 19:47:23,267 INFO sqlalchemy.engine.Engine [generated in 0.00078s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,310 INFO sqlalchemy.engine.Engine
            SELECT
                (amt_stats).mean * 0.1 as temp_mean_c,
                (mint_stats).mean * 0.1 as temp_min_c
            FROM (
                SELECT
                    ST_SummaryStats(ST_Clip(amt.rast, calc.boundary_geom), 1, true) as amt_stats,
                    ST_SummaryStats(ST_Clip(mint.rast, calc.boundary_geom), 1, true) as mint_stats
                FROM rasters.annual_mean_temperature amt,
                     rasters.min_temp_coldest_month mint,
                     public.calculations calc
                WHERE calc.id = %(calc_id)s
                  AND ST_Intersects(amt.rast, calc.boundary_geom)
                  AND ST_Intersects(mint.rast, calc.boundary_geom)
                LIMIT 1
            ) as subquery

2026-01-30 19:47:23,311 INFO sqlalchemy.engine.Engine [generated in 0.00139s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,323 INFO sqlalchemy.engine.Engine
            SELECT
                (stats).mean as precip_mean_mm
            FROM (
                SELECT ST_SummaryStats(
                    ST_Clip(rast, boundary_geom),
                    1,
                    true
                ) as stats
                FROM rasters.annual_precipitation, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
                LIMIT 1
            ) as subquery

2026-01-30 19:47:23,324 INFO sqlalchemy.engine.Engine [generated in 0.00239s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,329 INFO sqlalchemy.engine.Engine
            SELECT ST_Area(ST_Transform(boundary_geom, 32645)) / 10000.0 as area_hectares
            FROM public.calculations
            WHERE id = %(calc_id)s

2026-01-30 19:47:23,329 INFO sqlalchemy.engine.Engine [generated in 0.00115s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,332 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as loss_year_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.nepal_lossyear, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value > 0
            GROUP BY loss_year_code
            ORDER BY loss_year_code

2026-01-30 19:47:23,332 INFO sqlalchemy.engine.Engine [generated in 0.00052s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,347 INFO sqlalchemy.engine.Engine
            SELECT
                SUM((pvc).count) as gain_pixels
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.nepal_gain, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value = 1

2026-01-30 19:47:23,348 INFO sqlalchemy.engine.Engine [generated in 0.00098s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,359 INFO sqlalchemy.engine.Engine
            SELECT
                (pvc).value as fire_year_code,
                SUM((pvc).count) as pixel_count
            FROM (
                SELECT ST_ValueCount(ST_Clip(rast, boundary_geom)) as pvc
                FROM rasters.forest_loss_fire, public.calculations
                WHERE calculations.id = %(calc_id)s
                  AND ST_Intersects(rast, boundary_geom)
            ) as subquery
            WHERE (pvc).value IS NOT NULL AND (pvc).value > 0
            GROUP BY fire_year_code

2026-01-30 19:47:23,360 INFO sqlalchemy.engine.Engine [generated in 0.00100s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,372 INFO sqlalchemy.engine.Engine
        SELECT ST_AsText(boundary_geom) as wkt
        FROM public.calculations
        WHERE id = %(calc_id)s

2026-01-30 19:47:23,372 INFO sqlalchemy.engine.Engine [generated in 0.00074s] {'calc_id': 'f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e'}
2026-01-30 19:47:23,374 INFO sqlalchemy.engine.Engine
        SELECT p.province
        FROM admin.province p
        WHERE ST_Intersects(
            p.shape,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:47:23,375 INFO sqlalchemy.engine.Engine [cached since 81.08s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:23,383 INFO sqlalchemy.engine.Engine
        SELECT m.district, m.gapa_napa as municipality
        FROM admin.municipality m
        WHERE ST_Intersects(
            m.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:47:23,383 INFO sqlalchemy.engine.Engine [cached since 81.07s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:23,387 INFO sqlalchemy.engine.Engine
        SELECT w.ward
        FROM admin.ward w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:47:23,388 INFO sqlalchemy.engine.Engine [cached since 81.05s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:23,393 INFO sqlalchemy.engine.Engine
        SELECT w."watershed name" as watershed_name, w."major river basin" as major_river_basin
        FROM admin."watershed_Nepal" w
        WHERE ST_Intersects(
            w.geom,
            ST_Centroid(ST_GeomFromText(%(wkt)s, 4326))
        )
        LIMIT 1

2026-01-30 19:47:23,394 INFO sqlalchemy.engine.Engine [cached since 81.03s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:23,398 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
        ),
        total_area AS (
            SELECT ST_Area(ST_Transform(geom, 32645)) as area
            FROM input_geom
        ),
        geology_intersections AS (
            SELECT
                g."geology class" as geology_class,
                ST_Area(
                    ST_Transform(
                        ST_Intersection(g.geom, i.geom),
                        32645
                    )
                ) as intersection_area
            FROM geology.geology g, input_geom i
            WHERE ST_Intersects(g.geom, i.geom)
            AND g."geology class" IS NOT NULL
            AND g."geology class" != 'No Data'
        )
        SELECT
            geology_class,
            (intersection_area / (SELECT area FROM total_area)) * 100 as percentage
        FROM geology_intersections
        WHERE intersection_area > 0
        ORDER BY percentage DESC

2026-01-30 19:47:23,399 INFO sqlalchemy.engine.Engine [cached since 81.02s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:23,438 INFO sqlalchemy.engine.Engine
        WITH input_geom AS (
            SELECT
                ST_GeomFromText(%(wkt)s, 4326) as geom,
                ST_Centroid(ST_GeomFromText(%(wkt)s, 4326)) as centroid
        ),
        nearest_hq AS (
            SELECT
                dh."head quarter" as name,
                ST_Distance(
                    ST_Transform(i.centroid, 32645),
                    ST_Transform(dh.geom, 32645)
                ) / 1000.0 as distance_km,
                degrees(
                    ST_Azimuth(
                        i.centroid,
                        dh.geom
                    )
                ) as azimuth_degrees
            FROM admin."district Headquarter" dh, input_geom i
            WHERE dh."head quarter" IS NOT NULL
            ORDER BY ST_Distance(i.centroid, dh.geom)
            LIMIT 1
        )
        SELECT
            name,
            distance_km,
            azimuth_degrees,
            CASE
                WHEN azimuth_degrees >= 337.5 OR azimuth_degrees < 22.5 THEN 'North'
                WHEN azimuth_degrees >= 22.5 AND azimuth_degrees < 67.5 THEN 'Northeast'
                WHEN azimuth_degrees >= 67.5 AND azimuth_degrees < 112.5 THEN 'East'
                WHEN azimuth_degrees >= 112.5 AND azimuth_degrees < 157.5 THEN 'Southeast'
                WHEN azimuth_degrees >= 157.5 AND azimuth_degrees < 202.5 THEN 'South'
                WHEN azimuth_degrees >= 202.5 AND azimuth_degrees < 247.5 THEN 'Southwest'
                WHEN azimuth_degrees >= 247.5 AND azimuth_degrees < 292.5 THEN 'West'
                ELSE 'Northwest'
            END as direction
        FROM nearest_hq

2026-01-30 19:47:23,439 INFO sqlalchemy.engine.Engine [cached since 80.99s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:23,448 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:23,448 INFO sqlalchemy.engine.Engine [cached since 80.97s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:28,544 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:28,545 INFO sqlalchemy.engine.Engine [cached since 82.1s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:41,379 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:41,380 INFO sqlalchemy.engine.Engine [cached since 85.47s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:44,575 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:44,576 INFO sqlalchemy.engine.Engine [cached since 85.79s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:44,868 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:44,869 INFO sqlalchemy.engine.Engine [cached since 85.75s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:44,915 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:44,916 INFO sqlalchemy.engine.Engine [cached since 85.74s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,049 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:45,050 INFO sqlalchemy.engine.Engine [cached since 85.73s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,054 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:45,054 INFO sqlalchemy.engine.Engine [cached since 85.72s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,057 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 315 OR azimuth_deg < 45)
                LIMIT 10

2026-01-30 19:47:45,058 INFO sqlalchemy.engine.Engine [cached since 85.72s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,060 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:45,061 INFO sqlalchemy.engine.Engine [cached since 85.72s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,064 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:45,065 INFO sqlalchemy.engine.Engine [cached since 85.73s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,068 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:45,069 INFO sqlalchemy.engine.Engine [cached since 85.73s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,071 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:45,072 INFO sqlalchemy.engine.Engine [cached since 85.73s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,074 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:45,075 INFO sqlalchemy.engine.Engine [cached since 85.73s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,078 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:45,079 INFO sqlalchemy.engine.Engine [cached since 85.73s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,082 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:45,083 INFO sqlalchemy.engine.Engine [cached since 85.73s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,086 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:45,087 INFO sqlalchemy.engine.Engine [cached since 85.73s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,090 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 45 AND azimuth_deg < 135)
                LIMIT 10

2026-01-30 19:47:45,091 INFO sqlalchemy.engine.Engine [cached since 85.73s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,094 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:45,095 INFO sqlalchemy.engine.Engine [cached since 85.73s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,098 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:45,098 INFO sqlalchemy.engine.Engine [cached since 85.73s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,102 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:45,103 INFO sqlalchemy.engine.Engine [cached since 85.74s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,106 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:45,107 INFO sqlalchemy.engine.Engine [cached since 85.74s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,110 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:45,111 INFO sqlalchemy.engine.Engine [cached since 85.74s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,115 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:45,115 INFO sqlalchemy.engine.Engine [cached since 85.74s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,118 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:45,119 INFO sqlalchemy.engine.Engine [cached since 85.74s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,121 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:45,122 INFO sqlalchemy.engine.Engine [cached since 85.74s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,125 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 135 AND azimuth_deg < 225)
                LIMIT 10

2026-01-30 19:47:45,126 INFO sqlalchemy.engine.Engine [cached since 85.74s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,129 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.river_name, f.features) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.river_line f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:45,129 INFO sqlalchemy.engine.Engine [cached since 85.74s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,132 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.ridge_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM river.ridge f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:45,133 INFO sqlalchemy.engine.Engine [cached since 85.75s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,136 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.highway) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.road f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:45,137 INFO sqlalchemy.engine.Engine [cached since 85.75s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,139 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity, f.shop, f.tourism) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.poi f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:45,140 INFO sqlalchemy.engine.Engine [cached since 85.75s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,143 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.hf_type, f.vdc_name1) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.health_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:45,144 INFO sqlalchemy.engine.Engine [cached since 85.75s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,148 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.name, f.name_en, f.amenity) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM infrastructure.education_facilities f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:45,149 INFO sqlalchemy.engine.Engine [cached since 85.75s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,152 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.Building) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM buildings.building f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:45,152 INFO sqlalchemy.engine.Engine [cached since 85.75s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,155 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.vil_name) as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin.settlement f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:45,155 INFO sqlalchemy.engine.Engine [cached since 85.75s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
2026-01-30 19:47:45,158 INFO sqlalchemy.engine.Engine
                WITH input_geom AS (
                    SELECT ST_GeomFromText(%(wkt)s, 4326) as geom
                ),
                nearby AS (
                    SELECT
                        COALESCE(f.description, f."boundary of") as feature_name,
                        ST_Distance(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645)) as distance_m,
                        degrees(ST_Azimuth(ST_Centroid(i.geom), ST_ClosestPoint(f.geom, ST_Centroid(i.geom)))) as azimuth_deg
                    FROM admin."esa_forest_Boundary" f, input_geom i
                    WHERE ST_DWithin(ST_Transform(i.geom, 32645), ST_Transform(f.geom, 32645), 100)
                )
                SELECT DISTINCT feature_name
                FROM nearby
                WHERE feature_name IS NOT NULL
                AND feature_name != ''
                AND (azimuth_deg >= 225 AND azimuth_deg < 315)
                LIMIT 10

2026-01-30 19:47:45,158 INFO sqlalchemy.engine.Engine [cached since 85.75s ago] {'wkt': 'MULTIPOLYGON(((85.06166514100008 27.41872503600006,85.06203161900002 27.418646880000075,85.06232481400012 27.41863380400006,85.062764611 27.418620696 ... (8169 characters truncated) ... 54,85.04009173000006 27.45254918800003,85.04104511200006 27.45420717300008,85.04199853799999 27.455932865000044,85.0431547570001 27.45588747100002)))'}
Analysis completed with 52 keys
Executing UPDATE with 22713 bytes of data
2026-01-30 19:47:45,170 INFO sqlalchemy.engine.Engine SELECT public.calculations.id AS public_calculations_id, public.calculations.user_id AS public_calculations_user_id, public.calculations.application_id AS public_calculations_application_id, public.calculations.uploaded_filename AS public_calculations_uploaded_filename, ST_AsEWKB(public.calculations.boundary_geom) AS public_calculations_boundary_geom, public.calculations.forest_name AS public_calculations_forest_name, public.calculations.block_name AS public_calculations_block_name, public.calculations.result_data AS public_calculations_result_data, public.calculations.status AS public_calculations_status, public.calculations.processing_time_seconds AS public_calculations_processing_time_seconds, public.calculations.error_message AS public_calculations_error_message, public.calculations.created_at AS public_calculations_created_at, public.calculations.completed_at AS public_calculations_completed_at
FROM public.calculations
WHERE public.calculations.id = %(pk_1)s::UUID
2026-01-30 19:47:45,170 INFO sqlalchemy.engine.Engine [generated in 0.00096s] {'pk_1': UUID('f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e')}
2026-01-30 19:47:45,173 INFO sqlalchemy.engine.Engine ROLLBACK
Analysis failed: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: SELECT public.calculations.id AS public_calculations_id, public.calculations.user_id AS public_calculations_user_id, public.calculations.application_id AS public_calculations_application_id, public.calculations.uploaded_filename AS public_calculations_uploaded_filename, ST_AsEWKB(public.calculations.boundary_geom) AS public_calculations_boundary_geom, public.calculations.forest_name AS public_calculations_forest_name, public.calculations.block_name AS public_calculations_block_name, public.calculations.result_data AS public_calculations_result_data, public.calculations.status AS public_calculations_status, public.calculations.processing_time_seconds AS public_calculations_processing_time_seconds, public.calculations.error_message AS public_calculations_error_message, public.calculations.created_at AS public_calculations_created_at, public.calculations.completed_at AS public_calculations_completed_at
FROM public.calculations
WHERE public.calculations.id = %(pk_1)s::UUID]
[parameters: {'pk_1': UUID('f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e')}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2026-01-30 19:47:45,178 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-01-30 19:47:45,182 INFO sqlalchemy.engine.Engine SELECT public.calculations.id AS public_calculations_id, public.calculations.user_id AS public_calculations_user_id, public.calculations.application_id AS public_calculations_application_id, public.calculations.uploaded_filename AS public_calculations_uploaded_filename, ST_AsEWKB(public.calculations.boundary_geom) AS public_calculations_boundary_geom, public.calculations.forest_name AS public_calculations_forest_name, public.calculations.block_name AS public_calculations_block_name, public.calculations.result_data AS public_calculations_result_data, public.calculations.processing_time_seconds AS public_calculations_processing_time_seconds, public.calculations.created_at AS public_calculations_created_at, public.calculations.completed_at AS public_calculations_completed_at
FROM public.calculations
WHERE public.calculations.id = %(pk_1)s::UUID
2026-01-30 19:47:45,183 INFO sqlalchemy.engine.Engine [generated in 0.00095s] {'pk_1': UUID('f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e')}
2026-01-30 19:47:45,197 INFO sqlalchemy.engine.Engine UPDATE public.calculations SET status=%(status)s, error_message=%(error_message)s WHERE public.calculations.id = %(public_calculations_id)s::UUID
2026-01-30 19:47:45,198 INFO sqlalchemy.engine.Engine [generated in 0.00094s] {'status': 'FAILED', 'error_message': '(psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block\n\n[SQL: SELECT public.calcu ... (204 characters truncated) ... ename AS public_calculations_uploaded_filename, ST_AsEWKB(public.calculations.boundary_geom) AS public_calculations_boundary_geom, public.calculation', 'public_calculations_id': UUID('f5b198d4-210e-4a6e-a85d-5e8c5f26ff5e')}
2026-01-30 19:47:45,214 INFO sqlalchemy.engine.Engine COMMIT
INFO:     127.0.0.1:51384 - "POST /api/forests/upload HTTP/1.1" 500 Internal Server Error